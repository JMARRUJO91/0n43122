function registerUIUtilitiesHelpers(){$$WP.Utilities.UI&&(Handlebars.registerHelper("ifMobile",function(n){return $$WP.Utilities.UI.IsMobile?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifMobileOrMobileBrowser",function(n){return $$WP.Utilities.UI.IsMobile||("echeckin"===$$WP.Utilities.queryString("src")||$afe.select("html").hasClass("respquestionnaire"))&&WP.DOM.Browser.isMobile?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifNotMobileOrMobileBrowser",function(n){return $$WP.Utilities.UI.IsMobile||("echeckin"===$$WP.Utilities.queryString("src")||$afe.select("html").hasClass("respquestionnaire"))&&WP.DOM.Browser.isMobile?n.inverse(this):n.fn(this)}),Handlebars.registerHelper("ifNotMobile",function(n){return $$WP.Utilities.UI.IsMobile?n.inverse(this):n.fn(this)}),Handlebars.registerHelper("ifWelcome",function(n){return 78===$$WP.ApplicationContext?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifWelcomeNotMobile",function(n){return 78!==$$WP.ApplicationContext||$$WP.Utilities.UI.IsMobile?n.inverse(this):n.fn(this)}),Handlebars.registerHelper("ifWelcomeOrMobile",function(n){return 78===$$WP.ApplicationContext||$$WP.Utilities.UI.IsMobile||WP.DOM.Browser.isMobile?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifNotWelcomeOrMobile",function(n){return 78===$$WP.ApplicationContext||$$WP.Utilities.UI.IsMobile||WP.DOM.Browser.isMobile?n.inverse(this):n.fn(this)}),Handlebars.registerHelper("ifPreLogin",function(n){return $$WP.Utilities.UI.IsLoggedIn?n.inverse(this):n.fn(this)}),Handlebars.registerHelper("ifiOS",function(n){return WP.DOM.Browser.isIPhone||WP.DOM.Browser.isIPad||WP.DOM.Browser.isIPod||78===$$WP.ApplicationContext&&$$WP.Utilities.UI.IsIos()?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("proxyColorClass",function(){return $$WP.Utilities.UI.ProxyColorClass}),Handlebars.registerHelper("ifWorkflowRestricted",function(n){return $$WP.Utilities.UI.IsWorkflowRestricted?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifCapturedWorkflow",function(n){return $$WP.Utilities.UI.IsCapturedWorkflow?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifNotPrelogin",function(n){return $$WP.Utilities.UI.IsMidLogin||$$WP.Utilities.UI.IsLoggedIn?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifMidLogin",function(n){return $$WP.Utilities.UI.IsMidLogin?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifPreloginOrGuest",function(n){return $$WP.Utilities.UI.IsMidLogin||$$WP.Utilities.UI.IsWorkflowRestricted||!$$WP.Utilities.UI.IsLoggedIn?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifFromMyChartCentral",function(n){return $$WP.Utilities.queryString("mccLocation")||sessionStorage.getItem("mccLocation")?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("getContinueToOrgText",function(){return $$WP.Settings.OrganizationName?($$WP.Strings.addMnemonic("@MYCHART@MYORGNAME@",$$WP.Settings.OrganizationName),string=$$WP.Strings.getForTemplate("ContinueToOrg"),$$WP.Strings.removeMnemonic("@MYCHART@MYORGNAME@")):string=$$WP.Strings.getForTemplate("ContinueToHome"),string}))}function registerI18NHelpers(){$$WP.I18N&&(Handlebars.registerHelper("verticalDateWithYear",function(n,t,i){var r=new Date(i,t-1,n),u=$$WP.I18N.getOrderedDatePieces(!1);return new Handlebars.SafeString($$WP.I18N.Handlebars.verticalDate(r,u))}),Handlebars.registerHelper("verticalDateWithDayName",function(n,t,i){var u=new Date(i,t-1,n),r=$$WP.I18N.getOrderedDatePieces(!0);return"d"===r[0]?r.unshift("dow"):r.push("dow"),new Handlebars.SafeString($$WP.I18N.Handlebars.verticalDate(u,r))}),Handlebars.registerHelper("verticalDateWithoutDay",function(n,t,i){var r=new Date(i,t-1,n),u=$$WP.I18N.getOrderedDatePieces(!1,!1,!0);return new Handlebars.SafeString($$WP.I18N.Handlebars.verticalDate(r,u))}))}function registerStringsHelpers(){$$WP.Strings&&(Handlebars.registerHelper("setStringNamespace",$$WP.Strings.setDefaultNamespace),Handlebars.registerHelper("clearStringNamespace",$$WP.Strings.clearDefaultNamespace),Handlebars.registerHelper("getStringResource",$$WP.Strings.getForTemplate),Handlebars.registerHelper("getDisplayString",function(n,t,i){if("string"==typeof i){if(i)return $$WP.Strings.getForTemplate(n+"_"+i,t)}else if("number"==typeof i)return $$WP.Strings.getForTemplate(n+"_"+i.toString(),t);return $$WP.Strings.getForTemplate(n,t)}),Handlebars.registerHelper("getDisplayStringWithMnemonics",function(n,t){var r,i,u;for(i in r="function"==typeof t?t():t)$$WP.Strings.addMnemonic("@MYCHART@"+i.toUpperCase()+"@",r[i].Value,r[i].IsLink,r[i].Namespace,r[i].EncodingType);for(i in u=$$WP.Strings.getForTemplate(n),r)$$WP.Strings.removeMnemonic("@MYCHART@"+i.toUpperCase()+"@",r[i].Namespace);return u}),Handlebars.registerHelper("addStringResourceMnemonic",$$WP.Strings.addMnemonic),Handlebars.registerHelper("addLinkMnemonic",function(n,t,i,r,u){var f='<a data-id="redirect" href="'+(i=$$WP.Strings.getNamespace().replaceMnemonics(i))+'" data-redirect="'+i+'" data-organization="'+r;!0===u&&(f+='" target="_blank');$$WP.Strings.addMnemonic(n,f+'">'+$$WP.Strings.get(t)+"<\/a>",!1,null,$$WP.Strings.EncodingTypes.None)}),Handlebars.registerHelper("setOrganization",$$WP.Strings.setOrganization),Handlebars.registerHelper("clearOrganization",$$WP.Strings.clearOrganization),Handlebars.registerHelper("removeStringResourceMnemonic",$$WP.Strings.removeMnemonic),Handlebars.registerHelper("appendNewWindowNotification",function(n,t){return $$WP.Strings.appendNewWindowNotification($$WP.Strings.get(n),t)}))}function registerInfoBubbleHelpers(){$$WP.UI.InfoBubble&&(Handlebars.registerHelper("infoBubble",function(n,t,i,r,u){return Handlebars.helpers.addTemplate("UI.InfoBubble",new $$WP.UI.InfoBubble({BubbleTitle:n,BubbleText:t,DisableHtmlEncoding:"boolean"==typeof i&&!0===i,Image:"images/info.png",BubbleLabelledBy:r,BubbleLabel:u}))}),Handlebars.registerHelper("customInfoBubble",function(n,t,i,r,u,f,e){return Handlebars.helpers.addTemplate("UI.InfoBubble",new $$WP.UI.InfoBubble({BubbleTitle:t,BubbleText:i,DisableHtmlEncoding:"boolean"==typeof r&&!0===r,Image:n,UseSvgImage:!!u,BubbleLabelledBy:f,BubbleLabel:e}))}),Handlebars.registerHelper("simpleInfoBubble",function(n,t,i,r){return Handlebars.helpers.addTemplate("UI.InfoBubble",$$WP.UI.InfoBubble.SimpleInfoBubble(n,"boolean"==typeof t&&!0===t,i,r))}),Handlebars.registerHelper("textInfoBubble",function(n,t,i,r){return Handlebars.helpers.addTemplate("UI.InfoBubble",new $$WP.UI.InfoBubble({AnchorText:n,BubbleTitle:t,BubbleText:i,DisableHtmlEncoding:"boolean"==typeof r&&!0===r}))}),Handlebars.registerHelper("simpleTextInfoBubble",function(n,t,i){return Handlebars.helpers.addTemplate("UI.InfoBubble",$$WP.UI.InfoBubble.SimpleTextInfoBubble(n,t,"boolean"==typeof i&&!0===i))}))}function registerBannerHelpers(){Handlebars.registerHelper("coreBanner",function(n){return Handlebars.helpers.addTemplate("Core.Banner",n)});Handlebars.registerHelper("informationalBanner",function(n,t,i,r){return Handlebars.helpers.addTemplate("Core.Banner",{BannerType:"informationalType",HeaderText:n,DetailText:t,IconOverride:"string"==typeof i?i:null,FontSize:r})});Handlebars.registerHelper("successBanner",function(n,t,i,r){return Handlebars.helpers.addTemplate("Core.Banner",{BannerType:"successType",HeaderText:n,DetailText:t,IconOverride:"string"==typeof i?i:null,FontSize:r})});Handlebars.registerHelper("warningBanner",function(n,t,i,r){return Handlebars.helpers.addTemplate("Core.Banner",{BannerType:"warningType",HeaderText:n,DetailText:t,IconOverride:"string"==typeof i?i:null,FontSize:r})});Handlebars.registerHelper("criticalBanner",function(n,t,i,r){return Handlebars.helpers.addTemplate("Core.Banner",{BannerType:"criticalType",HeaderText:n,DetailText:t,IconOverride:"string"==typeof i?i:null,FontSize:r})})}var Epic=Epic||{},$$WPUtil,$$WP,console,EpicPx;Epic.PatientAccess=Epic.PatientAccess||{};$$WP=$$WP||Epic.PatientAccess;$$WP.Utilities=$$WP.Utilities||{};$$WP.Utilities.UI=$$WP.Utilities.UI||{};$$WP.Utilities.UI.Map=$$WP.Utilities.UI.Map||{};$$WP.Utilities.UI.Map.Support=$$WP.Utilities.UI.Map.Support||{};$$WP.Utilities.UI.MyChartCentral=$$WP.Utilities.UI.MyChartCentral||{};EpicPx=EpicPx||{};$$WP.Utilities.UI.SetContext=function(){var n=$afe.select("body"),t;$$WP.Utilities.UI.IsLoggedIn=n.hasClass("isInside");$$WP.Utilities.UI.IsLoggedIn||n.hasClass("isPrelogin")||EpicPx.isBuilder||$$WP.Debug.logError("Page body has neither isPrelogin nor isLoggedIn class. One or the other is required; assuming prelogin.");$$WP.Utilities.UI.IsMidLogin=n.hasClass("midlogin");$$WP.Utilities.UI.IsWorkflowRestricted=n.hasClass("workflowRestricted");$$WP.Utilities.UI.IsCapturedWorkflow=n.hasClass("capturedWorkflow");$$WP.Utilities.UI.IsMobile=$afe.select("html").hasClass("mobile");$$WP.Utilities.UI.IsStandaloneOpenScheduling=n.hasClass("md_openscheduling_index")||n.hasClass("md_anonymousscheduling_openscheduling")||n.hasClass("md_openscheduling_standalone");$$WP.Utilities.UI.IsSelfTriageForAll=(n.hasClass("md_landingpage_loadlandingpagedecisiontrees")||n.hasClass("md_selftriage_load")||n.hasClass("md_triagehistory_load"))&&($$WP.Utilities.UI.IsWorkflowRestricted||!$$WP.Utilities.UI.IsLoggedIn);$$WP.Utilities.UI.IsCrossDeploymentLoadingPage=n.hasClass("md_crossdeploymentscheduling_schedulefromtoken");$$WP.Utilities.UI.IsEmbeddedOpenSchedulingWidget=n.hasClass("embedded");$$WP.Utilities.UI.IsFileUploader=n.hasClass("uploaderfileinput");$$WP.Utilities.UI.IsFullHeightPreloginWorkflow=n.hasClass("fullHeightPrelogin");$$WP.Utilities.UI.IsUsingGraphicHeader=n.hasClass("graphicHeader");$$WP.Utilities.UI.IsMobileRTLInNonResponsive=n.hasClass("mobileRTLInNonResponsive");$$WP.Utilities.UI.IsOnMyWay=n.hasClass("md_onmyway_index");$$WP.Utilities.UI.ContextSet=!0;t=n.safeAttr("class")&&n.safeAttr("class").match(/\bcolor\d+\b/);t&&($$WP.Utilities.UI.ProxyColorClass=t[0])};$$WP.Utilities.UI.OnPageLoad=function(n){var t,o,r,u,f,i,e;if(!0===$$WP.Utilities.UI.PageLoaded)throw"Full UI Load called again after completion. This is forbidden.";if(!0!==$$WP.Utilities.UI.StopPageLoad&&("load"!==n.type&&$$WP.Debug.logError("Full UI Load called by an event other than Page Load."),t=$afe.select("body"),o=($afe.select("#wrap"),$afe.select("form")),$$WP.Utilities.UI.SetContext(),!0!==$$WP.Utilities.UI.IsFileUploader)){for((($$WP.Utilities.UI.IsLoggedIn||$$WP.Utilities.UI.IsFullHeightPreloginWorkflow||$$WP.Utilities.UI.IsMidLogin)&&$$WP.Utilities.UI.RenderHeader(),WP.Utils.minifyElement($afe.select("#header")),WP.Utils.minifyElement($afe.select("#content")),WP.Utils.minifyElement($afe.select("#footer")),$afe.select("#localeswitch").length>0&&$afe.select("#header").addClass("haslocaleswitch"),o.submit(function(){$afe.jq(window).trigger("formSubmit")}),$$WP.Utilities.UI.ResizePage(n),EpicPx.isBuilder)||($afe.select(".cssSwitcher").click(function(n){var t;n&&"A"===n.currentTarget.nodeName&&(t=n.currentTarget.getAttribute("data-csstitle"));0!==t.length&&($$WP.Utilities.UI.ActivateStylesheet(t),$$WP.Utilities.UI.FocusCssSwitcher(t))}),r=$$WP.Utilities.UI.GetAlternateStylesheetIfActive(),r&&r.length>0?$$WP.Utilities.UI.ActivateStylesheet(r):$$WP.Utilities.UI.ActivateStylesheet("Default"),"1"===$$WP.Utilities.queryString("highcontrast")||"true"===$$WP.Utilities.queryString("highcontrast")?$$WP.Utilities.UI.ActivateStylesheet("High Contrast"):"0"!==$$WP.Utilities.queryString("highcontrast")&&"false"!==$$WP.Utilities.queryString("highcontrast")||$$WP.Utilities.UI.ActivateStylesheet("Default")),window.matchMedia&&(u=window.matchMedia("(-ms-high-contrast: active)"),u.matches&&$$WP.Utilities.UI.ActivateHighContrastThemeBasedOnMQL(u),u.addListener($$WP.Utilities.UI.ActivateHighContrastThemeBasedOnMQL)),$$WP.Utilities.UI.IsMobile&&$$WP.Utilities.UI.Map.mobile(n),t.hasClass("passthru")&&($$WP.CommunityUtilities.checkIfCommunityJumpIsValid(),$afe.jq(window).on("message",$$WP.CommunityUtilities.externalJumpMessageListener),$afe.select("a[href*='mode=other']").remove()),t.on("popupStateChanged",$$WP.Utilities.UI.ReactPopupStateChangedListener),t.on("touchstart",".button",function(){}),t.addClass("ready"),$$WP.Utilities.UI.IsLoggedIn&&$afe.select(".component").trigger("resize"),navigator.userAgent.match(/Trident\/7./)&&t.on("mousewheel",function(n){if(!isDataTile()&&!$afe.select("body").hasClass("scrollDisabled")){var t=window.pageYOffset,i=n.originalEvent.wheelDelta;if(n.ctrlKey)return;n.preventDefault();window.scrollTo(window.pageXOffset,t-i)}}),"undefined"!=typeof specialEffects&&specialEffects(),$afe.select("#locale_container #localeswitch").length>0&&new $$WP.UI.LocaleSwitcherController($afe.select("#locale_container")),i=$afe.select("#header"),e=!i.hasClass("static"),e&&i.on("transitionend",function(n){i.removeAttr("data-istransitioning");"height"==n.propertyName&&$$WP.Utilities.UI.SetHeaderSize(!0)}),$afe.select("body").hasClass("isPrelogin")||$afe.jq(window).scroll(function(){var n,t,r;$afe.select("body, #wrap").hasClass("scrollDisabled")||(window.setTimeout(function(){$$WP.Utilities.UI.SetHeaderSize(e)},100),n=$$WPUtil.getScrollLeft(),"rtl"==$afe.select("html").safeAttr("dir")?(t=$afe.select("body").width(),n=Math.min(n,t-$afe.jq(window).width()),r=Math.abs(n),i.css("right",-1*r)):(t=$afe.select("body").width(),n=Math.min(n,t-$afe.jq(window).width()),i.css("left",-1*n)))}),$$WP.Utilities.UI.EnforceEpicLogoVisibility(!0),$afe.jq(window).on("compactHeader",function(){$$WP.Utilities.UI.EnforceEpicLogoVisibility(!1)}),$afe.jq(window).on("deCompactHeader",function(){$$WP.Utilities.UI.EnforceEpicLogoVisibility(!0)}),$$WP.Utilities.UI.MyChartCentral._overrideBackButton(),$$WP.Utilities.UI.PageLoaded=!0,f=0;f<$$WP.Utilities.UI._onUIFrameworkLoadedCallbacks.length;f++)$$WP.Utilities.UI._onUIFrameworkLoadedCallbacks[f]();$$WP.Performance&&$$WP.Performance.Tracker&&$$WP.Performance.Tracker._recordFrameworkMeasurements()}};$$WP.Utilities.UI.SetHeaderSize=function(n){var t=$afe.select("#header"),i=$$WPUtil.getScrollTop(),r=$$WP.Utilities.UI.IsUsingGraphicHeader?20:75;n&&void 0===t.safeAttr("data-istransitioning")&&!sessionStorage.getItem("mccLocation")&&(i>r?$$WP.Utilities.UI.CollapseHeader(n):$$WP.Utilities.UI.ExpandHeader(n))};$$WP.Utilities.UI.CollapseHeader=function(n){var t=$afe.select("#header");t.hasClass("compact")||(t.addClass("compact"),$afe.jq(window).trigger("compactHeader"),n&&t.safeAttr("data-istransitioning",!0),$$WP.Utilities.UI.UpdateHeaderHeightCssVariable(n))};$$WP.Utilities.UI.ExpandHeader=function(n){var t=$afe.select("#header");t.hasClass("compact")&&(t.removeClass("compact"),$afe.jq(window).trigger("deCompactHeader"),n&&t.safeAttr("data-istransitioning",!0),$$WP.Utilities.UI.UpdateHeaderHeightCssVariable(n))};$$WP.Utilities.UI.UpdateHeaderHeightCssVariable=function(n){var t=$afe.select("#header"),u=$afe.select("#main");n&&t.addClass("noTransitions");var i=t.outerHeight(),r=t.css("top"),f=null!=i&&null!=r?i+parseInt(r,10)+"px":"0px",e=u.css("padding-top");document.documentElement.style.setProperty("--wp-header-height",f);document.documentElement.style.setProperty("--wp-main-padding-top",e);t.safeAttr("data-istransitioning")&&(t.toggleClass("compact"),t.outerHeight(),t.toggleClass("compact"));n&&t.removeClass("noTransitions")};$$WP.Utilities.UI._onUIFrameworkLoadedCallbacks=[];$$WP.Utilities.UI.OnUIFrameworkLoaded=function(n){$$WP.Utilities.UI.PageLoaded?n():$$WP.Utilities.UI._onUIFrameworkLoadedCallbacks.push(n)};$$WP.Utilities.UI.ResizePage=function(n){var t,r,i,e;if(!0!=!$$WP.Utilities.UI.ContextSet)if(!0!==$$WP.Utilities.UI.CurrentlyResizing){if(!0!==$$WP.Utilities.UI.IsFileUploader){if($$WP.Utilities.UI.CurrentlyResizing=!0,$$WP.Debug.UpdateTopMarginForBanners(),$$WP.Utilities.UI.IsLoggedIn?$$WP.Utilities.UI.Map.inside(n):$$WP.Utilities.UI.Map.prelogin(n),$$WP.Utilities.UI.PageMode(n),$$WP.Utilities.UI.SupportFiles(n),!$$WP.Utilities.UI.IsMobile){if(t=$afe.select("#header"),r=$afe.select("#main"),!t.safeAttr("data-istransitioning")){var u=t.outerHeight(),f=t.css("top"),o=null!=u&&null!=f?u+parseInt(f,10)+"px":"0px",s=r.css("padding-top");document.documentElement.style.setProperty("--wp-header-height",o);document.documentElement.style.setProperty("--wp-main-padding-top",s)}!t.hasClass("midlogin")&&t.hasClass("static")||$$WP.Utilities.UI.EnforceEpicLogoVisibility(!t.hasClass("compact"));i=$afe.select("#footer").outerHeight();e=null!=i?i+"px":"0px";document.documentElement.style.setProperty("--wp-footer-height",e)}$$WP.Utilities.UI.CurrentlyResizing=!1}}else $$WP.Debug.log("WARNING: ResizePage called again before resize could finish.");else $$WP.Debug.logError("ResizePage called before context was set. You should not call any part of the UI Framework before OnPageLoad has finished.")};$$WP.Utilities.UI.PageMode=function(n){var t,i=$afe.select("body");8!==WP.DOM.Browser.IEVersion&&(t=(t=i.prop("class").split(" ").filter(function(n){return/md_.*/.exec(n)}))&&t.length>0?t[0].substr(3):null)&&"function"==typeof $$WP.Utilities.UI.Map[t]&&$$WP.Utilities.UI.Map[t](n)};$$WP.Utilities.UI.SupportFiles=function(n){var t;for(t in $$WP.Utilities.UI.Map.Support)$$WP.Utilities.UI.Map.Support.hasOwnProperty(t)&&"function"==typeof $$WP.Utilities.UI.Map.Support[t]&&$$WP.Utilities.UI.Map.Support[t](n)};$$WP.Utilities.UI.ToggleButtonClick=function(n,t,i,r){var e,o,f,u=$afe.jq(n);if(void 0===u.prop("wasChecked")&&u.is("[checked='checked']")&&u.prop("wasChecked","checked"===u.safeAttr("checked")),f=u.prop("type"),u.prop("wasChecked")){if("radio"===f&&i)return!1;u.prop("checked",!1)}else u.prop("checked",!0);return u.prop("wasChecked",u.prop("checked")),u.parents("form").first().change(),"radio"===f&&(o=u.prop("name"),(e=$afe.select("input[name='"+o+"']").not(u)).prop({checked:!1,wasChecked:!1}),r||e.trigger("input")),u.trigger("input"),!1};$$WP.Utilities.UI.ActivateStylesheet=function(n){var t,i="userstylesheet4"+makeLink("").replace(new RegExp("/","g"),"").toLowerCase();if(n&&0!==n.length)for("Default"===n?($afe.select("link[title]").safeAttr("rel","alternate stylesheet").prop("disabled",!0),$afe.select("html").removeAttr("data-altstylesheet"),$$WPUtil.isLocalStorageAvailable()&&void 0!==window.localStorage&&localStorage.removeItem(i)):($afe.select("link[title='"+n+"']").safeAttr("rel","stylesheet").prop("disabled",!1),$afe.select("html").safeAttr("data-altstylesheet",n),$$WPUtil.isLocalStorageAvailable()&&void 0!==window.localStorage&&localStorage.setItem(i,n)),"function"==typeof $$WP.Utilities.UI.StyleSheetAdjustment[n]&&$$WP.Utilities.UI.StyleSheetAdjustment[n](),t=0;t<$$WP.Utilities.UI._onStylesheetActivatedListeners.length;t++)$$WP.Utilities.UI._onStylesheetActivatedListeners[t].callback(n,$$WP.Utilities.UI._onStylesheetActivatedListeners[t].contextData)};$$WP.Utilities.UI.FocusCssSwitcher=function(n){if(n&&0!==n.length)switch(n){case"Default":setTimeout(function(){$afe.select(".cssSwitcher[data-csstitle='High Contrast']").focus()},100);break;case"High Contrast":setTimeout(function(){$afe.select(".cssSwitcher[data-csstitle='Default']").focus()},100)}};$$WP.Utilities.UI._onStylesheetActivatedListeners=[];$$WP.Utilities.UI.s_nextStylesheetActivatedListenerId=1;$$WP.Utilities.UI.OnStylesheetActivated=function(n,t){n&&"function"==typeof n||$$WP.Debug.logError("OnStylesheetActivated callback is not a function");var i={callback:n,contextData:t,listenerId:$$WP.Utilities.UI.s_nextStylesheetActivatedListenerId++};return $$WP.Utilities.UI._onStylesheetActivatedListeners.push(i),$$WP.Utilities.UI.s_nextStylesheetActivatedListenerId};$$WP.Utilities.UI.GetAlternateStylesheetIfActive=function(){var n,t;return $$WPUtil.isLocalStorageAvailable()&&void 0!==window.localStorage&&!$$WP.Utilities.UI.IsMobile&&(n="userstylesheet4"+makeLink("").replace(new RegExp("/","g"),"").toLowerCase(),t=localStorage.getItem(n)),t};$$WP.Utilities.UI.ReloadGraphs=function(){"function"==typeof loadGraphs&&loadGraphs()};$$WP.Utilities.UI.StyleSheetAdjustment={Default:$$WP.Utilities.UI.ReloadGraphs,"High Contrast":$$WP.Utilities.UI.ReloadGraphs};$$WP.Utilities.UI.IsHighContrast=function(){return"High Contrast"===document.documentElement.getAttribute("data-altstylesheet")};$$WP.Utilities.UI.ActivateHighContrastThemeBasedOnMQL=function(n){var t;n.matches?t="High Contrast":($$WPUtil.isLocalStorageAvailable()&&void 0!==window.localStorage&&(t=$$WP.Utilities.UI.GetAlternateStylesheetIfActive()),(!t||t.length<=0)&&(t="Default"));$afe.select("link[title='"+t+"']").safeAttr("rel","stylesheet").prop("disabled",!1);$afe.select("html").safeAttr("data-altstylesheet",t)};$$WP.Utilities.UI.IsSmallScreen=function(){return window.matchMedia("screen and (max-width:768px)").matches};$$WP.Utilities.UI.IsMediumSmallScreen=function(){return window.matchMedia("screen and (max-width:1300px)").matches};$$WP.Utilities.UI.ReactPopupStateChangedListener=function(n){n&&n.detail&&"boolean"==typeof n.detail.isOpen&&$$WP.Utilities.UI.ToggleBodyScrolling(n.detail.isOpen,$afe.select("#wrap"))};$$WP.Utilities.UI.ToggleBodyScrolling=function(n,t){function r(){var e=Math.abs(parseInt(i.css("margin-top"))),u=i.hasClass("scrollDisabled"),n,t,r,f;u&&i.removeClass("scrollDisabled");n=document.body.scrollHeight;t=document.body.clientHeight;(u&&i.addClass("scrollDisabled"),n<e+t)&&(r=t-n,i.css("margin-top",r+"px"),f=$$WP.Utilities.UI.IsUsingGraphicHeader?20:75,Math.abs(r)<f&&($afe.select("#header").removeClass("compact"),$$WP.Utilities.UI.EnforceEpicLogoVisibility(!0)))}var i=t||$afe.jq(document.body),u=$afe.jq(window),f=$afe.jq(document),e,o,s;!0!==n||i.hasClass("scrollDisabled")?!1===n&&(e=-parseInt(i.css("margin-top")),i.removeClass("scrollDisabled"),i.css("margin-top",""),i.css("margin-left",""),isDataTile()&&null!=window.frameElement||$$WPUtil.setScrollTop(e),u.off("resize orientationchange",r),f.off("visibilitychange",r)):(isDataTile()&&null!=window.frameElement||(o=$$WPUtil.getScrollTop()),s=i.offset(),i.addClass("scrollDisabled"),i.css({"margin-top":-o,"margin-left":s.left}),u.on("resize orientationchange",r),f.on("visibilitychange",r))};$$WP.Utilities.UI.RenderHeader=function(){if($$WP.Utilities.UI.IsUsingGraphicHeader){var n=$afe.select("#graphicHeader");0!=n.length&&((n.safeAppend($afe.renderTemplate($$WP.Templates.Core.Header,{})),$afe.select("#logout_button").on("click",function(){($$WP.Utilities.UI.IsSelfTriageForAll||"100"===$$WP.Utilities.queryString("workflow")&&"signup"===$$WP.Utilities.queryString("postlogoutmode"))&&$$WP.Utilities.UI.AddSelfTriageForAllOverrides();DoRedirect(null,!1)}),$afe.select("#logout_button").on("keypress",function(n){32!=n.keyCode&&13!=n.keyCode||(($$WP.Utilities.UI.IsSelfTriageForAll||"100"===$$WP.Utilities.queryString("workflow")&&"signup"===$$WP.Utilities.queryString("postlogoutmode"))&&$$WP.Utilities.UI.AddSelfTriageForAllOverrides(),DoRedirect(null,!1))}),$$WP.Utilities.UI.MyChartCentral._setUpBackToMCCButton(),$$WP.Utilities.UI.IsLoggedIn&&!$$WP.Utilities.UI.IsWorkflowRestricted)&&new $$WP.Navigation.MenuController($afe.select("#header_menu"),function(n){$afe.select("#header_menu_name").empty().text(n.ButtonDisplayName);$afe.select("#header_menu").safeAttr("title",n.ButtonDisplayName);null!=n.Shortcuts?$afe.select("#header_shortcuts").safeAppend($afe.renderTemplate($$WP.Templates.Core.HeaderShortcuts,n.Shortcuts)):$afe.select("#header_shortcuts").remove();null!=n.CovidShortcutDetails?$afe.select("#header_covid_shortcut").safeAppend($afe.renderTemplate($$WP.Templates.Core.CovidShortcut,n.CovidShortcutDetails)):$afe.select("#header_covid_shortcut").remove();"false"===sessionStorage.ShowCovidQuickAccess&&$afe.select("#header_covid_shortcut").addClass("jqHidden");$$WP.Utilities.UI.OnUIFrameworkLoaded(function(){$afe.select("#header_navigation").css("max-width","calc(100% - "+$afe.select("#header_extras_proxy").width()+"px)")})},"Menu","menu"),$$WP.Utilities.UI.IsLoggedIn&&!$$WP.Utilities.UI.IsWorkflowRestricted&&$$WP.ProxySwitch.Controllers.ProxySelectorController.getProxySelectorController($afe.select("#patient_name_switch")),location.href,$.ajax({type:"Get",url:makeLink("Localization/Links"),data:{alwaysShowDropdown:!0},datatype:"html",success:function(n){n&&(dangerou$.setHtml($afe.select("#locale_container"),n),$afe.select("#locale_container #localeswitch").length>0?new $$WP.UI.LocaleSwitcherController($afe.select("#locale_container")):$afe.select("#locale_container").remove())}}),$$WPUtil.IsNullOrEmpty($$WP.Settings.BannerLogoFileNameAndPath)||$afe.select("#graphicHeader:not(:empty) #header_logo .header_logo_link").css("background-image","url('"+$$WP.Settings.BannerLogoFileNameAndPath+"')"),$afe.select("#header").focus())}};$$WP.Utilities.UI._bindToClickAndPress=function(n,t){n.on("click",function(n){t(n)});n.on("keypress",function(n){32!=n.keyCode&&13!=n.keyCode||t(n)})};$$WP.Utilities.UI.AddSelfTriageForAllOverrides=function(){var n=!1,t=$$WPUtil.SafeToRedirectOverrideSettings;WP.Events.showBeforeUnloadMessage()||(WP.Events.beforeUnload(),n=!0);$$WPUtil.SafeToRedirectOverrideSettings={TitleText:$$WP.Strings.get("EndSessionPopupTitle","SelfTriage.SelfTriagePage"),Html:$$WP.Strings.get("EndSessionPopupPrompt","SelfTriage.SelfTriagePage"),ToolbarButtons:[new $$WPComp.ComplexObjects.Button($$WP.Strings.get("StayOnPageButtonText","SelfTriage.SelfTriagePage"),null,"","stay"),new $$WPComp.ComplexObjects.Button($$WP.Strings.get("EndSessionButtonText","SelfTriage.SelfTriagePage"),null,"inlinedelete","leave")],callback:function(i){$$WPUtil.SafeToRedirectOverrideSettings=t;n&&WP.Events.cancelBeforeUnload();CreateLogOutPopup(i)}}};$$WP.Utilities.UI.EnforceEpicLogoVisibility=function(n){var t="display: block !important; visibility: visible !important; opacity: 1 !important; min-height: 2rem !important; height: 2rem !important; padding: 0 !important; margin-bottom: 0 !important; min-width: 3rem !important; position: static !important; z-index: auto !important;",i,r;n?(window.innerWidth<=302&&(t="display: none;"),i=parseInt($afe.select("div#header_logo_by_epic").css("margin-top")),r=parseInt($afe.select("div#header_logo_by_epic img").css("margin-top")),(i>30||i<0||0!=r)&&(t+=" margin-top: 0 !important"),$afe.select("div#header_logo_by_epic").safeAttr("style",t+" margin-left: 0.3rem !important; margin-right: 0.3rem !important;"),$afe.select("div#header_logo_by_epic img").safeAttr("style",t+" margin-left: 0 !important; margin-right: 0 !important;")):($afe.select("div#header_logo_by_epic").safeRemoveStyle(),$afe.select("div#header_logo_by_epic img").safeRemoveStyle())};$$WP.Utilities.UI.EnforceCopyrightEpicLogoVisibility=function(){if(!(0===$afe.select("#mychart_by_epic_logo").length||$afe.select("#header_logo_by_epic").length>0||window.location.pathname.indexOf("/Authentication/TermsConditions")>-1)){var n="display: block !important; visibility: visible !important; opacity: 1 !important; min-height: 1rem !important; padding: 0 !important; margin: .5rem auto 0 auto !important; min-width: 6.5rem !important; width: 6.5rem !important; position: static !important; z-index: auto !important;";$afe.select("#mychart_by_epic_logo").safeAttr("alt",$$WP.Strings.get("MyChartByEpicAlt","Global"));$afe.select("#mychart_by_epic_logo_wrapper").safeAttr("style",n);$afe.select("#mychart_by_epic_logo").safeAttr("style",n)}};$$WP.Utilities.UI.MyChartCentral._overrideBackButton=function(){var n,t,i;sessionStorage.getItem("mccLocation")&&(n=$afe.select(".button.previousstep"),$$WP.Utilities.UI.MyChartCentral._backButtonGoesHome(n)&&(t=$afe.select(".back.jqHidden"),t&&t.removeClass("jqHidden"),i=$$WP.Settings.OrganizationName,i?($$WP.Strings.addMnemonic("@MYCHART@MYORGNAME@",i),n.text($$WP.Strings.get("ContinueToOrg")),$$WP.Strings.removeMnemonic("@MYCHART@MYORGNAME@")):n.text($$WP.Strings.get("ContinueToHome")),$$WP.Utilities.UI._bindToClickAndPress(n,function(){$$WP.Utilities.UI.MyChartCentral._backButtonGoesHome()&&sessionStorage.removeItem("mccLocation")})))};$$WP.Utilities.UI.MyChartCentral._backButtonGoesHome=function(n){var t,i,r,u;return(n||(n=$afe.select(".button.previousstep")),t=n.safeAttr("href"),t)?(i=t.indexOf("?"),i>0&&(t=t.substring(0,i)),r=t.endsWith("/Home"),u=t.endsWith("/inside.asp"),r||u):!1};$$WP.Utilities.UI.MyChartCentral._setUpBackToMCCButton=function(){var s=$$WP.Utilities.UI.MyChartCentral._getMccLocation(),r,u,f,t,n,i,e,h,o;if(s){$afe.select("#header").addClass("isFromMCC");r="#";u="";try{f=new URLSearchParams(atob(decodeURIComponent(s)));t=f.get("url");u=f.get("target");n=$$WP.Settings.MyChartCentralURL;n.endsWith("/")&&(n=n.substring(0,n.length-1));t.startsWith("/")&&(t=t.substring(1));i=n.split("/");e=t.split("/");i[i.length-1]===e[0]&&i.pop();h=i.concat(e);r=h.join("/")}catch(s){}($afe.select("#header_gotomcc").safeAttr("href",r),window.opener&&!WP.DOM.Browser.isFirefox)?(o=$afe.select("#header_gotomcc"),o.safeAttr("target",u),$$WP.Utilities.UI._bindToClickAndPress(o,function(n){WP.Comm.logOut(null,!1);window.opener?window.close():(n.preventDefault(),window.location.href=r)})):($afe.select("#header_gotomcc").safeAttr("target","_parent"),window.name="");$$WP.Utilities.UI._bindToClickAndPress($afe.select("#header_logo"),function(){sessionStorage.removeItem("mccLocation")})}};$$WP.Utilities.UI.MyChartCentral._getMccLocation=function(){var t=sessionStorage.getItem("mccLocation"),n=$$WP.Utilities.queryString("mccLocation");return n&&n!==t&&(sessionStorage.setItem("mccLocation",n),t=n),t};$$WP.Utilities.UI.Inside=function(n){if("load"===n.type){var t=$afe.select("#header");$afe.select("#menu .moremenu").each(function(){var n=$afe.jq(this),t=n.find(".submenugroup");n.find(".submenu").addClass("columns_"+t.length)});$afe.select("#proxies a").on("mouseenter focus",function(){$afe.jq(this).addClass("grow").parentsUntil("#proxies","li").addClass("preview");$afe.select("#proxies .selected").addClass("shrink")}).on("mouseleave blur",function(){$afe.select("#proxies .preview").removeClass("preview");$afe.select("#proxies .grow").removeClass("grow");$afe.select("#proxies .selected").removeClass("shrink")});t.on("touchstart click keydown","#touchmenu-toggle, #proxies",$$WP.Utilities.UI.ToggleTouchMenu);WP.DOM.Browser.isIE&&$afe.select("#header #menu").safeAttr("role","menubar");$afe.select("#header").on("click",".proxyLink",function(){$afe.select(".proxyLink").removeAttr("href");$afe.select(".proxyLink").removeAttr("onclick")})}};$$WP.Utilities.UI.HomePage=function(){$$WP.Utilities.UI.LoadHomePageSidebarTemplate()};$$WP.Utilities.UI.LoadHomePageSidebarTemplate=function(){var t,i=$afe.select("#sidebar"),n=$afe.select("#main #homepagesidebar");i.length>0&&n.length>0&&(i.safeAppend(n.clone()),t=widgetSettings||{},n.remove(),$$WPUtil.ComponentFactory.HomePage.Sidebar(t))};$$WP.Utilities.UI.NavTabs=function(n){var t=$afe.select(".membertab"),i=$afe.select(".navparent");"load"===n.type&&t.each(function(){$thisTab=$afe.jq(this);$thisTab.on("keydown","","",$$WP.Utilities.UI.NavTabsSpacebarHelper)});t.each(function(){var t,n=$afe.jq(this);n.find("a").safeAttr("role","tab");(t=n.find("a").safeAttr("id"))&&t.length>10&&0===t.indexOf("tab_topic_")&&($tabContent=$afe.select("#"+t.slice(4)),$tabContent.safeAttr("aria-labelledby",t),$tabContent.safeAttr("role","tabpanel"),n.find("a").safeAttr("aria-controls",$tabContent.safeAttr("id")));n.hasClass("selected")?n.find("a").safeAttr("aria-selected","true"):n.find("a").safeAttr("aria-selected","false");n.prop("hoverable")||(n.hover(function(n){"mouseenter"===n.type?$afe.jq(this).addClass("hover"):$afe.jq(this).removeClass("hover")}),n.find("a").on("focus blur",function(n){"focus"===n.type?$afe.jq(this).parentsUntil(".membertab").addBack().parent(".membertab").addClass("hover"):$afe.jq(this).parentsUntil(".membertab").addBack().parent(".membertab").removeClass("hover")}),0===n.parents(".tabcontainer").length&&n.click(function(){var n=$afe.jq(this),t=n.parents(".navparent"),i=t.safeAttr("data-tabset");void 0!==i&&(t.find(".membertab").removeClass("selected"),t.find(".membertab a").safeAttr("aria-selected","false"),n.addClass("selected"),n.find("a").safeAttr("aria-selected","true"),$afe.select(".tabcontainer[data-tabset='"+i+"']").addClass("hidden"),$afe.select(".tabcontainer[data-tabset='"+i+"'][data-tabname='"+n.safeAttr("data-tabname")+"']").removeClass("hidden"))}),n.prop("hoverable",!0))});i.each(function(){var t=$afe.jq(this),n=t.find(".navchild"),r=!0,i;$$WPUtil.IsNullOrEmpty(n)||(t.removeClass("condensed"),t.width()<n.prop("scrollWidth")&&(t.addClass("condensed"),r=!1),"tablist"!==n.safeAttr("role")&&n.safeAttr("role","tablist"),n.safeAttr("aria-owns"))||(i=[],n.find(".membertab a").each(function(){var n=$afe.jq(this).safeAttr("id");n&&i.push(n)}),i.length>0&&n.safeAttr("aria-owns",i.join(" ")));r&&t.removeClass("condensed")})};$$WP.Utilities.UI.NavTabsSpacebarHelper=function(n){32===n.which&&(n.preventDefault(),$tab=$afe.jq(this),$tab.is("a")?$tab.trigger("click"):$tab.find("a").trigger("click"))};$$WP.Utilities.UI.ToggleTouchMenu=function(n){function i(){var n=$afe.select("#proxies"),t=$afe.select("body"),i=r(),u=$afe.select("#touchmenu-toggle");n.removeClass("droppeddown");t.removeClass("scrollDisabled");u.safeAttr("aria-expanded","false");i.hide()}function r(){var n=$afe.select("#touchmenu"),r=$afe.select("#proxies"),t;return 0===n.length&&((n=r.clone().empty().removeAttr("class").safeRemoveStyle().safeAttr("id","touchmenu").safeAttr("tabindex","-1")).safeAppend($afe.select("#locale_container").clone().safeAttr("id","touchmenu-locale_container").removeAttr("class").find("#morelocales").removeAttr("aria-hidden").end().find("a").removeAttr("aria-haspopup").end()),n.safeAppend($afe.select("#account").clone().safeAttr("id","touchmenu-account").removeAttr("class")),t=$afe.select("#header .proxy:not(#moreTabsTab)"),1!==t.length&&(t.each(function(){n.safeAppend($afe.jq(this).clone())}),$afe.select("#moretabs a").each(function(){var t=document.createElement("LI");n.safeAppend($afe.jq(t).addClass("proxy").safeAttr("role","none").safeAppend($afe.jq(this).clone()))})),$afe.jq(window).on("resize",$$WP.Utilities.UI.ToggleTouchMenu),$afe.select("#header").safeAppend(n),$afe.select("#touchmenu-account .acctname").safeInsertBefore("#touchmenu-account .menuicon"),n.on("click",function(n){0===$afe.jq(n.target).parents(".proxy, #touchmenu-account, #touchmenu-locale_container").length&&(i(),n.preventDefault())})),n}var t=!0;switch(n.type){case"resize":$afe.jq(window).width()>1300&&0!==$afe.select("#touchmenu").length&&i();t=!1;break;case"keydown":(13!==n.which&&32!==n.which||$afe.jq(n.target).parents(".proxy").length>0)&&(t=!1);break;case"touchstart":(n.pageY||n.originalEvent.touches[0].pageY)>$afe.select("#proxies").height()&&$afe.select("#proxies").hasClass("droppeddown")&&(t=!1);case"click":if("touchmenu-toggle"===n.target.id)break;($afe.jq(document.activeElement.parentNode).hasClass("proxy")||"click"===n.type)&&(t=!1)}return($afe.jq(window).width()>1300||$afe.select('head meta[name="viewport"]').length<1)&&(t=!1),!t||($afe.select("#proxies").hasClass("droppeddown")?i():function(){var t=$afe.select("#proxies"),i=$afe.select("body"),n=r(),u=$afe.select("#touchmenu-toggle");t.addClass("droppeddown");i.addClass("scrollDisabled");u.safeAttr("aria-expanded","true");n.show();n.scrollTop(0)}(),!1)};$$WP.Utilities.UI.EnforceEpicLogoVisibility=function(n){var u,f,o,s,t,i,r="display: block !important; visibility: visible !important; opacity: 1 !important; min-height: 1.5rem !important; padding: 0 !important; margin-bottom: 0 !important; min-width: 2.6rem !important; position: relative !important; z-index: auto !important;",h=" margin-left: 0 !important; margin-right: 0 !important;",c=" margin-left: 0.3rem !important; margin-right: 0.3rem !important;",e;n?(t="#header_logo_by_epic",i="#header_logo_by_epic_compact",window.innerWidth<=300&&(r="display: none;")):(t="#header_logo_by_epic_compact",i="#header_logo_by_epic",(window.innerWidth<=768||WP.DOM.Browser.isMobile)&&(r="display: none;"));u=$afe.select(t);f=$afe.select(t+" img");o=$afe.select(i);s=$afe.select(i+" img");e=parseInt(u.css("margin-top"));(e>30||e<0)&&(c+=" margin-top: 0 !important;");0!=parseInt(f.css("margin-top"))&&(h+=" margin-top: 0 !important;");u.safeAttr("style",r+c);f.safeAttr("style",r+h);o.safeRemoveStyle();s.safeRemoveStyle()};$$WP.Utilities.UI.Map.inside=$$WP.Utilities.UI.Inside;$$WP.Utilities.UI.Map.main=$$WP.Utilities.UI.HomePage;$$WP.Utilities.UI.Map.default=$$WP.Utilities.UI.HomePage;$$WP.Utilities.UI.Map.Support.navtabs=$$WP.Utilities.UI.NavTabs;$$WP.Utilities=$$WP.Utilities||{};$$WPUtil=$$WP.Utilities;$$WPUtil._lightboxFadeDelay=200;$$WPUtil.SetupRadioLabels=function(){$afe.select('input[type="radio"]').change(function(){$.each($afe.select('input[type="radio"][name="'+$afe.jq(this).safeAttr("name")+'"]'),function(n,t){$afe.select('label[for="'+$afe.jq(t).safeAttr("id")+'"]').removeClass("selected")});$afe.select('label[for="'+$afe.jq(this).safeAttr("id")+'"]').addClass("selected")}).focus(function(){$afe.select('label[for="'+$afe.jq(this).safeAttr("id")+'"]').addClass("focused")}).blur(function(){$afe.select('label[for="'+$afe.jq(this).safeAttr("id")+'"]').removeClass("focused")});$afe.select(".radiolabel").click(function(){})};$$WPUtil.SetupRadioLabelsInContainer=function(n,t){null!==n&&(n.find('input[type="radio"]').change(function(){$.each(n.find('input[type="radio"][name="'+$afe.jq(this).safeAttr("name")+'"]'),function(t,i){n.find('label[for="'+$afe.jq(i).safeAttr("id")+'"]').removeClass("selected")});n.find('label[for="'+$afe.jq(this).safeAttr("id")+'"]').addClass("selected");null!==t&&t(this)}).focus(function(){n.find('label[for="'+$afe.jq(this).safeAttr("id")+'"]').addClass("focused")}).blur(function(){n.find('label[for="'+$afe.jq(this).safeAttr("id")+'"]').removeClass("focused")}),n.find(".radiolabel").click(function(){}))};$$WPUtil.SetDropdownContents=function(n,t,i,r){var u;$$WPUtil.IsNullOrEmpty(n)||$$WPUtil.IsNullOrEmpty(t)||(r&&(t=JSON.parse(t)),u=[],$.each(t,function(n,t){u.push('<option value="'+n+'">'+t+"<\/option>")}),n.empty(),dangerou$.setHtml(n,u.join()),i&&u.length<2?n.prop("disabled",!0):n.prop("disabled",!1))};$$WPUtil.SmoothScrollToElement=function(n,t,i,r){$$WPUtil.SmoothScrollToElementWithOffset(n,t,0,i,r)};$$WPUtil.SmoothScrollToElementWithOffset=function(n,t,i,r,u){var e,f;if($$WPUtil.IsNullOrEmpty(t)||0===t.length)throw"Cannot scroll to an empty target.";if($$WPUtil.IsNullOrEmpty(n))throw"Cannot scroll nothingness.";$$WPUtil.IsNullOrEmpty(r)&&(r=400);$$WPUtil.IsNullOrEmpty(i)&&(i=0);e=$afe.jq(t).offset().top;(f=$afe.jq(n)).animate({scrollTop:e-i},r,function(){u&&u();f.addClass("force_redraw");window.setTimeout(function(){f.removeClass("force_redraw")},1)})};$$WPUtil.IsNullOrEmpty=function(n){return null==n||""===n};$$WPUtil.AddThrottledListener=function(n,t,i,r,u){var f;if($$WPUtil.IsNullOrEmpty(n))throw"Element to bind cannot be empty";if($$WPUtil.IsNullOrEmpty(t))throw"You must specificy at least one event to throttle";$.isNumeric(r)||(r=100);$$WPUtil.IsNullOrEmpty(u)&&$$WPUtil.IsNullOrEmpty(i)&&(i="change");"function"!=typeof u&&(u=null);f=!1;$afe.jq(n).on(t,function(t){f||(f=!0,window.setTimeout(function(){$$WPUtil.IsNullOrEmpty(i)||$afe.jq(n).trigger(i);$$WPUtil.IsNullOrEmpty(u)||u(t);f=!1},r))})};$$WPUtil.AddImmediateThrottledListener=function(n,t,i,r,u){var f;if($$WPUtil.IsNullOrEmpty(n))throw"Element to bind cannot be empty";if($$WPUtil.IsNullOrEmpty(t))throw"You must specificy at least one event to throttle";$.isNumeric(r)||(r=100);$$WPUtil.IsNullOrEmpty(u)&&$$WPUtil.IsNullOrEmpty(i)&&(i="change");"function"!=typeof u&&(u=null);f=!1;$afe.jq(n).on(t,function(t){f||(f=!0,$$WPUtil.IsNullOrEmpty(i)||$afe.jq(n).trigger(i),$$WPUtil.IsNullOrEmpty(u)||u(t),window.setTimeout(function(){f=!1},r))})};$$WPUtil.AddToggleListener=function(n,t,i,r,u,f,e,o,s,h){var c;if($$WPUtil.IsNullOrEmpty(t))throw"Toggle control ID is required.";$$WPUtil.IsNullOrEmpty(i)&&(i="click");!0!==s&&!1!==s&&(s=!0);$$WPUtil.GetUniqueJQueryById(n,t).on(i,function(i){var l,v,a;return l=$$WPUtil.GetUniqueJQueryById(n,t).safeAttr("data-toggle-for"),$$WPUtil.IsNullOrEmpty(l)||(a=(v=$afe.select("#"+l)).safeAttr("data-toggled"),c=$afe.jq(o),$.each(c,function(n,t){var i;$afe.select('[data-toggle-for="'+$afe.jq(this).safeAttr("id")+'"]').removeClass(r).addClass(u);(i=$afe.jq(t)).safeAttr("data-toggled","false");i.removeClass(f).addClass(e)}),$$WPUtil.SetElementToggled(v,$afe.jq(this),"true"!==a,f,e,r,u),"function"==typeof h&&h("true"===a,i)),!s})};$$WPUtil.SetElementToggled=function(n,t,i,r,u,f,e){var s,o;o=$afe.jq(n);s=$$WPUtil.IsNullOrEmpty(t)?$afe.select('[data-toggle-for="'+o.safeAttr("id")+'"]'):$afe.jq(t);"true"===i||!0===i?(o.safeAttr("data-toggled","true"),o.removeClass(u).addClass(r),s.length>0&&s.removeClass(e).addClass(f)):(o.safeAttr("data-toggled","false"),o.removeClass(r).addClass(u),s.length>0&&s.removeClass(f).addClass(e))};$$WPUtil.ElementHasXOverflow=function(n){return n.offsetWidth<n.scrollWidth};$$WPUtil.ElementHasYOverflow=function(n){var t=$afe.select("html").get(0).offsetHeight,i=n.offsetHeight,r=n.scrollHeight;return t>i?i<r:t===i&&t===r?$afe.jq(window).height()<t:void 0};$$WPUtil.IsElementInView=function(n){var t,r,i;return isDataTile()&&null!=window.frameElement?(t=parent,i=window.frameElement.offsetTop):(t=window,i=0),r=$afe.jq(t),n.offset().top>=t.pageYOffset&&n.offset().top+n.height()+i<=t.pageYOffset+r.height()};$$WPUtil.ElementHasScrolledToBottom=function(n,t){var i,f=$afe.jq(n),r=$afe.select("html").get(0).offsetHeight,e=n.offsetHeight,u=n.scrollHeight;return $.isNumeric(t)||(t=.8),i=f,r===e&&r===u&&(i=$afe.jq(window)),i.scrollTop()+i.innerHeight()>=u*t};$$WPUtil.GUIDPrefix=function(n){return n?n+"_":""};$$WPUtil.GetUniqueJQueryById=function(n,t){return $afe.select("#"+$$WPUtil.GUIDPrefix(n)+t)};$$WPUtil.GetStringResource=function(n,t,i){var u=null,r="";return t&&(r=(u=$$WPUtil.GetUniqueJQueryById(n,"resources").find('div[data-rsrc-id="'+t+'"]')).safeAttr("data-rsrc-val"),$$WPUtil.IsNullOrEmpty(r)&&(r=u.html()),$$WPUtil.IsNullOrEmpty(i)||(r=$$WPUtil.ReplaceStringMnemonics(r,i))),r||""};$$WPUtil.ReplaceStringMnemonics=function(n,t){var i;return $$WPUtil.IsNullOrEmpty(n)?null:($$WPUtil.IsNullOrEmpty(t)||$.each(t,function(t,r){i=new RegExp("@MYCHART@"+t+"@","gi");n=n.replace(i,r)}),n)};$$WPUtil.PopulateComplexTemplate=function(n,t,i,r,u,f){var e,s,h,o;if($$WPUtil.IsNullOrEmpty(t))throw"You must supply a template ID";return $$WPUtil.IsNullOrEmpty(f)&&(f=0),$$WPUtil.IsNullOrEmpty(r)&&(r={}),o=(n?n+"_":"")+t+"_"+f,"true"===(e=$$WPUtil.GetUniqueJQueryById(n,t).clone()).safeAttr("data-template-children-only")?e=e.children():"true"===e.safeAttr("data-template-no-id")?e.safeAttr("id",""):e.safeAttr("id",o),o+="_",s=$$WPUtil.RecurseComplexTemplate(e,r,u,o),$$WPUtil.IsNullOrEmpty(i)||((h=$afe.jq(i)).empty(),s.safeAppendTo(h)),s};$$WPUtil.RecurseComplexTemplate=function(n,t,i,r,u,f){var s,e,o;return $.each(n,function(e,o){var c,p,l,k,a,s,w,d,h,g,nt,b,v,y,tt;if(c=(o=$afe.jq(o)).safeAttr("data-template-group"),p=o.safeAttr("data-template-group-source"),h=o.safeAttr("data-template-source"),b=o.safeAttr("data-template-id"),a=s=w=!1,tt=(o.safeAttr("data-template-type")||"").split(" "),$.each(tt,function(n,t){switch(t){case"collection":a=!0;break;case"object":s=!0;break;case"value":w=!0;break;case"nullable":d=!0;break;case"fill":nt=!0}}),l=!$$WPUtil.IsNullOrEmpty(c)&&!$$WPUtil.IsNullOrEmpty(p),k=!$$WPUtil.IsNullOrEmpty(c)&&a,(s||w)&&d&&$$WPUtil.IsNullOrEmpty(t[h])||nt)n=n.not(o.empty().remove());else if((a||s||l)&&!k)l&&(o=o.parent().children('[data-template-group="'+c+'"]'),h=p),y=$$WPUtil.IsNullOrEmpty(h)?t:t[h],s&&(y=[y]),s||$$WPUtil.IsNullOrEmpty(b)||(v=0),$.each(y,function(t,u){var f,e;"function"==typeof i&&(u=i(h,t,u));$$WPUtil.IsNullOrEmpty(u)||(f=o.clone(),l?(f.removeAttr("data-template-group"),f.removeAttr("data-template-group-source")):(f.removeAttr("data-template-type"),f.removeAttr("data-template-source")),f.safeInsertBefore(o.get(0)),e=$$WPUtil.RecurseComplexTemplate(f,u,i,r,b,v),$.isNumeric(v)&&(v+=1),f.safeReplaceWith(e),n=n.add(e))}),n=n.not(o.empty().remove());else{if(!$$WPUtil.IsNullOrEmpty(o.safeAttr("data-template-group")))return;o.children().length>0&&(g=$$WPUtil.RecurseComplexTemplate(o.children(),t,i,r,u,f),o.children().remove(),g.safeAppendTo(o),n=n.not(o).add(o))}}),s=$$WPUtil.SerializeNodes(n),"string"==typeof t&&(t={"#Value":t}),o=$.isNumeric(f),t["#ID"]=r+(u||"")+(u&&o?"_"+f:""),t["#NUM"]=o?f:"",e=dangerou$.parseHtml($$WPUtil.ReplaceTemplateMnemonics(s,t)),$.each(e,function(n,t){var r,u,i=$afe.jq(t);r=i.safeAttr("data-src-url");$$WPUtil.IsNullOrEmpty(r)||(i.safeAttr("src",r),i.removeAttr("data-src-url"));u=i.safeAttr("data-headers");$$WPUtil.IsNullOrEmpty(u)||(i.safeAttr("headers",u),i.removeAttr("data-headers"));r=i.safeAttr("data-href-url");$$WPUtil.IsNullOrEmpty(r)||(i.safeAttr("href",r),i.removeAttr("data-href-url"))}),e};$$WPUtil.SerializeNodes=function(n){var i,t="";return"function"==typeof XMLSerializer?(i=new XMLSerializer,$.each(n,function(n,r){t+=r.outerHTML||i.serializeToString(r)})):$.each(n,function(n,i){t+=i.outerHTML||i.xml}),t};$$WPUtil.ReplaceTemplateMnemonics=function(n,t){var i;return $$WPUtil.IsNullOrEmpty(n)?null:($$WPUtil.IsNullOrEmpty(t)||$.each(t,function(t,r){i=new RegExp("__"+t+"__","gi");"string"==typeof r&&(r=HTMLEncode(r));n=n.replace(i,r)}),n)};$$WPUtil.CenterContainerOnPage=function(n,t){var i,r=0;$afe.jq(window).height();i=$afe.jq(n);t&&$$WPUtil.setScrollTop(0);(r=$$WPUtil.getScrollTop()+($afe.jq(window).height()-i.height())/2)<0&&(r=0);i.css({top:r+"px"})};$$WP.Utilities.isAbsoluteURL=function(n){return new RegExp("^(?:[a-z]+:)?//","i").test(n)};$$WPUtil.ShowUrlInLightbox=function(n,t,i,r,u){var f;(f=n.url||n)&&$.ajax($.extend({url:f,type:"GET",dataType:"html",success:function(n){var f,t;$$WPUtil.ShowLightboxOverlay(null,r,u);t=$afe.select("#lightbox");dangerou$.setHtml(t,"");f=$afe.select(".ajaxspinner").length>0;dangerou$.setHtml(t,n);f&&t.find(".ajaxspinner").remove();$afe.select("body").addClass("showLightBox");t.removeClass("hidden").show(function(){$$WPUtil.CenterContainerOnPage(t)}).promise().done(function(){i&&"function"==typeof i&&i()})}},t||n.settings))};$$WPUtil.ShowContainerAsLightbox=function(n,t,i){var r,u={container:n,hideLightboxCallback:i};$$WPUtil.ShowLightboxOverlay(n,t,i);(r=$afe.jq(n)).show($$WPUtil._lightboxFadeDelay,function(){r.find(".slider").trigger("matchCardHeights");$$WPUtil.CenterContainerOnPage(n)});r.on("keydown",function(n){$$WPUtil.LightboxKeyDownHandler(n,r,$$WPUtil.LightboxEscKeyHandler,null,null,u)})};$$WPUtil.LightboxEscKeyHandler=function(n,t){var i=t.container,r=t.hideLightboxCallback;$$WPUtil.HideLightbox(i,r);n.preventDefault()};$$WPUtil.ShowLightboxOverlay=function(n,t,i){var r=$afe.select("#lightbox_overlay");r.off("click");r.on({click:function(){$$WPUtil.HideLightbox(n,i)}});r.show($$WPUtil._lightboxFadeDelay).promise().done(function(){t&&"function"==typeof t&&t()})};$$WPUtil.LightboxKeyDownHandler=function(n,t,i,r,u,f){var e,o,s;switch(o=(e=t.find("a[href]:not([tabindex='-1']), area[href]:not([tabindex='-1']), input:not([tabindex='-1']), select:not([tabindex='-1']), textarea:not([tabindex='-1']), button:not([tabindex='-1']), [tabindex]:not([tabindex='-1'])"))[0],s=e[e.length-1],n.which){case 9:n.shiftKey?document.activeElement===o&&($afe.jq(s).focus(),n.preventDefault()):document.activeElement===s&&($afe.jq(o).focus(),n.preventDefault());break;case 27:null!==i&&"function"==typeof i&&i(n,f);break;case 38:null!==r&&"function"==typeof r&&r(n,f);break;case 40:null!==u&&"function"==typeof u&&u(n,f)}};$$WPUtil.HideLightbox=function(n,t){!0!==$$WPUtil.PreventHideLightbox&&($$WPUtil.IsNullOrEmpty(n)||$afe.jq(n).hide($$WPUtil._lightboxFadeDelay),$afe.select(".lb_content").hide($$WPUtil._lightboxFadeDelay),$afe.select("#lightbox_overlay").hide($$WPUtil._lightboxFadeDelay),$afe.select("body").removeClass("showLightBox"),hideLightbox(),t&&"function"==typeof t&&t())};$$WPUtil.AjaxifyForm=function(n,t,i,r,u){var f={};t&&(f.url=$afe.jq(t).safeAttr("action"),f.type=$afe.jq(t).safeAttr("method"),f.sendFormData=!0,t.off("submit").on("submit",$$WPUtil.SubmitAjaxifiedForm(f,n,t,i,r,u)))};$$WPUtil.SubmitAjaxifiedForm=function(n,t,i,r,u,f){return function(){var e,o,s,h;return e=$$WPUtil.AjaxifyFormSubmitHandler(t,i,r,u,f),o=n.url,s=n.type,h=n.sendFormData?$afe.jq(i).serialize():{},!!$$WPUtil.ValidateForm(t,i)&&($.ajax({url:o,type:s,data:h,context:$afe.jq(i),datatype:"json",error:$$WPUtil.DisplayAjaxError,statusCode:{404:function(){}},success:e}),!1)}};$$WPUtil.AjaxifyFormSubmitHandler=function(n,t,i,r,u){return function(f){if("syncchart"!==f.action)if("endworkflow"!==f.action){if("showerrors"===f.action)return $$WPUtil.WriteErrorsToForm(n,$afe.jq(t),f.errors,f.Mnemonics),void $$WPUtil._invokeErrorCallback(i,f.errors);if($$WPUtil.RunCallbackForType(u),r&&"function"==typeof r){var e=!0;try{e=r(f)}catch(n){}if(!e)return}"lightbox"===f.action&&f.url.length>0?$$WPUtil.ShowUrlInLightbox(f):"redirect"!==f.action||window.location.assign(f.url||"/")}else $$WPUtil._invokeErrorCallback(i,f.errors);else $$WPUtil._invokeErrorCallback(i,f.info)}};$$WPUtil._invokeErrorCallback=function(n,t){if(n&&"function"==typeof n)try{n(t)}catch(n){$$WPUtil.ShowUrlInLightbox("Error")}};$$WPUtil.CallbackTypeEnum={Authenticate:"Authenticate"};$$WPUtil.RegisterCallbackForType=function(n,t){var i=$$WPUtil.CallbackTypeEnum[n];$$WP.CallbacksForType||($$WP.CallbacksForType={});!$$WPUtil.IsNullOrEmpty(i)&&t&&"function"==typeof t&&($$WP.CallbacksForType[i]=t)};$$WPUtil.RunCallbackForType=function(n){var t,i=$$WPUtil.CallbackTypeEnum[n];$$WPUtil.IsNullOrEmpty(i)||(t=$$WP.CallbacksForType[i])&&"function"==typeof t&&t()};$$WPUtil.DisplayAjaxError=function(n,t){alert("An error occurred while processing the request: "+t)};$$WPUtil.ValidateForm=function(n,t){var i={},r=!1;return t.find("[data-form-valmsg-for="+t.safeAttr("id")+"]").removeClass("field-validation-error").addClass("field-validation-valid").empty(),t.find("span[data-valmsg-for]").removeClass("field-validation-error").addClass("field-validation-valid").empty(),t.find("input").each(function(){if("true"===$afe.jq(this).safeAttr("data-val")){var n=$afe.jq(this).safeAttr("data-val-required");n&&""===this.value?(i[$afe.jq(this).safeAttr("name")]=n,r=!0):$afe.jq(this).removeClass("input-validation-error")}}),!r||($$WPUtil.WriteErrorsToForm(n,t,i),!1)};$$WPUtil.WriteErrorsToForm=function(n,t,i,r){var u,f,e={};for(u in i=$$WPUtil.MapValidationCodesFromServer(n,i,r),t.find("input").each(function(){var n=$afe.jq(this).safeAttr("name"),r=$afe.jq(this).safeAttr("id"),u=i[n];1!==e[n]&&(u?($afe.jq(this).addClass("input-validation-error"),dangerou$.setHtml(t.find('span[data-valmsg-for="'+r+'"]').removeClass("field-validation-valid").addClass("field-validation-error"),u),delete i[n],e[n]=1):($afe.jq(this).removeClass("input-validation-error"),t.find('span[data-valmsg-for="'+r+'"]').removeClass("field-validation-error").addClass("field-validation-valid").empty()))}),(f=i.formlevelmsg)?(dangerou$.setHtml(t.find('div[data-valmsg-summary="true"]').removeClass("validation-summary-valid").addClass("validation-summary-errors").find("ul").safeAppend("li"),f),delete i.formlevelmsg):t.find('div[data-valmsg-summary="true"]').removeClass("validation-summary-errors").addClass("validation-summary-valid").find("ul").empty(),i)i.hasOwnProperty(u)&&(f=i[u])&&dangerou$.setHtml(t.find('span[data-valmsg-for*="'+u+'"]').removeClass("field-validation-valid").addClass("field-validation-error"),f)};$$WPUtil.MapValidationCodesFromServer=function(n,t,i){var r,u;return $$WPUtil.GetUniqueJQueryById(n,"resources"),r={},$.each(t,function(t,f){var e;$$WPUtil.IsNullOrEmpty(i)||(e=i[t]);u=$$WPUtil.GetStringResource(n,f,e);r[t]=u||f}),r};$$WPUtil.LogAction=function(n,t,i){var r=$afe.select("#logActionUrl").html();$.ajax(r,{type:"POST",action:t,mnemonicsString:JSON.stringify(i),suppressEpicDefaultAjaxErrorHandler:!0})};$$WPUtil.getScrollNode=function(){var n;return(n=isDataTile()?parent.document:document).scrollingElement||n.documentElement};$$WPUtil.ScrollableBody=function(){var n;return n=$$WPUtil.getScrollNode(),$afe.jq(n)};$$WPUtil.getScrollTop=function(){return $$WPUtil.getScrollNode().scrollTop};$$WPUtil.setScrollTop=function(n){$$WPUtil.IsNullOrEmpty(n)&&(n=0);$$WPUtil.getScrollNode().scrollTop=n};$$WPUtil.getScrollLeft=function(){return $$WPUtil.getScrollNode().scrollLeft};$$WPUtil.setScrollLeft=function(n){$$WPUtil.IsNullOrEmpty(n)&&(n=0);$$WPUtil.getScrollNode().scrollLeft=n};$$WPUtil.ActivateHelp=function(n){$afe.select('a[data-lightbox-guid="'+n+'"]').each(function(){$afe.jq(this).off("click").on("click",function(){$$WPUtil.ShowContainerAsLightbox($$WPUtil.GetUniqueJQueryById(n,$afe.jq(this).safeAttr("data-lightbox-id")))})})};$$WPUtil.getDataTileScrollTop=function(n){return Math.max(0,-n.getBoundingClientRect().top)};$$WPUtil.SetupCustomTabbingForFields=function(n){var i,r,t;for(n[n.length],t=0;t<n.length;t++)i=t>0?n[t-1]:null,r=t<n.length-1?n[t+1]:null,n[t].on("keydown",{$tabFrom:i,$tabTo:r},$$WPUtil._CustomTabbingForField),null!==i&&null!==r&&n[t].safeAttr("tabindex",-1)};$$WPUtil._CustomTabbingForField=function(n){var t;9===n.keyCode&&null!==(t=n.shiftKey?n.data.$tabFrom:n.data.$tabTo)&&(t.focus(),n.stopPropagation(),n.preventDefault())};$$WPUtil.quickPopup=function(n,t){Array.isArray(n)?t.Components=n:t=$$WPUtil.mergeObjects({Components:n},t,!0);var i=new $$WPContain.Popup(t);return i.show(!0),i};$$WPUtil.SafeToRedirectOverrideSettings={};$$WPUtil.SafeToRedirect=function(n,t){var r,i;if(WP.Events.showBeforeUnloadMessage()){if(!0!==WP.Events.SafeToUnloadWarningDisplayed)return i={callback:n},$.extend(i,$$WPUtil.SafeToRedirectOverrideSettings),r=new $$WPComp.SafeToRedirectComponent(i),$$WPUtil.quickPopup(r,{positioningFunction:t})}else n(!0)};$$WPUtil.TryRedirect=function(n,t,i,r,u){var f,e,o,s=function(t){var o,s;if(t){var f,h,e=$$WPUtil.parseQueryString(n).mode,l=($$WPUtil.queryString("mode"),$$WPUtil.TryRedirect._mustPickOrganizationModes),a=$$WPUtil.TryRedirect._mustPickOrganizationRoutes,c=function(n,t,i){var r,f;if($$WPUtil.IsH2GActivity(n))return-1===n.toLowerCase().indexOf(makeLink("").toLowerCase())&&(n=makeLink(n)),void(window.location=n);i&&"1"!==i&&!i.IsLocal?(r=(f=n.toLowerCase().indexOf(makeLink("").toLowerCase()))>-1?n.substr(f+makeLink("").length):n,"string"==typeof i?$$WP.CommunityUtilities.getOrganization(i,function(n,t,i){$$WP.CommunityUtilities.openDeepLink("netredirect",i,{targetUrl:n},t?$$WP.CommunityUtilities.openDeepLinkType.InNewTab:$$WP.CommunityUtilities.openDeepLinkType.InPopup)},[r,t]):$$WP.CommunityUtilities.openDeepLink("netredirect",i,{targetUrl:r},t?$$WP.CommunityUtilities.openDeepLinkType.InNewTab:$$WP.CommunityUtilities.openDeepLinkType.InPopup)):t?openWindow(n,"","","",u):window.location=n};if(!i){if(o=$$WPUtil.parseQueryString(n).local,s=null,void 0!==o?"1"===o?f=!1:"0"===o&&(f=!0):l.indexOf(e)>-1?f=!0:$.each(a,function(t,i){const r=n.indexOf(t),u=r+t.length;if(r>-1&&(u>=n.length||!/[a-zA-Z0-9]/.test(n[u])))return f=!0,e=i,void(s=makeLink("inside.asp?mode="+e))}),f)return-1!==["msgoptions","medrefill","custsvc","refrequest"].indexOf(e)&&(h=$$WP.Strings.get("PickOrganization","Messaging.Review")),void $$WP.CommunityUtilities.pickOrganization(function(n,t){"close"!==t&&(s&&(n=s),c(n,r,t))},h,[n],e,$$WP.Strings.get("PickOrganizationTitle","Messaging.Review"));i="1"}c(n,r,i)}};f=(f=window.location.protocol+"//"+window.location.hostname).toLowerCase();o=(e=n.toLowerCase()).substring(0,4);(r=r||e.indexOf(f)<0&&"http"===o)?s(!0):$$WPUtil.SafeToRedirect(s,t)};$$WPUtil.TryRedirect._mustPickOrganizationModes=["msgoptions","refrequest"];$$WPUtil.TryRedirect._mustPickOrganizationRoutes={"/AskQuestion":"msgoptions","/RequestReferral":"refrequest"};$$WPUtil.DidNotRedirect=function(){$$WPComp.SafeToRedirectComponent.canceledRedirect()};$$WPUtil.setActivity=function(){if(checkActivity&&checkActivity.sessionTimeout&&$$WPUtil.setActivity.msSinceLastActivity()>=checkActivity.sessionTimeout)return document.write(""),void(window.location=makeLink("default.asp"));$$WPUtil.setActivity.__lastActivity=new Date;$$WPUtil.IsNullOrEmpty($$WP.CommunityUtilities.getParentJumpGUID())||parent.postMessage(JSON.stringify({message:"setActivity",externalGUID:$$WP.CommunityUtilities.getParentJumpGUID()}),$$WP.CommunityUtilities.getParentDomain())};$$WPUtil.NotifyMobileOfActivity=function(){window.Android&&window.Android.webViewIsActive?Android.webViewIsActive():window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.webViewIsActive&&window.webkit.messageHandlers.webViewIsActive.postMessage("")};$$WPUtil.checkActivity=function(){checkActivity()};$$WPUtil.setActivity.msSinceLastActivity=function(){return new Date-$$WPUtil.setActivity.__lastActivity};$$WPUtil.copyObject=function(n){if(!n)return null;if(!Array.isArray(n))return $$WPUtil.mergeObjects(n,{},!1,!0);var i,t,r;for(i=[],r=n.length,t=0;t<r;t++)i.push(n[t]);return i};$$WPUtil.mergeObjects=function(n,t,i,r){if((Array.isArray(n)||Array.isArray(t))&&console.error("mergeObjects cannot be used on arrays"),t=t||{},i&&(t=$$WPUtil.copyObject(t)),!n)return t;var f,u,e;for(u in e=function(n){return n&&"object"==typeof n&&!(n instanceof jQuery)&&!$$WPComp.isComponent(n)&&!Array.isArray(n)&&!(n instanceof Handlebars.SafeString)},n)void 0!==(f=n[u])&&(e(f)?t[u]=$$WPUtil.mergeObjects(n[u],t[u],!1,r):!r&&t[u]||(Array.isArray(f)&&(f=$$WPUtil.copyObject(f)),t[u]=f));return t};$$WP.Utilities.guaranteeExistence=function(n,t,i){n=n||$$WP;for(var u=t.split("."),f=u.length-1,r=0;r<f;r++)n.hasOwnProperty(u[r])||(n[u[r]]={}),n=n[u[r]];return n.hasOwnProperty(u[r])||(n[u[r]]=arguments.length>2?i:{}),n};$$WPUtil.preventEvent=function(n){return n.stopPropagation(),n.preventDefault(),!1};$$WPUtil.parseQueryString=function(n){"&"===n.charAt(n.length-1)&&(n=n.substring(0,n.length-1));for(var r,f,i=n.substr(n.indexOf("?")+1).split("&"),u={},t=0;t<i.length;t++)-1===(r=i[t].indexOf("="))&&t>0?u[f]+="&"+i[t]:u[f=i[t].substr(0,r).toLowerCase()]=i[t].substr(r+1);return u};$$WPUtil.queryString=function(n){return $$WPUtil.queryString.parsed||($$WPUtil.queryString.parsed=$$WPUtil.parseQueryString(window.location.search)),$$WPUtil.queryString.parsed[n.toLowerCase()]||""};$$WPUtil.removeParamsFromQueryString=function(n){return $$WPUtil.queryString.parsed||($$WPUtil.queryString.parsed=$$WPUtil.parseQueryString(window.location.search)),"string"==typeof n?delete $$WPUtil.queryString.parsed[n.toLowerCase()]:n.forEach(function(n){delete $$WPUtil.queryString.parsed[n.toLowerCase()]}),Object.keys($$WPUtil.queryString.parsed).map(function(n){return n+"="+$$WPUtil.queryString.parsed[n]}).join("&")};$$WPUtil.verticalScrollBarWidth=function(){var n,t,i,r;return $$WPUtil.verticalScrollBarWidth._cached||(t=(n=$afe.renderTemplate($$WP.Templates.Core.scrollbarwidth)).children(0).get(0),document.body.appendChild(n.get(0)),i=t.offsetWidth,n.css("overflow","scroll"),(r=t.offsetWidth)===i&&(r=n.get(0).clientWidth),n.remove(),$$WPUtil.verticalScrollBarWidth._cached=i-r),$$WPUtil.verticalScrollBarWidth._cached};$$WPUtil.preventAndroidLongPress=function(n,t,i){navigator.userAgent.indexOf("Android")>=0&&(1!==n.length||t||(t=n,i=""),t&&t.on("contextmenu",i,function(n){n.preventDefault()}))};$$WPUtil.isBrowserCapableOf=function(n,t){var i;switch(n){case"flexbox":return void 0!==document.body.style.flex;case"input":return i=document.createElement("input"),$afe.jq(i).safeAttr("type",t.type),i.type===t.type;case"touchEvents":return"ontouchstart"in window||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>0;case"canvas":return!!window.HTMLCanvasElement;case"ActiveX":return!!window.ActiveXObject;case"Intl":return"object"==typeof Intl&&"DateTimeFormat"in Intl&&"NumberFormat"in Intl}};$$WPUtil.isValidBrowser=function(){return $$WPUtil.isBrowserCapableOf("canvas")&&!$$WPUtil.isBrowserCapableOf("ActiveX")&&$$WPUtil.isBrowserCapableOf("Intl")};$$WPUtil.addUrlParameter=function(n,t,i){return-1===n.indexOf("?")?n+="?":"&"!==n[n.length-1]&&(n+="&"),n+t+"="+i};$$WPUtil.isNaN=function(n){return isNaN(n)||!n&&0!==n};$$WPUtil.confirmFormSubmission=function(n,t,i,r,u,f,e){return i?$$WPUtil.quickMessageBoxByEnum(t,i,$$WPUtil.confirmFormSubmission.submitForm,[n,r]):$$WPUtil.quickMessageBox(t,f,u,$$WPUtil.confirmFormSubmission.submitForm,[n,r],"",e),!1};$$WPUtil.confirmFormSubmission.submitForm=function(n,t,i){var r;"function"==typeof t&&!1===t(n,i)||i===$$WP.Components.TOOLBARIDENTIFIER+"continue"&&(r=n.onclick,n.onclick=null,$(n).off(),n.click(),n.onclick=r)};$$WPUtil.quickMessageBoxByEnum=function(n,t,i,r,u){var f,e,o=$$WPUtil.quickMessageBoxByEnum.typeEnum;switch(t=t||$$WPUtil.quickMessageBoxByEnum.typeEnum.ContinueGoback){case o.ContinueGoback:f=$$WP.Strings.get("ContinueGobackTitle","Core.Utilities");e=$$WPUtil.createContinueGoBackButtons();break;case o.DeleteGoback:f=$$WP.Strings.get("DeleteGobackTitle","Core.Utilities");e=$$WPUtil.createDeleteGoBackButtons();break;case o.YesNo:f=$$WP.Strings.get("YesNoTitle","Core.Utilities");e=$$WPUtil.createYesNoButtons();break;case o.Ok:f=$$WP.Strings.get("AlertTitle","Core.Utilities");e=$$WPUtil.createOkButton();break;case o.RemoveGoback:f=$$WP.Strings.get("ContinueGobackTitle","Core.Utilities");e=$$WPUtil.createRemoveGoBackButtons();break;case o.RestoreGoback:f=$$WP.Strings.get("ContinueGobackTitle","Core.Utilities");e=$$WPUtil.createRestoreGoBackButtons();break;default:return}return $$WPUtil.quickMessageBox(n,f,e,i,r,u)};$$WPUtil.quickMessageBoxByEnum.typeEnum={ContinueGoback:1,DeleteGoback:2,YesNo:3,Ok:4,RemoveGoback:5,RestoreGoback:6};$$WPUtil.createContinueGoBackButtons=function(){return[new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Continue","Core.Utilities"),null,"completeworkflow","continue"),new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Goback","Core.Utilities"),null,"previousstep","cancel")]};$$WPUtil.createDeleteGoBackButtons=function(){return[new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Delete","Core.Utilities"),null,"inlinedelete","continue"),new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Goback","Core.Utilities"),null,"previousstep","cancel")]};$$WPUtil.createYesNoButtons=function(){return[new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Yes","Core.Utilities"),null,"completeworkflow","continue"),new $$WPComp.ComplexObjects.Button($$WP.Strings.get("No","Core.Utilities"),null,"previousstep","cancel")]};$$WPUtil.createOkButton=function(){return[new $$WPComp.ComplexObjects.Button($$WP.Strings.get("MessageBoxOK","global"),null,"otherbutton","continue")]};$$WPUtil.createRemoveGoBackButtons=function(){return[new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Remove","Core.Utilities"),null,"inlinedelete","continue"),new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Goback","Core.Utilities"),null,"previousstep","cancel")]};$$WPUtil.createRestoreGoBackButtons=function(){return[new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Restore","Core.Utilities"),null,"inlinesave","continue"),new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Goback","Core.Utilities"),null,"previousstep","cancel")]};$$WPUtil.quickMessageBox=function(n,t,i,r,u,f,e){$$WPUtil.IsNullOrEmpty(t)||t===HTMLUnencode(t)||$$WP.Debug.logError("$$WPUtil.quickMessageBox was probably called with an HTML formatted title. The title should be raw text, not HTML");var o,s=$$WP.Strings.getNamespace("Global.Confirm");return o=new $$WPComp.MessageComponent({TitleText:t||s.getStringForTemplate("GenericConfirmTitle"),Message:n,callback:r,CallbackArgs:u,ToolbarButtons:i}),$$WPUtil.quickPopup(o,{Size:i.length<3?$$WPContain.Popup.SizeEnum.SMALL:$$WPContain.Popup.SizeEnum.MEDIUM,Class:f+" sm-autosizedpopup",HasBackButton:e})};$$WPUtil.generateGUID=function(){return $$WPUtil.generateGUID._last=$$WPUtil.generateGUID._last||0,$$WPUtil.generateGUID._last++,$$WPUtil.generateGUID._last};$$WPUtil.generateGUID._last;$$WPUtil.getDomain=function(n){try{return n.protocol+"//"+n.host}catch(n){return null}};$$WPUtil.canWriteCookies=function(){setCookie("testCookie","testValue",!0);var n=""!==getCookie("testCookie",!0);return n&&deleteCookie("testCookie",!0),n};$$WPUtil.canWriteCookiesAsync=function(){return new Promise(function(n){"function"==typeof document.requestStorageAccess?($$WPUtil.canWriteCookies()&&n(!0),document.requestStorageAccess().then(function(){n($$WPUtil.canWriteCookies())}).catch(function(){n(!1)})):n($$WPUtil.canWriteCookies())})};$$WPUtil.cssValueToPixels=function(n){return n.indexOf("rem")>-1?($$WPUtil.cssValueToPixels.emSize||($$WPUtil.cssValueToPixels.emSize=parseFloat($afe.select("body").css("font-size"))),Math.round(parseFloat(n,10)*$$WPUtil.cssValueToPixels.emSize)):n.indexOf("px")>-1?parseFloat(n,10):void(isNaN(parseFloat(n,10))||console.log("CSS value cannot be converted to pixels: "+n))};$$WPUtil.instantiateComponent=function(n,t,i){var r={};return r.SupportedComponents=n,r.$parent=$afe.select("#"+t),i&&(r.ComponentProperties=i),new $$WPContain.HTMLTemplateContainer(r)};$$WPUtil.getPopupParent=function(n){return n.parents("#main, #sidebar, #lightbox, .Popup, .direct_message, .menudetailstable.leftmenu .leftcolumn, .popupOwner, #listHolder")};$$WPUtil.positionElementNear=function(n,t){var h,i,u,r,c,e,f,l,s,o,a;return n.removeClass("onRight onLeft onBottom onTop"),t.removeClass("onRight onLeft onBottom onTop"),i=(h=$$WPUtil.getPopupParent(t)).boxModel(!1),s=h[0].offsetWidth-h[0].clientWidth,o=0,"main"!==h.safeAttr("id")&&"sidebar"!==h.safeAttr("id")||(i.top+=$afe.select("#header").outerHeight(),(a=$afe.select("#footer").outerHeight(!1))>0&&(i.height-=a,i.bottom=i.top+i.height)),r=n.boxModel(!1),f=null,e=null,400<i.width?t.outerWidth(400):(t.outerWidth(i.width-16),o=i.left+8),u=t.boxModel(!1),(c={toRight:i.right-r.right-s,toLeft:r.left-i.left,above:r.top-i.top,below:i.bottom-r.bottom}).toRight>u.width?(n.addClass("onRight"),t.addClass("onRight"),f=r.right+o):c.above>u.height?(n.addClass("onTop"),t.addClass("onTop"),e=r.top-u.height,l=!0):c.toLeft>u.width?(n.addClass("onLeft"),t.addClass("onLeft"),f=r.left-u.width+o):c.below>u.height&&(n.addClass("onBottom"),t.addClass("onBottom"),e=r.bottom),null!==f?r.bottom-u.height>i.top?e=r.bottom-u.height+2:r.top+u.height<i.bottom?(e=r.top-2,t.addClass("infoPopupAlignTop")):((e=r.top+r.height/2-u.height/2)<i.top||e>i.bottom)&&(e=i.top,$$WP.Debug.log("Popup cannot be fit to screen")):null!==e?r.left+u.width+s<i.right?f=r.left-2+o:r.right-u.width>i.left?f=r.right-u.width+2+o:(f=r.left+r.width/2-u.width/2+o,i.width<u.width+f+s&&(f=i.left+8,t.outerWidth(i.width-16-s),l&&(u=t.boxModel(!1),e=r.top-u.height)),(f<i.left||f>i.right)&&(f=i.left+8,t.outerWidth(i.width-16-s),l&&(u=t.boxModel(!1),e=r.top-u.height),$$WP.Debug.log("Popup cannot be fit to screen"))):($$WP.Debug.log("Popup cannot be fit to screen"),n.addClass("onRight"),e=r.top,f=r.right),{top:e,left:f}};$$WPUtil.positionElementNearRTL=function(n,t){var s,r,u,i,o,e,f,h,c;return n.removeClass("onRight onLeft onBottom onTop"),t.removeClass("onRight onLeft onBottom onTop"),r=(s=t.parents("#main, #sidebar, #lightbox, .Popup, .direct_message, .menudetailstable.leftmenu .leftcolumn, .popupOwner")).boxModel(!1),"main"!==s.safeAttr("id")&&"sidebar"!==s.safeAttr("id")||(r.top+=$afe.select("#header").outerHeight(),(c=$afe.select("#footer").outerHeight(!1))>0&&(r.height-=c,r.bottom=r.top+r.height)),i=n.boxModel(!1),o={toRight:r.right-i.right,toLeft:i.left-r.left,above:i.top-r.top,below:r.bottom-i.bottom},f=null,e=null,400<r.width?t.outerWidth(400):t.outerWidth(r.width),u=t.boxModel(!1),o.toLeft>u.width?(n.addClass("onRight"),t.addClass("onRight"),f=i.right):o.below>u.height?(n.addClass("onBottom"),t.addClass("onBottom"),e=i.bottom):o.toRight>u.width?(n.addClass("onLeft"),t.addClass("onLeft"),f=i.left-u.width):o.above>u.height&&(n.addClass("onTop"),t.addClass("onTop"),e=i.top-u.height,h=!0),null!==f?i.bottom-u.height>r.top?e=i.bottom-u.height+2:i.top+u.height<r.bottom?(e=i.top-2,t.addClass("infoPopupAlignTop")):((e=i.top+i.height/2-u.height/2)<r.top||e>r.bottom)&&(e=r.top,$$WP.Debug.log("Popup cannot be fit to screen")):null!==e?i.left+u.width<r.right?f=i.right-u.width+2:i.right-u.width>r.left?f=i.left-2:u.width===r.width?(t.outerWidth(r.width-16),f=i.left+i.right-r.right+8):(f=i.left+i.width/2-u.width/2,u.left<r.left&&(f=i.left+i.right-r.right+8,t.width(r.width-32),h&&(u=t.boxModel(!1),e=i.top-u.height)),(f<i.right-r.right+i.left||f>r.right+i.right+i.left)&&(f=i.left+i.right-r.width-r.left,$$WP.Debug.log("Popup cannot be fit to screen"))):($$WP.Debug.log("Popup cannot be fit to screen"),n.addClass("onRight"),e=i.top,f=i.right),{top:e,left:f}};$$WPUtil.handlePopupInstructions=function(n,t){var i=void 0;"focus"===n.type||"mouseenter"===n.type||"click"===n.type?i=!0:("blur"===n.type||"mouseleave"===n.type||"keydown"===n.type&&27===n.keyCode)&&(i=!1);void 0!==i&&($$WPUtil.togglePopupInstructions($afe.jq(n.target),i,t),n.stopPropagation())};$$WPUtil.handlePopupInstructionsKeydown=function(n,t){"keydown"===n.type&&27===n.keyCode&&$afe.select("#main").find(".popupiconcontainer .popupinstructionsicon.showPopup").each(function(){var n=$afe.jq(this);$$WPUtil.togglePopupInstructions(n,!1,t)})};$$WPUtil.togglePopupInstructions=function(n,t,i){var r,o,u,s,f,e;i=i||"Global";n.hasClass("popupiconcontainer")||(n=n.parents(".popupiconcontainer").first());0!==n.length&&(u=(r=n.find(".popupInstructions")).siblings(".popupinstructionsicon"),o=r.parents("#main, #sidebar, .Popup, .popupOwner"),t?(s="PopupHelpIconAltFull",u.find("img").data("altnode")&&(s=u.find("img").data("altnode")+"Full"),u.find("img").safeAttr("alt",$$WP.Strings.get(s,i)),r.removeClass("hidden isblur"),u.addClass("showPopup"),o.addClass("allowOverflow"),"1"!==u.safeAttr("data-ispositioned")&&(e=u.offset(),"rtl"==$afe.select("html").safeAttr("dir")?((f=$$WPUtil.positionElementNearRTL(u,r)).top-=e.top,f.left-=e.left,r.css({right:f.left+"px",top:f.top+"px"})):((f=$$WPUtil.positionElementNear(u,r)).top-=e.top,f.left-=e.left,r.css({left:f.left+"px",top:f.top+"px"})),r.safeAttr("data-ispositioned","1"))):(r.addClass("isblur"),window.setTimeout(function(n,t,r){var u=t.find("img").data("altnode")||"PopupHelpIconAlt";r.hasClass("isblur")&&(n.removeClass("allowOverflow"),r.removeClass("isblur"),r.addClass("hidden"),t.removeClass("showPopup"),t.find("img").safeAttr("alt",$$WP.Strings.get(u,i)))},100,o,u,r)))};$$WPUtil.handlePopupEndAnchor=function(n,t){var r,i,u,f;t=t||"Global";$popupiconcontainer=(r=$afe.jq(n.target)).hasClass("popupiconcontainer")?r:r.parents(".popupiconcontainer").first();0!==$popupiconcontainer.length&&(f=(i=$popupiconcontainer.find(".popupInstructions")).siblings(".popupinstructionsicon"),u=i.parents("#main, #sidebar, .Popup"),"keyup"===n.type&&"Tab"===n.key&&!1===n.shiftKey?(i.addClass("isblur"),window.setTimeout(function(n,i,r){var u=i.find("img").data("altnode")||"PopupHelpIconAlt";r.hasClass("isblur")&&(n.removeClass("allowOverflow"),r.removeClass("isblur"),r.addClass("hidden"),i.removeClass("showPopup"),i.find("img").safeAttr("alt",$$WP.Strings.get(u,t)))},100,u,f,i),WP.DOM.Search.getNextFocusable(n.target).focus()):"keyup"===n.type&&"Tab"===n.key&&!0===n.shiftKey&&WP.DOM.Search.getPreviousFocusable($popupiconcontainer[0].parentNode).focus())};$$WPUtil.printHtmlClass=function(n){var t;t=$afe.select("."+n);$$WPUtil.printElement(t)};$$WPUtil.printImage=function(n){var t=dangerou$.parseHtml("<img src='"+n+"' style='height: 100%' />");$$WPUtil.printElement(t)};$$WPUtil.printElement=function(n){var i,t;t=openWindow("","Print","resizable");i=$afe.jq(n).get(0).outerHTML;t.focus();dangerou$.setHtml(t.document.body,i);window.setTimeout(function(n){n.print();n.close()},10,t)};$$WPUtil.postify=function(n){var t={},i=function(n,r){var u,f;for(u in n){f=isFinite(u)?(""!=r?r:"")+"["+u+"]":(""!=r?r+".":"")+u;switch(typeof n[u]){case"number":case"string":case"boolean":t[f]=n[u];break;case"object":i(n[u],""!=f?f:u)}}};return i(n,""),t};$$WPUtil.postForm=function(n,t,i){var r=$afe.jq(document.createElement("form")),f,e,u;if(r.safeAttr("method","post"),r.safeAttr("action",n),r.safeAttr("target",i),t)for(f=0;f<t.length;f++)e=t[f],u=$afe.jq(document.createElement("input")),u.safeAttr("type","hidden"),u.safeAttr("name",e.Name),u.safeAttr("value",e.Value),r.safeAppend(u);$afe.select("body").safeAppend(r);r.submit();$afe.select("body").remove(r)};$$WPUtil.generateRandomGUID=function(){for(var i="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=0;t<16;t++)i+=n.charAt(Math.floor(Math.random()*n.length));return i};$$WPUtil.highlightNodeText=function(n,t){var r,f,i,u,e;if(null!==n&&null!==(r=n.childNodes)&&0!==r.length)try{for(f=new RegExp("("+t+")","gi"),u=0;u<r.length;u+=1)null!==(i=r[u])&&(3===i.nodeType?f.test(i.nodeValue)&&(e=document.createElement("span"),dangerou$.setHtml(e,HTMLEncode(i.nodeValue).replace(f,'<span class="hilite">$1<\/span>')),n.insertBefore(e,i),n.removeChild(i)):1===i.nodeType&&$$WPUtil.highlightNodeText(i,t))}catch(n){}};$$WPUtil.createAriaLabel=function(n,t){var i=$afe.select("#"+n),r=$afe.select("#arialabels");0===i.length&&(0===r.length&&(r=$afe.jq(document.body).safeAppend($$WP.SimpleTemplates.Div({id:"arialabels"}))),i=$$WP.SimpleTemplates.Span({"class":"clearlabel",id:n},t),r.safeAppend(i))};$$WPUtil.addPopupListener=function(n,t){null==n&&(n=$afe.select("#main"));document.addEventListener("keydown",function(n){$$WPUtil.handlePopupInstructionsKeydown(n,t)});n.find(".popupiconcontainer").each(function(){var n=$afe.jq(this);$$WPUtil.addSinglePopupListener(n,t)})};$$WPUtil.AddPopupListener=$$WPUtil.addPopupListener;$$WPUtil.addSinglePopupListener=function(n,t,i){n.off().hover($$WPUtil.handlePopupInstructions);n.find(".popupinstructionsicon").off().on("blur focus keydown click",function(n){$$WPUtil.handlePopupInstructions(n,t)});n.find(".popupInstructions").off().on("blur focus keydown click",function(n){$$WPUtil.handlePopupInstructions(n,t)});i&&document.addEventListener("keydown",function(n){$$WPUtil.handlePopupInstructionsKeydown(n,t)})};$$WPUtil.removePopupListener=function(n){null==n&&(n=$afe.jq("#main"));var t=n.find(".popupiconcontainer");t.off();t.find(".popupinstructionsicon").off();t.find(".popupInstructions").off()};$$WPUtil.isValidPhoneNumber=function(n){return new RegExp(/^\+?\d{6,13}((x|X)?\d{4})?$/).test(n)};$$WPUtil.PrintAndAuditNET=function(){window.print();$.ajax({url:makeLink("Home/AuditPrint"),type:"POST",data:{title:document.title}})};$$WPUtil.clearAlertCache=function(){};$$WPUtil.logoutAndShowError=function(n){$$WP.Utilities.TryRedirect(makeLink("Home/Logout?error="+n))};$$WPUtil.regExEscapeString=function(n){var i,t;if("string"!=typeof n)return"";for(i="",t=0;t<n.length;t++)i+="\\u"+("0000"+n.charCodeAt(t).toString(16)).substr(-4);return i};$$WPUtil.IsSupportedChars=function(n){return new RegExp(/^[\x09\x0A\x0D\x20-\x7E\xA0-\xFF\u0152\u0153\u0160\u0161\u0178\u017D\u017E\u0192\u02C6\u02DC\u2013\u2014\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2026\u2030\u2039\u203A\u20AC\u2122]*$/).test(n)};$$WPUtil.RemoveUnsupportedChars=function(n){return n.split("").filter($$WPUtil.IsSupportedChars).join("")};$$WPUtil.IsH2GActivity=function(n){return!!$$WPUtil.IsVisitsListUrl(n)||!!$$WPUtil.IsTestResultsUrl(n)||!!$$WPUtil.IsMedsListUrl(n)||!!$$WPUtil.IsAllergiesListUrl(n)||!!$$WPUtil.IsHealthIssuesUrl(n)};$$WPUtil.IsVisitsListUrl=function(n){return-1!==(n=n.toLowerCase()).indexOf("visits/visitslist")||-1!==n.indexOf("mode=appointments")||-1!==n.indexOf("mode=visits")||-1!==n.indexOf("mode=recentappts")};$$WPUtil.IsTestResultsUrl=function(n){return-1!==(n=n.toLowerCase()).indexOf("clinical/testresults")||-1!==n.indexOf("mode=labs")};$$WPUtil.IsMedsListUrl=function(n){return-1!==(n=n.toLowerCase()).indexOf("clinical/medications/list")||-1!==n.indexOf("mode=medslist")};$$WPUtil.IsAllergiesListUrl=function(n){return-1!==(n=n.toLowerCase()).indexOf("clinical/allergies")||-1!==n.indexOf("mode=allergies")};$$WPUtil.IsHealthIssuesUrl=function(n){return-1!==(n=n.toLowerCase()).indexOf("clinical/healthissues")||-1!==n.indexOf("mode=hlthissues")};$$WPUtil.IsHealthSummaryUrl=function(n){return-1!==(n=n.toLowerCase()).indexOf("mode=snapshot")};$$WPUtil.defaultAjaxErrorHandler=function(n,t,i){var e,u,r,f;if(!0!==$$WP.IsEpicAjaxErrorHandlerDisabled)if(i.suppressEpicDefaultAjaxErrorHandler||i.hasOwnErrorHandler||200===t.status)$$WP.Debug.IsEnabled&&$$WP.Debug.logError("Ajax call to "+i.url+" received an error response and has the default error handler suppressed.",!0);else if("abort"===t.statusText||"canceled"===t.statusText||function(n){return 0===n.status&&!n.getAllResponseHeaders()}(t))$$WP.Debug.log(t.statusText+" ajax call to "+i.url+".",!0);else if(!i.hasOwnErrorHandler){if(WP.Events.cancelBeforeUnload(),!$$WP.Debug.IsEnabled&&($afe.select("#content").children().addClass("hidden"),$$WP.Utilities.UI.IsMobile))return void(window.location.href=makeLink("500.aspx"));if(0!==$afe.select(".AjaxErrorHandler.Popup").length)return;f=$$WPContain.Popup.SizeEnum.SMALL;$$WP.Debug.IsEnabled&&void 0!==t.responseText?(u=(r=(r=t.responseText).substring(r.indexOf("<body"),r.indexOf("<\/body"))).substring(r.indexOf(">")+1,r.length),f=$$WPContain.Popup.SizeEnum.LARGE):u=$$WP.Strings.get("DefaultAjaxErrorHandlerMessage","global");e=new $$WPComp.MessageComponent({TitleText:$$WP.Strings.get("DefaultAjaxErrorHandlerTitle","global"),Message:u,ToolbarButtons:[new $$WPComp.ComplexObjects.Button($$WP.Strings.get("ClosePopupButton","Core.Utilities"),null,"cancelworkflow")]});$$WPUtil.quickPopup(e,{Size:f,positioningFunction:$$WPContain.Positions.InsideNearTop,HasBackButton:!1,Class:"AjaxErrorHandler"});$afe.select("#content").removeAttr("id");$afe.select(".messageComponent").find("#content").removeAttr("id")}};$$WPUtil.isLocalStorageAvailable=function(){var n="test";try{window.localStorage.setItem(n,n);window.localStorage.removeItem(n)}catch(n){return!1}return!0};$$WPUtil.UseHTML5InputControls=function(){$$WP.Utilities.isBrowserCapableOf("input",{type:"number"})&&$afe.select("input[data-inputtype='number']").each(function(){this.type="number"});$$WP.Utilities.isBrowserCapableOf("input",{type:"phone"})&&$afe.select("input[data-inputtype='phone']").each(function(){this.type="phone"});$$WP.Utilities.isBrowserCapableOf("input",{type:"email"})&&$afe.select("input[data-inputtype='email']").each(function(){this.type="email"});$$WP.Utilities.isBrowserCapableOf("input",{type:"date"})&&$afe.select("input[data-inputtype='date']").each(function(){this.type="date"});$$WP.Utilities.isBrowserCapableOf("input",{type:"time"})&&$afe.select("input[data-inputtype='time']").each(function(){this.type="time"})};$$WPUtil.FixScrollingForIOS=function(n){n.on("blur","input, textarea",function(){window.scrollBy(0,0)})};$$WPUtil.ShowAjaxSpinner=function(n,t){if(null!==n){if(n.length>1&&$$WP.Debug.logError("Multiple ajax spinners passed to ShowAjaxSpinner"),!0!==t&&n.removeClass("hidden"),!n.hasClass("hidden")){var i=n.contents();n.empty();n.safeAppend(i)}!0!==t&&setTimeout(function(n){$$WPUtil.ShowAjaxSpinner(n,!0)},1500,n)}};$$WPUtil.HideAjaxSpinner=function(n){n.addClass("hidden")};$$WPUtil.GetRawString=function(n){return n&&!$$WPUtil.IsNullOrEmpty(n.string)?n.string:"string"==typeof n?n:""};$$WPUtil.GetQueryStringParameterValue=function(n,t){var i;return null===(i=new RegExp("[?&]"+t+"=([^&#]*)").exec(n))?"":decodeURIComponent(i[1])};$$WPUtil.GetTextareaBucketClass=function(n){if(n<1)return"";var t=n-1-(n-1)%25+25;return t>300&&(t="unlimited"),"textbucket"+t+"chars"};$$WPUtil.AddSingleLineTextareaListeners=function(){$afe.select(".singleLineFreeText").each(function(){this.addEventListener("keydown",function(n){13===(n.which||n.keyCode)&&n.preventDefault()});this.addEventListener("input",function(n){n.target.value=n.target.value.replace(/\n/g,"")})})};$$WPUtil.SetCrossDomainData=function(n){window.parent.postMessage({method:"setValues",data:n},$$WP.ParentDomain)};$$WPUtil.DeleteCrossDomainData=function(n){window.parent.postMessage({method:"deleteLocalStorageValue",key:n},$$WP.ParentDomain)};$$WPUtil.GetCrossDomainData=function(n){return new Promise(function(t){var i=new MessageChannel;i.port1.onmessage=function(n){t(n.data)};window.parent.postMessage({method:"getValue",key:n},$$WP.ParentDomain,[i.port2])})};$$WPUtil.GetIframeWidth=function(){return new Promise(function(n){var t=new MessageChannel;t.port1.onmessage=function(t){n(t.data)};window.parent.postMessage({method:"getWidth",id:$$WP.WidgetID},$$WP.ParentDomain,[t.port2])})};$$WPUtil.SetCrossDomainIframeHeight=function(n){window.parent.postMessage({method:"setHeight",height:n,id:$$WP.WidgetID},$$WP.ParentDomain)};$$WPUtil.SetCrossDomainIframeMinHeight=function(n){window.parent.postMessage({method:"setMinHeight",height:n,id:$$WP.WidgetID},$$WP.ParentDomain)};$$WPUtil.ScrollTopOfTheIframeCrossDomain=function(){window.parent.postMessage({method:"scrollTopOfTheIframe",id:$$WP.WidgetID},$$WP.ParentDomain)};$$WPUtil.RefreshHeader=function(){var n=function(){alert($$WP.Strings.get("WidgetRefreshAlert","Global"))||window.location.reload()};$$WP.WidgetMode&&$.ajax({url:makeLink("Widget/RefreshHeader"),type:"GET",success:function(t){t.headerValue?$$WP._WidgetToken=t.headerValue:n()},error:n})};$$WPUtil.GetPageNonce=function(){var n=document.getElementById("cspScripts");return n?n.nonce||n.getAttribute("nonce"):""};$$WPUtil.LogTabClick=function(n,t){!n||t<=0||getCSRFTokenAsQS(function(){$.ajax({url:makeLink("Home/LogTabClick"),type:"POST",data:{idnId:n,count:t}})})};$$WPUtil.SendBeacon=function(n,t,i,r){return i=void 0===i||i,void 0===r&&"string"!=typeof t&&i?($$WP.Debug.logError("contentType must be specified when calling SendBeacon with data that is not a string."),!1):(r=void 0!==r?r:"text/plain;charset=UTF-8",navigator.sendBeacon?navigator.sendBeacon(n,t):!!i&&($.ajax({url:n,method:"POST",data:t,contentType:r}),!0))};Epic=Epic||{};Epic.PatientAccess=Epic.PatientAccess||{};$$WP=$$WP||Epic.PatientAccess;$$WP.Settings=$$WP.Settings||{};$$WP.Settings.ScriptPath="Scripts/";console=console||{error:function(){},log:function(){},warn:function(){}};!function(){var n=function(n){var t;if("object"!==$.type(n))return!1;if(n instanceof this)return!0;if("function"==typeof n._constructor&&Array.isArray(n._constructors)){if(n._constructor===this)return!0;for(t=0;t<n._constructors.length;t++)if(n._constructors[t]===this)return!0}return!1};Function.prototype.extend=function(t,i){var u,r,e,s,o,h,c,f;if("function"==typeof t&&"object"===$.type(t.prototype)){if(e=(r=t)._className,c=i,"function"!=typeof r||"object"!==$.type(r.prototype))return void console.error("Provided parent class was not a valid class. Cannot perform inheritance.")}else{for(r=i||$$WP,s=t.split("."),e=t.replace(/\./g,"$"),o=0;o<s.length;o++){if("object"!==$.type(r)){r=null;break}r=r[s[o]]}if("function"!=typeof r||"object"!==$.type(r.prototype))return void console.error("Did not find a class named "+t+" in the given root namespace. Cannot perform inheritance.")}for(u in this._inheritedMethods={},this.prototype[e]=r,this._inheritedMethods[e]=!0,this._className=c,h={_constructor:!0,_constructors:!0},r.prototype)"string"!=typeof u||h[u]||(f=r.prototype[u],"function"==typeof r.prototype[u]&&(r._inheritedMethods[u]?(this.prototype[u]=f,this._inheritedMethods[u]=!0):(this.prototype[e+"$"+u]=f,this._inheritedMethods[e+"$"+u]=!0)),void 0===this.prototype[u]&&(this.prototype[u]="object"!==$.type(f)||f instanceof jQuery||Array.isArray(f)?f:$$WP.Utilities.copyObject(f)));this.prototype._constructor=this;this.prototype._constructors=$$WP.Utilities.copyObject(r.prototype._constructors);this.prototype._constructors.push(r);this.isInstance=n};$$WP.BaseObject=function(){};$$WP.BaseObject._className="WP$BaseObject";$$WP.BaseObject._inheritedMethods={};$$WP.BaseObject.prototype={_constructor:$$WP.BaseObject,_constructors:[]}}();window.onerror=function(n,t,i,r,u){var f;if(f=n?'"'+n+'"':"unhandled exception",u&&u.stack)try{WP&&WP.DOM&&WP.DOM.Browser.isIE||WP.DOM.Browser.isLegacyEdge?(console.groupCollapsed("Stack Trace for "+f),console.error(u.stack),console.groupEnd()):(console.groupCollapsed("Stack Trace for "+f,""),console.error(u.message),console.groupEnd());$$WP.Debug._errorCount++;$$WP.Debug._updateErrorCountDisplay()}catch(n){}};$$WP=$$WP||{};$$WP.Utilities=$$WP.Utilities||{};$$WP.Utilities.UI=$$WP.Utilities.UI||{};$$WP.Utilities.UI.OnUIFrameworkLoaded&&$$WP.Utilities.UI.OnUIFrameworkLoaded(function(){!$$WP.Utilities.UI.IsMobile&&$$WP.Debug.CheckForStringResources&&$.ajax({url:makeLink("/Tests/CheckStringResources"),dataType:"json",global:!1,error:function(){$$WP.Debug.log("Debug: Couldn't check for missing string resources. /Tests/CheckStringResources is not available.")},success:function(n){var i,r,t="";if(!n.IsSuccess){if(t+='<div id="missingStringsWarning">',t+='<p>Incorrect strings detected in .resx files!!! <a href="#" data-function="dismiss">[X]<\/a><\/p>',t+='<p><a href="#" data-function="toggleDetails">[+/- details]<\/a><\/p>',t+='<div data-contents="details" class="jqHidden">',n.MissingStrings&&n.MissingStrings.length>0)for(t+="~ MISSING ~<br/>",i=0;i<n.MissingStrings.length;i++)t+=n.MissingStrings[i]+"<br/>";if(n.ModifiedStrings&&n.ModifiedStrings.length>0)for(t+="~ MODIFIED ~<br/>",i=0;i<n.ModifiedStrings.length;i++)t+=n.ModifiedStrings[i]+"<br/>";if(n.ExtraStrings&&n.ExtraStrings.length>0)for(t+="~ UNUSED ~<br/>",i=0;i<n.ExtraStrings.length;i++)t+=n.ExtraStrings[i]+"<br/>";t+="<\/div>";t+="<\/div>";(r=dangerou$.parseHtml(t)).on("click",'[data-function="toggleDetails"]',function(n){n.preventDefault();n.stopPropagation();r.find('[data-contents="details"]').toggle()});r.on("click",'[data-function="dismiss"]',function(n){n.preventDefault();n.stopPropagation();r.remove()});$afe.select("body").safeAppend(r)}}})});$$WP=$$WP||{};$$WP.Debug=$$WP.Debug||{};$$WP.Debug.UI=$$WP.Debug.UI||{};$$WP.Debug.UnitTest=$$WP.Debug.UnitTest||{};$$WP.Debug.UnitTest.tests=$$WP.Debug.UnitTest.tests||[];$$WP.Debug._failedAssertions=0;$$WP.Debug._assertions=0;$$WP.Debug._errorCount=0;$$WP.Debug._$errorCountDisplay=null;$$WP.Debug.log=function(n,t){var i;if(n=n||"",$$WP.Debug.IsEnabled)try{i=new Error(n);t&&console.trace?(console.groupCollapsed($$WP.Debug.messagePrefix+n),console.trace(),console.groupEnd()):t&&"stack"in i?(console.groupCollapsed($$WP.Debug.messagePrefix+n),console.log(i.stack),console.groupEnd()):console.log($$WP.Debug.messagePrefix+n)}catch(n){}};$$WP.Debug.logError=function(n,t){var r,i;if(n=n||"","boolean"!=typeof t&&(t=!0),t){try{WP&&WP.DOM&&WP.DOM.Browser.isIE||WP.DOM.Browser.isLegacyEdge?(console.groupCollapsed($$WP.Debug.messagePrefix+n),console.trace(),console.groupEnd()):console.error($$WP.Debug.messagePrefix+n,"");i=!0}catch(t){try{(r=new Error(n)).stack.length>0&&(console.groupCollapsed($$WP.Debug.messagePrefix+n),console.error(r.stack,""),console.groupEnd(),i=!0)}catch(n){}}if(!i)try{console.error($$WP.Debug.messagePrefix+n,"")}catch(n){}}else try{console.error($$WP.Debug.messagePrefix+n,"")}catch(n){}$$WP.Debug._errorCount++;$$WP.Debug._updateErrorCountDisplay()};$$WP.Debug._updateErrorCountDisplay=function(){$$WP.Debug.IsEnabled&&(null===$$WP.Debug._$errorCountDisplay&&($$WP.Debug._$errorCountDisplay=$afe.jq(document.createElement("div")),$$WP.Debug._$errorCountDisplay.css({position:"absolute","background-color":"red",color:"white","font-weight":"bold",width:"auto",padding:"1px","margin-left":"2px","z-index":"100"}),$afe.select("#header").safePrepend($$WP.Debug._$errorCountDisplay)),$$WP.Debug._$errorCountDisplay.empty(),$$WP.Debug._$errorCountDisplay.text("Errors in console: "+$$WP.Debug._errorCount))};$$WP.Debug.ShowNonProdBanner=function(){if("true"!==sessionStorage.HideNonProdBanner){var t,n="";n+='<div id="nonProdBanner">';n+="<strong><span>"+$$WP.Strings.get("NonProdErrorMessage","global")+'&nbsp;<a href="#" data-function="dismiss" title="'+$$WP.Strings.get("NonProdErrorMessageDismissTitle","global")+'">[X]<\/a><\/span><\/strong>';n+="<\/div>";(t=dangerou$.parseHtml(n)).on("click",'[data-function="dismiss"]',function(n){sessionStorage.setItem("HideNonProdBanner","true");n.preventDefault();n.stopPropagation();$$WP.Debug.RemoveBanner(t)});$$WP.Debug.AddBanner(t)}};$$WP.Debug.ShowAdminElevationBanner=function(){var t,i,n,r;t=$$WP.Strings.get("AdminBannerText","global");i=$$WP.Strings.get("AdminBannerAction","global");n='<div class="adminElevationBanner" id="adminElevationBanner">';n+="<strong><span>"+t+'&nbsp;[<a href="#"  data-function="endsession" ';n+='title="'+$$WP.Strings.get("AdminBannerActionTitle","global")+'">'+i+"<\/a>]<\/span><\/strong ><\/div >";(r=dangerou$.parseHtml(n)).on("click",'[data-function="endsession"]',$$WP.Debug.PromptToEndElevatedSession);$$WP.Debug.AddBanner(r)};$$WP.Debug.PromptToEndElevatedSession=function(){var n,t;n={ToolbarButtons:[{Text:$$WP.Strings.get("AdminPopupConfirmButtonText","global"),Class:"completeworkflow"},{Text:$$WP.Strings.get("AdminPopupCancelButtonText","gloal"),Class:"cancelworkflow"}],TitleText:$$WP.Strings.get("AdminPopupTitleText","global"),Html:$$WP.Strings.get("AdminPopupMessageText","global"),IsClosable:!0,callback:function(n){n&&($$WP.Debug.ClearClipboard(),this.dispose(!0),window.location.href=makeLink("/Authentication/ServerAdmin/ClearElevation"))}};t=new $$WPComp.ConfirmComponent(n,{Size:$$WPContain.Popup.SizeEnum.SMALL});$$WPUtil.quickPopup(t)};$$WP.Debug.ClearClipboard=function(){var n;n=dangerou$.parseHtml('<input id="clearClipboard" type="text" id="clearText" value=" " />');$afe.select("body").safePrepend(n);n.select();document.execCommand("copy");n.remove()};$$WP.Debug.AddBanner=function(n){$$WP.Debug.CreateBannerContainer();setTimeout(function(){$afe.select("#sitebanner").safePrepend(n);$$WP.Debug.UpdateTopMarginForBanners()},100)};$$WP.Debug.RemoveBanner=function(n){$afe.select("#sitebanner").safeAttr("role","");n.remove();$afe.select("#sitebanner").safeAttr("role","alert");$$WP.Debug.UpdateTopMarginForBanners()};$$WP.Debug.UpdateTopMarginForBanners=function(){var i=$afe.select("#wrap"),r=$afe.select("#header"),u=$afe.select("#content"),n=$afe.select(".titlebar"),t=$afe.select(".Popup");$$WP.Debug.UpdateTopMarginForBanner(i);$$WP.Debug.UpdateTopMarginForBanner(t);$$WP.Utilities.UI.IsLoggedIn&&($$WP.Debug.UpdateTopMarginForBanner(r),$$WP.Debug.UpdateTopMarginForBanner(u));$afe.jq(document).width()<1300&&!t?$$WP.Debug.UpdateTopMarginForBanner(n):0!==n.length&&n.css("margin-top",0)};$$WP.Debug.UpdateTopMarginForBanner=function(n){var t=$afe.select("#sitebanner").height();0!==n.length&&n.css("margin-top",t)};$$WP.Debug.CreateBannerContainer=function(){if(0===$afe.select("#sitebanner").length){var n;n=dangerou$.parseHtml('<div id="sitebanner" class="sitebanners" role="alert"><\/div>');$afe.select("body").safePrepend(n)}};$$WP.Debug._synchronousAjax=function(n,t){var i;(i=(i="object"==typeof n?n:t)||{}).async=!1;$$WP.Debug._oldAjax(n,i)};$$WP.Debug.makeAjaxSynchronous=function(){if($$WP.Debug.IsEnabled){if($.ajax===$$WP.Debug._synchronousAjax)return;$$WP.Debug._oldAjax=$$WP.Debug._oldAjax||$.ajax||jQuery.ajax;$.ajax=$$WP.Debug._synchronousAjax}};$$WP.Debug.allowAjaxAsynchronous=function(){$.ajax===$$WP.Debug._synchronousAjax&&($.ajax=$$WP.Debug._oldAjax)};$$WP.Debug.UnitTest.assert=function(n,t){$$WP.Debug._assertions++;n||($$WP.Debug._failedAssertions++,$$WP.Debug.logError(t,!1))};$$WP.Debug.UnitTest.assertValue=function(n,t,i){$$WP.Debug.UnitTest.assert(n===t,i+"(expected '"+n+"', got '"+t+"')")};$$WP.Debug.UnitTest.cssClassesMatch=function(n,t){var i,r;if(i=n.safeAttr("class").split(" "),(t=t.split(" ")).length!==i.length)return!1;for(i.sort(),t.sort(),r=0;r<i.length;r++)if(i[r]!==t[r])return!1;return!0};$$WP.Debug.UnitTest.resetCounters=function(){$$WP.Debug._failedAssertions=0;$$WP.Debug._assertions=0};$$WP.Debug.UnitTest.getFailedAssertionCount=function(){return $$WP.Debug._failedAssertions};$$WP.Debug.UnitTest.runAll=function(n){var t,f,i,e,h,a,o,s,r,u,c,l;if($$WP.Debug.IsEnabled)for(n=n||$afe.select("body"),l=$$WP.SimpleTemplates.WarningIcon({"class":"testWarning"}),0!==(t=$afe.select("#WP-Debug-UnitTest-TestingRange")).length?((f=t.find('table[name="resultsTable"]')).empty(),(i=t.find('div[name="sandbox"]')).empty()):(t=$$WP.SimpleTemplates.Div({id:"WP-Debug-UnitTest-TestingRange"}),f=dangerou$.parseHtml('<table name="resultsTable"><tr><th class="testName">Test name<\/th><th class=""testResult>Result<\/th><\/tr><\/table>'),i=$$WP.SimpleTemplates.Div({name:"sandbox"}),n.safeAppend(t),t.safeAppend(f),t.safeAppend(i)),e=0;e<$$WP.Debug.UnitTest.tests.length;e++){h=$$WP.Debug.UnitTest.tests[e];$$WP.Debug.UnitTest.resetCounters();c=!1;try{h(i)}catch(n){$$WP.Debug.log(n.stack);c=!0}s=$$WP.Debug.UnitTest.getFailedAssertionCount();r=$$WP.Debug._assertions;c?($$WP.Debug.log("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX Test Failed XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"),u=dangerou$.parseHtml('<td class="testResult exceptionThrown">'+l[0].outerHTML+" Test failed "+s+" of "+r+" checks. Did not run the entire test due to an unhandled exception.<br/>See console for more details<\/td>")):s>0?($$WP.Debug.log("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX Test Failed XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"),u=dangerou$.parseHtml('<td class="testResult failedAssertion">'+l[0].outerHTML+" Test failed "+s+" of "+r+" checks. See console for more details.<\/td>")):0===r?($$WP.Debug.log("No test cases defined for this module."),u=dangerou$.parseHtml('<td class="testResult noAssertion">No test cases defined for this module.<\/td>')):u=dangerou$.parseHtml('<td class="testResult passed">Test passed all '+r+" checks<\/td>");i.empty();o=dangerou$.parseHtml("<tr><\/tr>");a=h.name||"Test";o.safeAppend(dangerou$.parseHtml('<td class="testName">'+a.replace(/UnitTests\$/,"")+"<\/td>"));o.safeAppend(u);f.safeAppend(o)}},function(){var n={},t=function(){};t.prototype={addMonitor:function(t,i){$$WP.Debug.IsEnabled&&(n[t]=i)},getWorkflow:function(t){if($$WP.Debug.IsEnabled&&n[t])return n[t]},removeMonitor:function(t){$$WP.Debug.IsEnabled&&delete n[t]}};$$WP.Debug.Workflow=$$WP.Debug.Workflow||new t}();!function(){$$WP.I18N=$$WP.I18N||{DateFormat:null,TimeFormat:null,TimeSeparator:null,AmDesignator:null,PmDesignator:null,Days:[],Months:[],DecimalSeparator:null,GroupSeparator:null,RangeSeparator:null,NegativePattern:null,CenturyRollover:15,BirthdayRollOver:0};$$WP.I18N.getMyChartLocale=function(){return $$WP.I18N.Identifier};$$WP.I18N.getDateFormatForDisplay=function(){return this.DateFormat.toLowerCase().replace(/m+/g,$$WP.Strings.get("MM","Core.FormValidation")).replace(/d+/g,$$WP.Strings.get("DD","Core.FormValidation")).replace(/y+/g,$$WP.Strings.get("YYYY","Core.FormValidation"))};$$WP.I18N.getTimeFormatForDisplay=function(){return this.TimeFormat.toLowerCase().replace(/h+/g,$$WP.Strings.get("HH","Core.FormValidation")).replace(/m+/g,$$WP.Strings.get("MI","Core.FormValidation")).replace(/t+/g,$$WP.Strings.get("TT","Core.FormValidation"))};$$WP.I18N.getOrderedDatePieces=function(n,t,i){var u=$$WP.I18N.DateFormat.toLowerCase(),r;return n&&u.replace(/y+/,""),r={},i||(r.d=u.indexOf("d")),t||(r.m=u.indexOf("m")),n||(r.y=u.indexOf("y")),Object.keys(r).sort(function(n,t){return r[n]-r[t]})};$$WP.I18N.formatPatientGivenDate=function(n,t){var i,r;return n instanceof Date?(void 0===t&&(t=!1),r=$$WP.I18N.DateFormat.toLowerCase(),(i={dayOfMonth:t?n.getDate():n.getUTCDate(),month:(t?n.getMonth():n.getUTCMonth())+1,year:("0000"+(t?n.getFullYear():n.getUTCFullYear())).substr(-4)}).dayOfMonth<10&&r.indexOf("dd")>-1&&(i.dayOfMonth="0"+i.dayOfMonth),i.month<10&&r.indexOf("mm")>-1&&(i.month="0"+i.month),-1===r.indexOf("yyyy")&&(i.year=(i.year+"").substring(2,4)),r.replace(/d+/,i.dayOfMonth).replace(/m+/,i.month).replace(/y+/,i.year)):""};$$WP.I18N.parseDate=function(n,t){var i=new $$WP.I18N.Date(n,"",t);return i.isSpilledOver()?null:i.DateObject};$$WP.I18N.ISOUTCToLocaleDateTime=function(n,t){var i,r;return $$WP.Utilities.IsNullOrEmpty(t)&&(t=(new Intl.DateTimeFormat).resolvedOptions().timeZone),r=new Date(n),i=$$WP.I18N.getMyChartLocale(),r.toLocaleString(i,{timeZone:t,timeZoneName:"short"})};$$WP.I18N.formatPatientGivenTime=function(n,t){var i,r,u;return n instanceof Date?(void 0===t&&(t=!1),u=(r=$$WP.I18N.TimeFormat.toLowerCase()).indexOf("t")>-1,i={hour:t?n.getHours():n.getUTCHours(),minute:t?n.getMinutes():n.getUTCMinutes(),amPm:""},u&&(i.hour>=12?(i.amPm=$$WP.I18N.PmDesignator,i.hour>12&&(i.hour=i.hour-12)):(i.amPm=$$WP.I18N.AmDesignator,0===i.hour&&(i.hour=12))),r.indexOf("hh")>-1&&i.hour<10&&(i.hour="0"+i.hour),i.minute<10&&(i.minute="0"+i.minute),r.replace(/h+/,i.hour.toString()).replace(/m+/,i.minute.toString()).replace(/t+/,i.amPm)):""};$$WP.I18N.parseTime=function(n){var t,r,i,u,f,e;if("string"!=typeof n||(n=n.toLocaleLowerCase().replace(/\s/g,""),f=$$WP.I18N.AmDesignator.toLocaleLowerCase().replace(/[^a-zA-Z]/g,""),e=$$WP.I18N.PmDesignator.toLocaleLowerCase().replace(/[^a-zA-Z]/g,""),null===(t=n.match(new RegExp("(?:[a-z].? ?)+|[0-9]{1,2}","g")))||1!==t.length&&2!==t.length&&3!==t.length))return null;for(r=0;r<t.length;r++)if(0===t[r].length)return null;return 2!==t.length&&3!==t.length||!isNaN(Number(t[0]))&&!isNaN(Number(t[1]))&&2===t[0].length&&1===t[1].length&&n.indexOf(t[0]+""+t[1])>-1&&(t[1]=t[0].charAt(1)+""+t[1],t[0]=t[0].charAt(0)),null===(i=this._validateHours(t[0]))?null:1===t.length?this._buildTime(i,0):2===t.length?(t[1]=t[1].replace(/[^a-zA-Z0-9]/g,""),t[1]!==f.substring(0,t[1].length)&&t[1]!==e.substring(0,t[1].length)?null===(u=this._validateMinutes(t[1]))?null:this._buildTime(i,u):this._buildTime(i,0,t[1],f,e)):null===(u=this._validateMinutes(t[1]))?null:(t[2]=t[2].replace(/[^a-zA-Z0-9]/g,""),this._buildTime(i,u,t[2],f,e))};$$WP.I18N._validateHours=function(n){var t=Number(n);return isNaN(t)||t<0||t>23?null:t};$$WP.I18N._validateMinutes=function(n){var t;return 2!==n.length?null:(t=Number(n),isNaN(t)||t<0||t>59?null:t)};$$WP.I18N._accountForAmPm=function(n,t,i,r){if(n<1||n>12)return null;if(t===i.substring(0,t.length))12===n&&(n=0);else{if(t!==r.substring(0,t.length))return null;12!==n&&(n+=12)}return n};$$WP.I18N._buildTime=function(n,t,i,r,u){var f;return i&&null===(n=this._accountForAmPm(n,i,r,u))?null:((f=new Date(0)).setUTCHours(n),f.setUTCMinutes(t),f)};$$WP.I18N.parse24HrTime=function(n){var t,i,r;return RegExp("^[0-9]{1,2}:{1}[0-9]{2}$").test(n)?(t=n.split(":"),null===(i=$$WP.I18N._validateHours(t[0]))||null===(r=$$WP.I18N._validateMinutes(t[1]))?null:$$WP.I18N._buildTime(i,r)):null};$$WP.I18N.formatNumber=function(n,t,i){var u,s,r,c,h,e,f,o;return"number"!=typeof n?"":(t=t||0,s=Math.abs(n),r=Math.floor(s),o=s.toString().length-r.toString().length-1,i&&(o=t),o<0&&(o=0),h=(c=$$WP.I18N.Round(s-r,o))-0,t>0?(f=(e=$$WP.I18N.Round(h,t))-0,i?(f>=1&&(r+=1,e=$$WP.I18N.Round(f-1,t)),u=r.toFixed(0)+$$WP.I18N.DecimalSeparator+e.substring(2)):0===h?u=r:c.substring(2).length<=t?u=r.toFixed(0)+$$WP.I18N.DecimalSeparator+c.substring(2):(f>=1&&(r+=1,e=$$WP.I18N.Round(f-1,t)),u=f>0?r.toFixed(0)+$$WP.I18N.DecimalSeparator+e.substring(2):r.toFixed(0))):u=h>=.5?(r+1).toFixed(0):r.toFixed(0),n<0&&(u=$$WP.I18N.NegativePattern.replace("n",u)),u)};$$WP.I18N.Round=function(n,t){return Number(Math.round(n+"e"+t)+"e-"+t).toFixed(t)};$$WP.I18N.parseCurrency=function(n){var t=$$WP.Currency.Helpers.currencyToNumber(n);return isNaN(t)?NaN:t};$$WP.I18N.parseNumber=function(n){var i,f,c,r,l,e,o,s,a,v,y,t,h,u;return 0===(n+="").length?NaN:((s=getGroupSeparator()).length>0&&((v=new RegExp("\\s","g")).test(s)?n=n.replace(v,""):(a=new RegExp($$WP.Utilities.regExEscapeString(s),"g"),n=n.replace(a,""))),c=$$WP.Utilities.regExEscapeString("n"),r=$$WP.Utilities.regExEscapeString($$WP.I18N.DecimalSeparator),e=(l=$$WP.Utilities.regExEscapeString($$WP.I18N.NegativePattern).replace(c,"n")).replace("n",""),n=n.trim(),new RegExp("[^\\d"+r+e+"]").test(n)?NaN:(o="((\\d+("+r+"\\d*)?)|("+r+"\\d+))",t=n,(y=new RegExp("^"+l.replace("n",o)+"$").test(n))&&(t=n.replace(new RegExp("["+e+"]","g"),"")),new RegExp("^"+o+"$").test(t)?(h=0,u=0,t.charAt(0)===$$WP.I18N.DecimalSeparator?u=Number(t.substring(1))/Math.pow(10,t.length-1):(i=t.split($$WP.I18N.DecimalSeparator),h=Number(i[0]),i.length>1&&(u=Number(i[1])/Math.pow(10,i[1].length))),f=h+u,y&&(f*=-1),f):NaN))};$$WP.I18N.getDateAriaString=function(n){return $$WP.I18N.getDateAriaStringCore(n,!0,!1)};$$WP.I18N.getDateAriaStringCore=function(n,t,i){return $$WP.I18N.getFormattedDateString(n,t,!0,!0,i)};$$WP.I18N.getCalendarDateAriaString=function(n){var t=$$WP.I18N.CalendarDateAriaFormat;return t?buildFormat(t)(n):$$WP.I18N.getDateAriaString(date)};$$WP.I18N.getFormattedDateString=function(n,t,i,r,u){var f=$$WP.I18N.DateFormat.toLowerCase().replace(/[^mdy]/g," ");return f=(f=(f=f.replace(/dd+/,r?n.getDate():"")).replace(/yy+/,t?n.getFullYear():"")).replace(/mm+/,i?getMonthName(n.getMonth()+1):""),u&&(f=f+" "+getDayName(n.getDay())),f};$$WP.I18N.monthTitleFormat=function(n){return buildFormat("MMMM yyyy")(n)};$$WP.I18N.upperCaseFirstLetter=function(n){return n.charAt(0).toUpperCase()+n.slice(1)};$$WP.I18N.Handlebars={verticalDate:function(n,t){for(var s,u='<div><span class="clearlabel">*REPLACE*<\/span>',e=!1,o=!1,i="",r="",f=0;f<t.length;f++){switch(t[f]){case"d":i="verticalDateOfMonth";r=n.getDate();break;case"m":i="verticalMonth";r=getMonthAbbr(n.getMonth()+1);break;case"y":i="verticalYear";r=n.getFullYear();e=!0;break;case"dow":i="verticalDayOfWeek";r=getDayAbbr(n.getDay());o=!0}u=u+'<div aria-hidden="true" class="'+i+'">'+r+"<\/div>"}return u+="<\/div>",s=$$WP.I18N.getDateAriaStringCore(n,e,o),u.replace("*REPLACE*",s)}};$$WP.I18N.setClientTimeZone=function(){if($$WPUtil.canWriteCookies()){var n=Intl.DateTimeFormat().resolvedOptions().timeZone;$.ajax({url:makeLink("Localization/LogClientTimeZone"),data:{timeZoneIdentifier:n},type:"POST"})}};$$WP.I18N.formatList=function(n,t){var u,i,r;u=$$WP.I18N.getMyChartLocale();(i=t||{}).style&&i.style.length>0&&(!i.type||0===i.type.length)&&$$WP.Debug&&$$WP.Debug.log&&$$WP.Debug.log("Invalid list formatting options, if you specify a style you should specify a type.",!0);try{r=new Intl.ListFormat(u,i)}catch(n){}return void 0===r?n.join(", "):r.format(n)};$$WP.I18N.parseYear=function(n,t){var r,i,u;return 2===n.length?(r=(new Date).getFullYear(),i=Number(n),i+=r-r%100,u=$$WP.I18N.CenturyRollover,t&&(u=$$WP.I18N.BirthdayRollOver),i>r+u&&(i-=100)):i=Number(n),$$WP.I18N.__validateYear(i)?i:null};$$WP.I18N.numDaysInMonth=function(n,t){switch(year=void 0===t?2016:t,n){case 2:return year%4!=0||year%100==0&&year%400!=0?28:29;case 4:case 6:case 9:case 11:return 30;default:return 31}};$$WP.I18N.__newReferenceFieldHistory=function(n){var t={};return t.history=n.history,t.pointer=n.pointer,t};$$WP.I18N.__createFieldHistory=function(n){return n||(n=""),{history:[String(n)],pointer:1}};$$WP.I18N.__peekFieldHistory=function(n){return n.history[n.pointer-1]};$$WP.I18N.__pushFieldHistory=function(n,t){return(n=$$WP.I18N.__newReferenceFieldHistory(n)).history=n.history.slice(0,n.pointer),n.history[n.pointer]=t,n.pointer++,n};$$WP.I18N.__resizeFieldHistory=function(n){return(n=$$WP.I18N.__newReferenceFieldHistory(n)).history.length===n.pointer&&42===n.pointer&&(n.history=n.history.slice(n.pointer-21,n.pointer),n.pointer-=21),n};$$WP.I18N.__undoFieldHistory=function(n){return(n=$$WP.I18N.__newReferenceFieldHistory(n)).pointer>1&&n.pointer--,n};$$WP.I18N.__redoFieldHistory=function(n){return(n=$$WP.I18N.__newReferenceFieldHistory(n)).pointer<n.length&&n.pointer++,n};var r=function(t,i,r,u,f,e){return!(t.length<=1||f>=u-1)&&(max=n(i,r),e>max||"y"===i&&3===t.length&&10*e>max)},n=function(n,t){switch(t||(t={}),t.m||(t.m=1),n){case"d":max=$$WP.I18N.numDaysInMonth(t.m,t.y);break;case"m":max=12;break;default:max=(new Date).getFullYear()+$$WP.I18N.CenturyRollover}return max},i=function(n,t){return n.toLowerCase().replace(new RegExp("["+t.join("")+"]","g"),"").charAt(0)},u=function(n,t,i,r,u,f,e,o){return e<n.length-1||!(e>=u-1)&&(1===t.length&&10*n[e]>i||!(e!==n.length-1||!r)||e<u-1&&t.length===o&&t[t.length-1]!==f)};$$WP.I18N.__validateYear=function(n){return(n=parseInt(n))>999&&n<1e4};var f=function(n,t,i){var r=n,u=2;for("y"===t&&(r=null===(r=$$WP.I18N.parseYear(n,i))?n:r.toString(),u=4);r.length<u;)r="0"+r;return r},e=function(t,i,r){return fieldLength="y"===i?4:2,max=n(i,r),!(t.length>=fieldLength)&&(num=parseInt(t),10*num<=n(i,r))},o=function(n,t){return fieldLength="y"===t?4:2,n.length>fieldLength},t=function(n,t){return n.indexOf(t)>-1};$$WP.I18N.deleteLiveDateFormatter=function(n){for(var f=i($$WP.I18N.DateFormat,$$WP.I18N.getOrderedDatePieces()),u=0,r=0,t=n.length-1;t>=0;t--)if(n[t]===f?u++:/[1-9]/.test(n[t])?r++:"0"===n[t]&&0===t?u++:"0"===n[t]&&t>0&&/[1-9]/.test(n[t-1])||"0"===n[t]&&t>1&&"0"===n[t-1]&&/[1-9]/.test(n[t-2])||"0"===n[t]&&t>2&&"0"===n[t-1]&&"0"===n[t-2]&&/[1-9]/.test(n[t-3])?r++:u++,2===r){r--;break}return n.slice(0,n.length-u-r)};$$WP.I18N.processLiveDateFormatter=function(t,s,h){var d,c,tt,it;if(t.length!==s)return t;var w,b,rt,v,k,et=$$WP.I18N.DateFormat,y=$$WP.I18N.getOrderedDatePieces(),nt=y.length,g=i(et,y),ut=function(n,t){return n.replace(/[\\|\/|\.|,|\-| ]/g,t)}(t,g).split(g),ft=function(n,t,i){return n.length<=i&&n.length>1&&(1===n[n.length-2].length||"y"===t[n.length-2])&&""===n[n.length-1]}(ut,y,nt),l=ut.reduce(function(n,t){var i=t.replace(/[\D]/g,"");return""!==i&&n.push(i),n},[]),a=[],p={};if(function(n){return 1===n.length&&!!/^[0-9]+$/.test(n[0])}(l)&&l[0].length>("y"===y[0]?4:2)){for(d="",c=0;c<l[0].length;c++)d=$$WP.I18N.processLiveDateFormatter(d+l[0][c],d.length+1,h);return d}for(c=0;c<l.length;c++)k="y"===(v=y[c])?4:2,o(l[c],v)?(a.push(l[c].slice(0,k)),p[v]=parseInt(l[c]),a.push(l[c].slice(k,l[c].length))):"0"!==l[c].charAt(0)?(b=parseInt(l[c]),r(l[c],v,p,nt,c,b)?(a.push(Math.floor(b/10).toString()),p[v]=parseInt(l[c]),a.push((b%10).toString())):(p[v]=parseInt(l[c]),a.push(b.toString()))):(a.push(l[c]),p[v]=parseInt(l[c]));for(a=a.slice(0,y.length),tt="",c=0;c<a.length;c++)k="y"===(v=y[c])?4:2,w=new String(a[c]),rt=n(y[c],p),it=u(a,w,rt,ft,nt,g,c,k),(it||!e(a[c],v,p)&&ft&&c===a.length-1)&&(w=f(w,y[c],h)),it&&(w+=g),tt+=w;return tt};$$WP.I18N.__clearFormatterAriaAnnouncement=function(n){var t=n.safeAttr("id"),i=(t=t.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1"))+"_autoformatted";$afe.select("#"+i).empty()};$$WP.I18N.__appendFormatterAriaAnnouncement=function(n,t,i,r,u){var s=n.safeAttr("id"),e=(s=s.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1"))+"_autoformatted",h,c,f,o;return $$WP.Strings.setDefaultNamespace("core.formvalidation"),h=$$WP.Strings.get(r?"Birthdate":u?"Time":"Date"),$$WP.Strings.addMnemonic("@MYCHART@FIELDNAME@",h),$$WP.Strings.addMnemonic("@MYCHART@FORMATTEDFIELDVALUE@",i||n.val(),""),c=$$WP.Strings.getForTemplate("FieldUpdatedAnnouncementWithValue").toString(),$$WP.Strings.removeMnemonic("@MYCHART@FORMATTEDFIELDVALUE@"),$$WP.Strings.clearDefaultNamespace(),f=$("#"+e),f.length||(o=$$WP.SimpleTemplates.Span({"class":"clearlabel",id:e,"aria-live":"polite"}),o.safeInsertAfter(n.next().hasClass("calendar")?n.next():n),f=o),t||(f.empty(),f.safeAppend(dangerou$.parseHtml("<span>"+c+"<\/span>"))),e};$$WP.I18N.liveDate=function(n,i,r,u,f,e,o){var c,l,h;void 0===n&&(n="");var a=!1,s=void 0,v=!1;return"deleteContentBackward"===n&&o?(c=$$WP.I18N.__peekFieldHistory(e),s=c?$$WP.I18N.deleteLiveDateFormatter(c):i,c&&c.length-s.length>1&&(a=!0)):t(n,"delete")?s=i:t(n,"insert")?(l=$$WP.I18N.processLiveDateFormatter(i,u,f),void 0!==l&&i!==l?(s=l,a=!0):s!==$$WP.I18N.__peekFieldHistory(e)&&(s=i)):"historyUndo"===n?(e=$$WP.I18N.__undoFieldHistory(e),s=$$WP.I18N.__peekFieldHistory(e),v=!0):"historyRedo"===n?(e=$$WP.I18N.__redoFieldHistory(e),s=$$WP.I18N.__peekFieldHistory(e),v=!0):s=i,e.pointer>0&&s!==$$WP.I18N.__peekFieldHistory(e)&&!t(n,"history")&&(e=$$WP.I18N.__pushFieldHistory(e,s)),e=$$WP.I18N.__resizeFieldHistory(e),h={},h.fieldHistory=e,h.next=s,h.appendAria=a,h.preventDefault=v,h};var s=function(n){var t=$(n.target);"deleteContentBackward"===n.originalEvent.inputType&&t[0].selectionStart===t[0].selectionEnd&&t[0].selectionStart===n.target.value.length?t.attr("data-runDeleter","true"):t.attr("data-runDeleter","false")},h=function(n){var t=$(n.target),u=JSON.parse(t.attr("data-fieldHistory")),f="true"===t.attr("data-runDeleter"),r=!!JSON.parse(t.attr("data-validation-settings")).isDOB,i=$$WP.I18N.liveDate(n.originalEvent.inputType,n.target.value,t[0].selectionStart,t[0].selectionEnd,r,u,f);void 0!==i.next&&t.val(i.next);i.appendAria?$$WP.I18N.__appendFormatterAriaAnnouncement(t,void 0,void 0,r):$$WP.I18N.__clearFormatterAriaAnnouncement(t);i.preventDefault&&n.preventDefault();t.attr("data-fieldHistory",JSON.stringify(i.fieldHistory))},c=function(n){var i=$(n.target),t=JSON.parse(i.attr("data-fieldHistory"));n.target.value!==$$WP.I18N.__peekFieldHistory(t)&&(t=$$WP.I18N.__pushFieldHistory(t,n.target.value));i.attr("data-fieldHistory",JSON.stringify(t))};$$WP.I18N.attachLiveDateFormatter=function(n){var t,i;"1"!==n.attr("data-formatter-attached")&&("rtl"===$("html").attr("dir")&&(n.attr("dir","ltr"),n.css("text-align","right")),$$WP.I18N.__appendFormatterAriaAnnouncement(n,!0),t=JSON.parse(n.attr("data-validation-settings")),t.format=!0,n.attr("data-validation-settings",JSON.stringify(t)),n.attr("inputmode","numeric"),i=$$WP.I18N.processLiveDateFormatter(n.val(),n.val().length,t.isDOB),n.val(i),n.attr("data-fieldHistory",JSON.stringify($$WP.I18N.__createFieldHistory(i))),n.attr("data-formatter-attached","1"),n.on("beforeinput",s),n.on("input",h),n.on("blur",c))}}(),function(){var n=function(){return this.prototype={Value:null,isValid:function(){return null}},function(n,t){this.Value=n;this.isValid=t}}(),t={DateObject:null,DayOfMonth:new n,Month:new n,Year:new n,isSpilledOver:function(){return null!==this.DateObject&&(this.DateObject.getUTCDate()!==this.DayOfMonth.Value||this.DateObject.getUTCMonth()!==this.Month.Value-1||this.DateObject.getUTCFullYear()!==this.Year.Value)},isValid:function(){return this.Month.isValid()&&this.DayOfMonth.isValid()&&this.Year.isValid()}},i=function(n,t){var e,o,s,h,i,u,f;return o=(e=$$WP.I18N.DateFormat.toLowerCase().replace(/[^ymd]*([ymd])+[^ymd]*/g,"$1")).indexOf("d"),s=e.indexOf("m"),h=e.indexOf("y"),r(n)?(2===n.length?(f=(new Date).getFullYear(),u=Number(n[s]),i=Number(n[o])):3===n.length&&(f=$$WP.I18N.parseYear(n[h],t),u=Number(n[s]),i=Number(n[o])),null===i||isNaN(i)||null===u||isNaN(u)||null===f||isNaN(f)?null:{DayOfMonth:i,Month:u,Year:f}):null},r=function(n){if(2!==n.length&&3!==n.length)return!1;for(var t=0;t<n.length;t++)if(0===n[t].length)return!1;return!0},u=function(n){return n>0&&n<13},f=function(n,t,i){return!(n<1)&&n<=$$WP.I18N.numDaysInMonth(t,i)};$$WP.I18N.Date=function(t,r,e,o){var s,a,l,h,c;if(e=void 0!==e&&e,o=void 0!==o&&o,"date"===r)s=t.trim().split("-"),l=Number(s[2]),h=Number(s[1]),c=Number(s[0]);else{if("string"!=typeof t||/[a-zA-Z]/.test(t))return;if(o&&/^[0-9]+$/.test(t)&&(t=$$WP.I18N.processLiveDateFormatter(t,t.length,e)),s=t.trim().split(/[^\d]+/),null===(a=i(s,e)))return;l=a.DayOfMonth;h=a.Month;c=a.Year}this.DayOfMonth=new n(l,function(){return f(l,h,c)});this.Month=new n(h,function(){return u(h)});this.Year=new n(c,function(){return $$WP.I18N.__validateYear(c)});this.DateObject=new Date(0);this.DateObject.setUTCFullYear(c);this.DateObject.setUTCMonth(h-1);this.DateObject.setUTCDate(l)};$$WP.I18N.Date.prototype=t}();$$WP.Debug.UnitTest=$$WP.Debug.UnitTest||{};$$WP.Debug.UnitTest.tests=$$WP.Debug.UnitTest.tests||[];$$WP.Debug.UnitTest.tests.push(function(){var n,t,i,r,u,f;n=$$WP.Debug.UnitTest.assert;r=$$WP.I18N.DecimalSeparator;u=$$WP.I18N.NegativePattern;f=$$WP.I18N.GroupSeparator;$$WP.I18N.DecimalSeparator=",";$$WP.I18N.GroupSeparator=".";$$WP.I18N.NegativePattern="(n)";t=$$WP.I18N.parseNumber;i=$$WP.I18N.formatNumber;n(1234===t("1234"),"Failed to parse number string: '1234'");n(1234===t(" 1234"),"Failed to parse number string: ' 1234'");n(1===t("1,0"),"Failed to parse number string: '1,0'");n(1.234===t("1,234"),"Failed to parse number string: '1,234'");n(1234.234===t("1234,234"),"Failed to parse number string: '1234,234'");n(1234.234===t(" 1234,234"),"Failed to parse number string: ' 1234,234'");n(1234===t("1.234"),"Failed to parse number string: '1.234'");n(1234567===t("1.234.567"),"Failed to parse number string: '1.234.567'");n(-1===t("(1)"),"Failed to parse number string: '(1)'");n(-1234===t("(1234)"),"Failed to parse number string: '(1234)'");n(-1===t("(1,0)"),"Failed to parse number string: '(1,0)'");n(-1.234===t("(1,234)"),"Failed to parse number string: '(1,234)'");n(-1234.234===t("(1234,234)"),"Failed to parse number string: '(1234,234)'");n(-1234567===t("(1.234.567)"),"Failed to parse number string: '(1.234.567)'");n(isNaN(t("abc")),"Did not reject invalid number string: 'abc'");n(isNaN(t("((123")),"Did not reject invalid number string: '((123'");n(isNaN(t("(123,,0")),"Did not reject invalid number string: '(123,,0'");n(isNaN(t("(123,0,0")),"Did not reject invalid number string: '(123,0,0'");n(isNaN(t("(123(")),"Did not reject invalid number string: '(123('");n(isNaN(t("(123,0(")),"Did not reject invalid number string: '(123,0('");n(isNaN(t("(1@123,0)")),"Did not reject invalid number string: '(1.123,0)'");n(isNaN(t("(1@234)")),"Did not reject invalid number string: '(1.234)'");n(isNaN(t("(1@234,234)")),"Did not reject invalid number string: '(1.234,234)'");$$WP.I18N.GroupSeparator=" ";n(1234===t("1 234"),"Failed to parse number string: '(1 234)'");$$WP.I18N.GroupSeparator="";n(1234===t("1 234"),"Failed to parse number string: '(1 234)'");$$WP.I18N.GroupSeparator=".";n("123"===i(123),"Did not properly format 123 as '123'");n("123"===i(123.4),"Did not properly format 123.4 as '123'");n("123,4"===i(123.4,1),"Did not properly format 123.4 as '123.4'");n("124"===i(123.5),"Did not properly format 123.5 as '124'");n("123,5"===i(123.5,3),"Did not properly format 123.5 as '123.5'");n("(123)"===i(-123),"Did not properly format -123 as '(123)'");n("(123)"===i(-123.4),"Did not properly format -123.4 as '(123)'");n("(123,4)"===i(-123.4,1),"Did not properly format -123.4 as '(123,4)'");n("(124)"===i(-123.5),"Did not properly format -123.5 as '(124)'");n("(123,5)"===i(-123.5,3),"Did not properly format -123.5 as '(123,5)'");n("11,000"===i(10.99999,3),"Did not properly format 10.99999 as '11,000'");$$WP.I18N.DecimalSeparator=r;$$WP.I18N.NegativePattern=u;$$WP.I18N.GroupSeparator=f});$$WP.Debug.UnitTest.tests.push(function(){var l,n,r,h,y,t,f,u,i,a,v;l=$$WP.Debug.UnitTest.assert;n=$$WP.Debug.UnitTest.assertValue;y=$$WP.I18N.DateFormat;r=$$WP.I18N.parseDate;h=$$WP.I18N.formatPatientGivenDate;t=$$WP.I18N.processLiveDateFormatter;f=$$WP.I18N.deleteLiveDateFormatter;$$WP.I18N.liveDate;var c=$$WP.I18N.__createFieldHistory,s=$$WP.I18N.__pushFieldHistory,p=$$WP.I18N.__undoFieldHistory,w=$$WP.I18N.__redoFieldHistory,e=$$WP.I18N.liveDate("deleteContentBackward","",0,0,!1,c(),!0),o={fieldHistory:c(),next:"",appendAria:!1,preventDefault:!1};for(n(JSON.stringify(e),JSON.stringify(o),"delete at init"),u=c(),u=s(u,"10/"),e=$$WP.I18N.liveDate("deleteContentBackward","1",1,1,!1,u,!0),o={fieldHistory:u=s(u,"1"),next:"1",appendAria:!0,preventDefault:!1},n(JSON.stringify(e),JSON.stringify(o),"runDeleter"),u=s(u=c(),"10/"),e=$$WP.I18N.liveDate("delete","1/",1,1,!1,u,!1),o={fieldHistory:u=s(u,"1/"),next:"1/",appendAria:!1,preventDefault:!1},n(JSON.stringify(e),JSON.stringify(o),"delete"),u=c(),e=$$WP.I18N.liveDate("insert","1",1,1,!1,u,!1),o={fieldHistory:s(u,"1"),next:"1",appendAria:!1,preventDefault:!1},n(JSON.stringify(e),JSON.stringify(o),"type 1"),u=s(u=c(),"1"),e=$$WP.I18N.liveDate("insert","10",2,2,!1,u,!1),o={fieldHistory:u=s(u,"10/"),next:"10/",appendAria:!0,preventDefault:!1},n(JSON.stringify(e),JSON.stringify(o),"type 10"),e=$$WP.I18N.liveDate("historyUndo","10/",3,3,!1,u,!1),o={fieldHistory:u=p(u),next:"1",appendAria:!1,preventDefault:!0},n(JSON.stringify(e),JSON.stringify(o),"undo"),e=$$WP.I18N.liveDate("historyRedo","1",1,1,!1,u,!1),o={fieldHistory:u=w(u),next:"10/",appendAria:!1,preventDefault:!0},n(JSON.stringify(e),JSON.stringify(o),"redo"),n(JSON.stringify({history:[""],pointer:1}),JSON.stringify($$WP.I18N.__createFieldHistory()),"create - no init param"),n(JSON.stringify({history:["4"],pointer:1}),JSON.stringify($$WP.I18N.__createFieldHistory("4")),"create - init param"),n(JSON.stringify({history:["4"],pointer:1}),JSON.stringify($$WP.I18N.__createFieldHistory(4)),"create - number init param"),i=$$WP.I18N.__createFieldHistory(),n("",$$WP.I18N.__peekFieldHistory(i),"peek - uninitialized history"),i=$$WP.I18N.__createFieldHistory("4"),n("4",$$WP.I18N.__peekFieldHistory(i),"peek - return from init state"),i=$$WP.I18N.__pushFieldHistory(i,"5"),n("5",$$WP.I18N.__peekFieldHistory(i),"peek - after push"),i=$$WP.I18N.__undoFieldHistory(i),n("4",$$WP.I18N.__peekFieldHistory(i),"peek - after undo"),a=i=$$WP.I18N.__createFieldHistory(),l(a!==(i=$$WP.I18N.__pushFieldHistory(i,"1")),"Reference to object not updated."),n(JSON.stringify({history:["","1"],pointer:2}),JSON.stringify(i),"push - add to non-init fieldHistory"),i=$$WP.I18N.__createFieldHistory(1),i=$$WP.I18N.__pushFieldHistory(i,"2"),n(JSON.stringify({history:["1","2"],pointer:2}),JSON.stringify(i),"push - add to fieldHistory"),i=$$WP.I18N.__createFieldHistory(""),v=1;v<42;v++)i=$$WP.I18N.__pushFieldHistory(i,v);n(42,i.history.length,"resize - setup");l((a=i)!==(i=$$WP.I18N.__resizeFieldHistory(i)),"Reference to object not updated");n(21,i.history.length,"resize - test history length");n(21,i.pointer,"resize - pointer");i=$$WP.I18N.__createFieldHistory("1");l((a=i=$$WP.I18N.__pushFieldHistory(i,"2"))!==(i=$$WP.I18N.__undoFieldHistory(i)),"Reference to object not updated");n(JSON.stringify(i),JSON.stringify({history:["1","2"],pointer:1}));l((a=i)!==(i=$$WP.I18N.__redoFieldHistory(i)),"Reference to object not updated");n(JSON.stringify(i),JSON.stringify({history:["1","2"],pointer:2}));$$WP.I18N.DateFormat="MM/dd/YYYY";n("03/",t("3",1),"Failed to format live date: there are no double digit months starting with 3");n("1",t("1",1),"Failed to format live date: there are double digit months starting with 1");n("01/3",t("13",2),"There is no 13th month");n("02/03/",t("02/3",4),"no Feb 30th");n("02/29/",t("02/29",5),"leap day");n("0",t("0",1),"type zeroes");n("01/",t("01",2),"type zeroes");n("12/01/",t("12/1/",5),"type slashes");n("02/03/1999",t("2/3/1999",8),"paste");n("02/03/1999",t("2.3.1999",8),"paste from another format");n("02/03/99",t("2.3.99",6),"paste from another format");n("03/14/1999",t("03141999",8),"paste from another format - this would work in hyperspace");n("03/14/99",t("031499",6),"paste from format that would work in hyperspace");n("03/04/8",t("03/04/8",7),"random bug");n("12/29/94",t("122994",6),"would work in hyperspace");n("01/04/",t("014",3),"deletion");n("01/31/",t("01/31",5),"January 31 valid");n("02/29/",t("02/29",5),"February 29 valid");n("03/31/",t("03/31",5),"March 31 valid");n("04/30/",t("04/30",5),"April 30 valid");n("05/31/",t("05/31",5),"May 31 valid");n("06/30/",t("06/30",5),"June 30 valid");n("07/31/",t("07/31",5),"July 31 valid");n("08/31/",t("08/31",5),"August 31 valid");n("09/30/",t("09/30",5),"September 30 valid");n("10/31/",t("10/31",5),"October 31 valid");n("11/30/",t("11/30",5),"November 30 valid");n("12/31/",t("12/31",5),"December 31 valid");n("01/03/2",t("01/32",5),"January 32 invalid");n("02/03/0",t("02/30",5),"February 30 invalid");n("03/03/2",t("03/32",5),"March 32 invalid");n("04/03/1",t("04/31",5),"April 31 invalid");n("05/03/2",t("05/32",5),"May 32 invalid");n("06/03/1",t("06/31",5),"June 31 invalid");n("07/03/2",t("07/32",5),"July 32 invalid");n("08/03/2",t("08/32",5),"August 32 invalid");n("09/03/1",t("09/31",5),"September 31 invalid");n("10/03/2",t("10/32",5),"October 32 invalid");n("11/03/1",t("11/31",5),"November 31 invalid");n("12/03/2",t("12/32",5),"December 32 invalid");n("05/",t("p5",2),"Forms validation attached late");n("",t("p/",2),"Forms validation attached late");n("05/",t("/5",2),"Forms validation attached late");n("",t("//",2),"Forms validation attached late");n("03/",t("03;",3),"Non-number where a spacer should be");n("03/14/",t("03/14;",6),"Non-number where a spacer should be");n("03/14/1999",t("Here is a random date: 3/14/1999",32),"Random sentence pasted in");n("03/14/1999",t("3/14/1999: That was a random date",33),"Random sentence pasted in");n("03/14/1999",t("Crazy day: 3/14/1999: That was a random date",44),"Random sentence pasted in");n("03/14/",t("Here is a random date: 3/14",27),"Random sentence pasted in");n("03/14/",t("3/14: That was a random date",28),"Random sentence pasted in");n("03/14/",t("Crazy day: 3/14: That was a random date",39),"Random sentence pasted in");n("03/",t("Here is a random date: 3",24),"Random sentence pasted in");n("03/",t("3: That was a random date",25),"Random sentence pasted in");n("03/",t("Crazy day: 3: That was a random date",36),"Random sentence pasted in");n("03/14/1999",t("03\\14\\1999",10),"Accept backslash");n("01/01/11",t("1\\1\\11",6),"Accept backslash");n("01/02/2003",t("01/02/20030",11),"Overflow");n("08/08/90",t("8890",4),"accept 4 digit dates");n("12/08/90",t("12890",5),"accept 5 digit dates");n("12/11/90",t("121190",6),"accept 6 digit dates");n("03/14/1990",t("3141990",7),"accept 7 digit dates");n("12/04/1990",t("1241990",7),"accept 7 digit dates");n("12/11/1999",t("12111999",8),"accept 8 digit dates");n("12/03/4",t("1234",4),"Copy/paste");n("01/03/45",t("1345",4),"Copy/paste");n("08/08/1999",t("881999",6),"6-digit uneasy formatting");n("08/08/888",t("08/08/888",9),"Don't add zeroes on typos");n("02/22/222",t("02/22/222",9),"Don't add zeroes on typos");n("09/09/999",t("09/09/999",9),"Don't add zeroes on typos");n("01/01/204",t("01/01/204",9),"Don't add zeroes on typos");n("01/01/2040",t("01/01/2040",10),"Don't add zeroes on typos");n("01/03/923",t("01/03/923",9),"Don't add zeroes on typos");n("01/01/998",t("01/01/998",9),"Don't add zeroes on typos");$$WP.I18N.DateFormat="YYYY/MM/DD";n("2001/",t("01/",3),"doesn't allow 2-digit years");n("2001/",t("2001",4),"basic 4-digit year");n("0003/03/3",t("3/3/3",5),"allows 1-digit year");n("0103/03/3",t("103/3/3",7),"allows 3-digit year");n("22",t("22",2),"2 chars entered");n("2002/",t("2002 ",5),"space entered");n("2002/",t("2002",4),"nothing entered");n("2022/01/3",t("2022/13",7),"regular month checking");n("2022/0",t("220",3),"6-digit leadup");n("2022/02/25",t("220225",6),"6-digit");n("2022/03/1",t("2022031",7),"7-digit");n("2022/03/3",t("2022033",7),"7-digit");n("2022/03/4",t("2022034",7),"7-digit");n("2022/03/01",t("20220301",8),"8-digit");n("2002/09/30",t("2002 09 30",10),"space separator");n("2001/08/12",t("2001/08/12",10),"slash separator");n("2001/08/12",t("2001.08.12",10),"period separator");n("2001/08/12",t("2001,08,12",10),"comma separator");n("2001/08/12",t("2001-08-12",10),"dash separator");n("2001/08/12",t("2001\\08\\12",10),"backslash separator");n("2001/02/03",t("2001/02/033",11),"Overflow");n("1999/08/8",t("1999/08/8",9),"6digit test");n("1999/08/8",t("199988",6),"6-digit uneasy formatting");n("03/14/199",f("03/14/1999"),"Simple deletion");n("03/14/19",f("03/14/199"),"Simple deletion");n("10",f("10/02/"),"Clear digit");n("",f("02/"),"Remove leading zero");n("11/11/100",f("11/11/1000"),"Delete zero");n("11/11/10",f("11/11/100"),"Delete zero");n("11/11/1",f("11/11/10"),"Delete zero");n("09/09/999",f("09/09/9999"),"6 9's");n("09/09/99",f("09/09/999"),"6 9's");n("09/09/9",f("09/09/99"),"6 9's");n("09/09",f("09/09/9"),"6 9's");n("09",f("09"),"6 9's");$$WP.I18N.DateFormat="MM/dd/YYYY";n("09/10/2016",h(new Date("2016-09-10")),"Failed to format date ");n("02/01/0123",h(new Date("0123-02-01")),"Failed to format date ");$$WP.I18N.DateFormat="M/d/YY";n("9/10/16",h(new Date("2016-09-10")),"Failed to format date ");n("2/1/23",h(new Date("0123-02-01")),"Failed to format date ");n("10/11/16",h(new Date("2016-10-11")),"Failed to format date ");$$WP.I18N.DateFormat="MM/dd/yyyy";n(new Date("2016-10-09").getTime(),r("10/9/2016").getTime(),"Date parsed incorrectly.");n(new Date("2016-10-09").getTime(),r(" 10 / 9 - 2016 ").getTime(),"Date parsed incorrectly.");n(new Date("2016-10-09").getTime(),r("10-9-16").getTime(),"Date parsed incorrectly.");n(new Date("1975-10-09").getTime(),r("10-9-75").getTime(),"Date parsed incorrectly.");n(new Date("2016-02-29").getTime(),r("2-29-16").getTime(),"Date parsed incorrectly.");n(new Date("2016-12-31").getTime(),r("12-31-16").getTime(),"Date parsed incorrectly.");n(new Date("2016-01-01").getTime(),r("1-1-16").getTime(),"Date parsed incorrectly.");n(new Date((new Date).getFullYear()+"-01-01").getTime(),r("1-1").getTime(),"Date parsed incorrectly.");$$WP.I18N.DateFormat="M/d/y";n(new Date("2016-10-09").getTime(),r("10/9/2016").getTime(),"Date parsed incorrectly.");n(new Date("2016-10-09").getTime(),r(" 10 / 9 - 2016 ").getTime(),"Date parsed incorrectly.");n(new Date("2016-10-09").getTime(),r("10-9-16").getTime(),"Date parsed incorrectly.");n(new Date("1975-10-09").getTime(),r("10-9-75").getTime(),"Date parsed incorrectly.");$$WP.I18N.DateFormat="dd-MM-yyyy";n(new Date("2016-09-10").getTime(),r("10/9/2016").getTime(),"Date parsed incorrectly.");n(new Date("2016-09-10").getTime(),r(" 10 / 9 - 2016 ").getTime(),"Date parsed incorrectly.");n(new Date("2016-09-10").getTime(),r("10-9-16").getTime(),"Date parsed incorrectly.");n(new Date("1975-09-10").getTime(),r("10-9-75").getTime(),"Date parsed incorrectly.");$$WP.I18N.DateFormat="dd yyyy mm";n(new Date("2016-09-10").getTime(),r("10/2016/9").getTime(),"Date parsed incorrectly.");n(new Date("2016-09-10").getTime(),r(" 10 / 2016 - 9 ").getTime(),"Date parsed incorrectly.");n(new Date("2016-09-10").getTime(),r("10-16-9").getTime(),"Date parsed incorrectly.");n(new Date("1975-09-10").getTime(),r("10-75-9").getTime(),"Date parsed incorrectly.");$$WP.I18N.DateFormat="MM/dd/yyyy";n(null,r("January 1, 2016"),"Invalid date string was not rejected.");n(null,r("10/9/16 AD"),"Invalid date string was not rejected.");n(null,r("2/29/15"),"Invalid date string was not rejected.");n(null,r("0/1/2016"),"Invalid date string was not rejected.");n(null,r("1/1/"),"Invalid date string was not rejected.");n(null,r("/1/1"),"Invalid date string was not rejected.");n(null,r("/1/1/"),"Invalid date string was not rejected.");n(null,r("//1//1//"),"Invalid date string was not rejected.");$$WP.I18N.DateFormat=y});$$WP.Debug.UnitTest.tests.push(function(){var n,f,r,u,t,i;n=$$WP.Debug.UnitTest.assertValue;f=$$WP.I18N.Identifier;$$WP.I18N.Identifier="en-US";t=$$WP.I18N.formatList;r={style:"long",type:"disjunction"};u={style:"narrow"};i=["one","two","three","four"];WP&&WP.DOM&&WP.DOM.Browser.isIE?(n("one, two, three, four",t(i),"failed to format list for IE"),n("one, two, three, four",t(i,r),"failed to format list for IE"),n("one, two, three, four",t(i,u),"failed to format list for IE")):(n("one, two, three, and four",t(i),"failed to format list"),n("one, two, three, or four",t(i,r),"failed to format list"),n("one, two, three, four",t(i,u),"failed to format list"));$$WP.I18N.Identifier=f});EpicPx=EpicPx||{};EpicPx.pendingPortals=EpicPx.pendingPortals||{};EpicPx.scriptSources=EpicPx.scriptSources||[];EpicPx.addReactPortal=function(){var n=!1;return function(t,i,r,u){u?EpicPx.addPortal?EpicPx.addPortal(t,i,r,u):n?setTimeout(function(){EpicPx.addReactPortal(t,i,r,u)},10):(EpicPx.pendingPortals[u]={elementId:u,packageName:t,componentName:i,props:r},function(){var r,t,i;if(!n){for(n=!0,r=document.createDocumentFragment(),t=0;t<EpicPx.scriptSources.length;t++)i=document.createElement("script"),i.src=makeLink(EpicPx.scriptSources[t]),i.async=!1,r.appendChild(i);document.head.appendChild(r)}}()):$$WP.Debug.log("No element ID passed in to render "+t+"/"+i)}}();EpicPx.removeReactPortal=function(n){if(n)return EpicPx.removePortal?EpicPx.removePortal(n):void(EpicPx.pendingPortals[n]&&delete EpicPx.pendingPortals[n])};$$WPUtil.guaranteeExistence($$WP,"Handlebars");$$WPUtil.guaranteeExistence($$WP,"Templates");$$WP.Handlebars._addHelpersHasBeenCalled=!1;$$WP.Handlebars.addHelpers=function(){if(!$$WP.Handlebars._addHelpersHasBeenCalled){$$WP.Handlebars._addHelpersHasBeenCalled=!0;$$WP.Utilities&&($$WP.Handlebars.addComponent=function(n){var t="componentcontainer_"+$$WPUtil.generateGUID(),i=function(){var r=document.getElementById(t);$$WP.Utilities.addComponent._Counter[t]++;r?(delete $$WPUtil.Handlebars.addComponent._Counter[t],$afe.jq(r).safeAppend(n.$container)):$$WP.Utilities.addComponent._Counter[t]<10&&window.setTimeout(i,1)};return $$WP.Utilities.addComponent._Counter[t]=0,window.setTimeout(i,1),'<div id="'+t+'"><\/div>'},$$WP.Handlebars.addComponent._Counter={},Handlebars.registerHelper("addComponent",$$WP.Handlebars.addComponent),Handlebars.registerHelper("ifNotNullOrEmpty",function(n,t){return $$WPUtil.IsNullOrEmpty(n)?t.inverse(this):t.fn(this)}),registerUIUtilitiesHelpers());registerStringsHelpers();try{makeLink&&(Handlebars.registerHelper("makeLink",makeLink),Handlebars.registerHelper("makeStaticLink",makeStaticLink),Handlebars.registerHelper("makeStaticImageLink",makeStaticImageLink),Handlebars.registerHelper("showFile",function(n){return makeLink("showfile.asp?key="+n)}))}catch(t){}try{isDataTile&&(Handlebars.registerHelper("ifDataTiles",function(n){return isDataTile()?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifNotDataTiles",function(n){return isDataTile()?n.inverse(this):n.fn(this)}))}catch(t){}$$WP.CommunityUtilities&&Handlebars.registerHelper("canShowExternalLoadingIndicator",function(n){return $$WP.CommunityUtilities.hasCommunityLinks()?n.fn(this):n.inverse(this)});$$WP.FormValidation&&(Handlebars.registerHelper("validationSettingsAttribute",$$WP.FormValidation.Handlebars.validationSettingsAttribute),Handlebars.registerHelper("messageDisplay",$$WP.FormValidation.Handlebars.messageDisplay),Handlebars.registerHelper("messageDisplayForAttribute",$$WP.FormValidation.Handlebars.messageDisplayForAttribute),Handlebars.registerHelper("disableIfInvalidAttribute",$$WP.FormValidation.Handlebars.disableIfInvalidAttribute),Handlebars.registerHelper("validationGroupAttribute",$$WP.FormValidation.Handlebars.validationGroupAttribute),Handlebars.registerHelper("validationRequiredAttribute",$$WP.FormValidation.Handlebars.validationRequiredAttribute),Handlebars.registerHelper("showRequiredInstructions",$$WP.FormValidation.Handlebars.showRequiredInstructions));$$WP.Currency&&Handlebars.registerHelper("numberAsCurrency",function(n,t){var i;return i="function"==typeof n?n():n,$$WP.Currency.Helpers.numberToCurrency(i,t)});registerI18NHelpers();$$WP.UI&&($$WP.UI.Command&&Handlebars.registerHelper("command",function(n,t,i,r,u){var f=new $$WP.UI.CommandOptions("string"==typeof r?JSON.parse(r):r),e;return f.MiscContent=(f.MiscContent||"")+(u&&u.fn?new Handlebars.SafeString(u.fn(this)):""),e=new $$WP.UI.Command({Priority:n,Tone:t,Caption:i,CmdOptions:f}),Handlebars.helpers.addTemplate("UI.Command",e)}),$$WP.UI.Dropdown&&Handlebars.registerHelper("dropdown",function(n,t,i,r,u,f,e){var o=$$WP.UI.DropdownOption.convertRawDropdownOptions(u,f,e);return Handlebars.helpers.addTemplate("UI.Dropdown",new $$WP.UI.Dropdown({IdName:n,Label:t,PlaceholderText:i,ValidationSettings:r,Options:o}))}),$$WP.UI.Dropdown&&Handlebars.registerHelper("dropdown",function(n,t,i,r,u,f,e){var o=$$WP.UI.DropdownOption.convertRawDropdownOptions(u,f,e);return Handlebars.helpers.addTemplate("UI.Dropdown",new $$WP.UI.Dropdown({IdName:n,Label:t,PlaceholderText:i,ValidationSettings:r,Options:o}))}),registerInfoBubbleHelpers());registerBannerHelpers();Handlebars.registerHelper("ajaxSpinner",function(n,t,i){if(78!=$$WP.ApplicationContext)return Handlebars.helpers.addTemplate("UI.AjaxSpinner",{inline:n,loadingMessage:t,role:i?"status":"alert"})});$$WP.Svg&&Handlebars.registerHelper("referenceSvg",function(n){if(null===n||""===n)return null;var i,t=document.createElement("use");return i=0===n.indexOf("~/")?makeLink(n.substring(2)):0===n.indexOf("http")?n:makeStaticImageLink(n),t.setAttribute("xlink:href",i),WP.DOM.Browser.isIE?($$WP.Svg.Helpers.loadSingleSvgIcon(t),new Handlebars.SafeString(t.innerHTML)):new Handlebars.SafeString(t.outerHTML)});Handlebars.registerHelper("URLEncode",encodeURI);Handlebars.registerHelper("encodeURIComponent",encodeURIComponent);Handlebars.registerHelper("ifEquals",function(n,t,i){return n!==t?i.inverse(this):i.fn(this)});Handlebars.registerHelper("ifNotEquals",function(n,t,i){return n===t?i.inverse(this):i.fn(this)});Handlebars.registerHelper("addTemplate",function(n,t,i,r){for(var e=n.split("."),o=e.length,f=$$WP.Templates,u=0;u<o;u++)f=f[e[u]];if("function"!=typeof f)throw"addTemplate could not find $$WP.Templates."+n;return i&&r&&(t.AdditionalData=i),new Handlebars.SafeString(f(t,{allowProtoPropertiesByDefault:!0,allowProtoMethodsByDefault:!0}))});Handlebars.registerHelper("ifLt",function(n,t,i){return n<t?i.fn(this):i.inverse(this)});Handlebars.registerHelper("ifGt",function(n,t,i){return n>t?i.fn(this):i.inverse(this)});Handlebars.registerHelper("isLastInArray",function(n,t,i){return n+1===t?i.fn(this):i.inverse(this)});Handlebars.registerHelper("isMiddleInArray",function(n,t,i){return n+1===Math.ceil(t/2)?i.fn(this):i.inverse(this)});Handlebars.registerHelper("each-reverse",function(n,t){var i,r="";if(n&&n.length>0)for(i=n.length-1;i>=0;i--)t.data.index=i,r+=t.fn(n[i]);else r=t.inverse(this);return r});Handlebars.registerHelper("raw",function(n){return new Handlebars.SafeString(n)});Handlebars.registerHelper("ifEven",function(n,t){return n%2==0?t.fn(this):t.inverse(this)});Handlebars.registerHelper("ifAny",function(){for(var t=arguments.length-1,n=0;n<t;n++)if(arguments[n])return arguments[t].fn(this);return arguments[t].inverse(this)});Handlebars.registerHelper("ifAll",function(){for(var t=arguments.length-1,n=0;n<t;n++)if(!arguments[n])return arguments[t].inverse(this);return arguments[t].fn(this)});Handlebars.registerHelper("ifNone",function(){for(var t=arguments.length-1,n=0;n<t;n++)if(arguments[n])return arguments[t].inverse(this);return arguments[t].fn(this)});Handlebars.registerHelper("addition",function(n,t){return(n=Number(n)||0)+(t=Number(t)||0)});Handlebars.registerHelper("concat",function(n,t){return(n=String(n)||"")+(t=String(t)||"")});Handlebars.registerHelper("join",function(n,t){return n&&n.join?n.join(t):null});Handlebars.registerHelper("ifIn",function(n,t,i){return"[object Array]"===Object.prototype.toString.call(t)&&t.indexOf(n)>-1?i.fn(this):i.inverse(this)});Handlebars.registerHelper("breakLines",function(n){return n=(n=Handlebars.Utils.escapeExpression(n)).replace(/(\r\n|\n|\r)/gm,"<br>"),new Handlebars.SafeString(n)});Handlebars.registerHelper("repeat",function(n,t){for(var r="",u={},i=1;i<=n;i++)u.index=i,r+=t.fn(this,{data:u});return r});Handlebars.registerHelper("ifArray",function(n,t){return Array.isArray(n)?t.fn(this):t.inverse(this)});Handlebars.registerHelper("highlightString",function(n,t){var u,f,i,r=document.createElement("span");if(t.length>0)for(r.appendChild(document.createTextNode(n.substring(0,t[0].start))),i=0;i<t.length;i++)(u=document.createElement("mark")).innerText=n.substring(t[i].start,t[i].end),r.appendChild(u),f=i<t.length-1?t[i+1].start:n.length,r.appendChild(document.createTextNode(n.substring(t[i].end,f)));return new Handlebars.SafeString(r.innerHTML)});Handlebars.registerHelper("assistiveTextWrapper",function(n,t){return Handlebars.helpers.addTemplate("UI.AssistiveTextWrapper",{AssistiveLabel:n,VisibleContent:t.fn(this)})});Handlebars.registerHelper("replaceSpaces",function(n){return n.split(" ").join("-")})}};!function(){var r={},t=function(t,r,f,o){this.id=e++;this._template=t;this._priority=f;this._shown=o;this._addToStaticStructures();this._$container=$$WP.SimpleTemplates.Div({"class":"jqHidden"});u=u||$afe.select("#sidebar");1===i?u.safeAppend(this._$container):this===n?this._$container.safeInsertBefore(this._next._$container):this._$container.safeInsertAfter(this._previous._$container);this.update(r);this._shown&&this._$container.show()},f={ViewModel:null,_template:null,_priority:null,_$container:null,_previous:null,_next:null,_shown:!0,update:function(n){this._$container.empty();this._$container.safeAppend($afe.renderTemplate(this._template,n));this.ViewModel=n},show:function(){this._shown||(this._$container.show(),this._shown=!0)},hide:function(){this._shown&&(this._$container.hide(),this._shown=!1)},remove:function(){this._$container.remove();this===n?n=this._next:(this._previous._next=this._next,null!==this._next&&(this._next._previous=this._previous));i--},_addToStaticStructures:function(){var t,r;if(null===n)n=this;else if(this._priority<n._priority)this._next=n,n._previous=this,n=this;else{for(r=n,t=n;null!==t&&this._priority>=t._priority;)r=t,t=t._next;this._next=r._next;this._previous=r;r._next=this;null!==this._next&&(this._next._previous=this)}i++}},u=null,e=0,n=null,i=0;t.prototype=f;r.addWidget=function(n,i,r,u){return new t(n,i,r,!u)};r.numberOfWidgets=function(){return i};t.extend($$WP.BaseObject,"WP$Utilities$UI$SidebarWidget");$$WP.Utilities.UI.SidebarWidget=t;$$WP.Utilities.UI.SidebarManager=r}();$$WP.Debug.UnitTest=$$WP.Debug.UnitTest||{};$$WP.Debug.UnitTest.tests=$$WP.Debug.UnitTest.tests||[];$$WP.Debug.UnitTest.tests.push(function(){var i,n,u,e,o,t,a,h,w,b,k,r,s,f,c,l,v,y,p;i=$$WP.Debug.UnitTest.assert;n=$$WP.Debug.UnitTest.assertValue;u=$$WP.Utilities.UI.SidebarManager;SidebarWidget=$$WP.Utilities.UI.SidebarWidget;a=function(n){return'<div data-name="'+n.name+'" data-content="'+n.content+'"> Widget '+n.name+" priority: "+n.priority+" content: "+n.content+"<\/div>"};l={name:"Widget1",priority:10,content:"A"};v={name:"Widget2",priority:5,content:"C"};y={name:"Widget3",priority:5,content:"D"};p={name:"Widget4",priority:-1,content:"E"};0!=(t=$afe.select("#sidebar")).length?(o=t.children().length,e=u.numberOfWidgets(),h=u.addWidget(a,l,l.priority),r=t.find('div[data-name="Widget1"]'),i(SidebarWidget.isInstance(h),"addWidget() did not return a valid SidebarWidget instance for Widget1"),n(e+1,u.numberOfWidgets(),"The result of numberOfWidgets() did not increment after adding Widget1"),n(o+1,t.children().length,"addWidget() did not cause the number of elements directly contained by the sidebar to increase by 1"),n(1,r.length,"Did not find the rendered version of Widget1 in the sidebar after adding it using addWidget()"),n("A",r.safeAttr("data-content"),"The rendered version of Widget1 did not contain the expected value in the data-content attribute"),i(r.is(":visible"),"Widget1 was not rendered shown by default"),h.hide(),i(!r.is(":visible"),"Widget1 was not hidden by the call to hide()"),h.show(),i(r.is(":visible"),"Widget1 was not shown by the call to show()"),h.hide(),l.content="B",h.update(l),r=t.find('div[data-name="Widget1"]'),n(e+1,u.numberOfWidgets(),"update() changed the widget count"),n(o+1,t.children().length,"update() changed the number of child elements of the sidebar"),n(1,r.length,"Unable to find Widget1 in the sidebar after calling update() "),n(l.content,r.safeAttr("data-content"),"The rendered version of Widget1 did not contain the expected value in the data-content attribute"),i(!r.is(":visible"),"update() made Widget1 visible when it should not have"),h.show(),w=u.addWidget(a,v,v.priority),r=t.find('div[data-name="Widget1"]'),s=t.find('div[data-name="Widget2"]'),i(SidebarWidget.isInstance(w),"addWidget() did not return a valid SidebarWidget instance for Widget2"),n(e+2,u.numberOfWidgets(),"The result of numberOfWidgets() did not increment after adding Widget2"),n(o+2,t.children().length,"addWidget() did not cause the number of elements directly contained by the sidebar to increase by 1"),n(1,s.length,"Did not find the rendered version of Widget2 in the sidebar after adding it using addWidget()"),n(v.content,s.safeAttr("data-content"),"The rendered version of Widget2 did not contain the expected value in the data-content attribute"),n(1,r.length,"Did not find the rendered version of Widget1 in the sidebar after adding Widget2 using addWidget()"),n(l.content,r.safeAttr("data-content"),"The rendered version of Widget1 did not contain the expected value in the data-content attribute after calling addWidget() to add Widget2"),i(s.parent().next().get(0)===r.parent().get(0),"Widget2 was not inserted directly before Widget1 in the DOM"),b=u.addWidget(a,y,y.priority),r=t.find('div[data-name="Widget1"]'),s=t.find('div[data-name="Widget2"]'),f=t.find('div[data-name="Widget3"]'),i(SidebarWidget.isInstance(b),"addWidget() did not return a valid SidebarWidget instance for Widget3"),n(e+3,u.numberOfWidgets(),"The result of numberOfWidgets() did not increment after adding Widget3"),n(o+3,t.children().length,"addWidget() did not cause the number of elements directly contained by the sidebar to increase by 1"),n(1,f.length,"Did not find the rendered version of Widget3 in the sidebar after adding it using addWidget()"),n(y.content,f.safeAttr("data-content"),"The rendered version of Widget3 did not contain the expected value in the data-content attribute"),i(f.parent().next().get(0)===r.parent().get(0),"Widget3 was not inserted directly before Widget1 in the DOM"),i(s.parent().next().get(0)===f.parent().get(0),"Widget3 was not inserted directly after Widget2 in the DOM"),h.remove(),r=t.find('div[data-name="Widget1"]'),n(e+2,u.numberOfWidgets(),"The result of numberOfWidgets() did not decrement after removing Widget1"),n(o+2,t.children().length,"remove() did not cause the number of elements directly contained by the sidebar to decrease by 1"),n(0,r.length,"Widget1 was still found in the sidebar after calling remove()"),i(0===f.parent().next().length,"Widget3 still had something after it in the sidebar"),i(s.parent().next().get(0)===f.parent().get(0),"Widget3 is not directly after Widget2 in the DOM"),w.remove(),s=t.find('div[data-name="Widget2"]'),n(e+1,u.numberOfWidgets(),"The result of numberOfWidgets() did not decrement after removing Widget2"),n(o+1,t.children().length,"remove() did not cause the number of elements directly contained by the sidebar to decrease by 1"),n(0,s.length,"Widget2 was still found in the sidebar after calling remove()"),i(0===f.parent().next().length,"Widget3 was not the last element in the sidebar though it is the last remaining widget"),k=u.addWidget(a,p,p.priority),f=t.find('div[data-name="Widget3"]'),c=t.find('div[data-name="Widget4"]'),i(SidebarWidget.isInstance(k),"addWidget() did not return a valid SidebarWidget instance for Widget4"),n(e+2,u.numberOfWidgets(),"The result of numberOfWidgets() did not increment after adding Widget4"),n(o+2,t.children().length,"addWidget() did not cause the number of elements directly contained by the sidebar to increase by 1"),n(1,c.length,"Did not find the rendered version of Widget4 in the sidebar after adding it using addWidget()"),n(p.content,c.safeAttr("data-content"),"The rendered version of Widget4 did not contain the expected value in the data-content attribute"),i(c.parent().next().get(0)===f.parent().get(0),"Widget4 was not inserted directly before Widget3 in the DOM"),b.remove(),f=t.find('div[data-name="Widget3"]'),n(e+1,u.numberOfWidgets(),"The result of numberOfWidgets() did not decrement after removing Widget3"),n(o+1,t.children().length,"remove() did not cause the number of elements directly contained by the sidebar to decrease by 1"),n(0,f.length,"Widget3 was still found in the sidebar after calling remove()"),i(0===c.parent().next().length,"Widget4 was not the last element in the sidebar though it is the last remaining widget"),k.remove(),c=t.find('div[data-name="Widget4"]'),n(e,u.numberOfWidgets(),"The result of numberOfWidgets() did not decrement after removing Widget4"),n(o,t.children().length,"remove() did not cause the number of elements directly contained by the sidebar to decrease by 1"),n(0,c.length,"Widget4 was still found in the sidebar after calling remove()")):i(!0,"Skip test")})function registerUIUtilitiesHelpers() {
    $$WP.Utilities.UI && (Handlebars.registerHelper("ifMobile", function(n) {
        return $$WP.Utilities.UI.IsMobile ? n.fn(this) : n.inverse(this)
    }),
    Handlebars.registerHelper("ifMobileOrMobileBrowser", function(n) {
        return $$WP.Utilities.UI.IsMobile || ("echeckin" === $$WP.Utilities.queryString("src") || $afe.select("html").hasClass("respquestionnaire")) && WP.DOM.Browser.isMobile ? n.fn(this) : n.inverse(this)
    }),
    Handlebars.registerHelper("ifNotMobileOrMobileBrowser", function(n) {
        return $$WP.Utilities.UI.IsMobile || ("echeckin" === $$WP.Utilities.queryString("src") || $afe.select("html").hasClass("respquestionnaire")) && WP.DOM.Browser.isMobile ? n.inverse(this) : n.fn(this)
    }),
    Handlebars.registerHelper("ifNotMobile", function(n) {
        return $$WP.Utilities.UI.IsMobile ? n.inverse(this) : n.fn(this)
    }),
    Handlebars.registerHelper("ifWelcome", function(n) {
        return 78 === $$WP.ApplicationContext ? n.fn(this) : n.inverse(this)
    }),
    Handlebars.registerHelper("ifWelcomeNotMobile", function(n) {
        return 78 !== $$WP.ApplicationContext || $$WP.Utilities.UI.IsMobile ? n.inverse(this) : n.fn(this)
    }),
    Handlebars.registerHelper("ifWelcomeOrMobile", function(n) {
        return 78 === $$WP.ApplicationContext || $$WP.Utilities.UI.IsMobile || WP.DOM.Browser.isMobile ? n.fn(this) : n.inverse(this)
    }),
    Handlebars.registerHelper("ifNotWelcomeOrMobile", function(n) {
        return 78 === $$WP.ApplicationContext || $$WP.Utilities.UI.IsMobile || WP.DOM.Browser.isMobile ? n.inverse(this) : n.fn(this)
    }),
    Handlebars.registerHelper("ifPreLogin", function(n) {
        return $$WP.Utilities.UI.IsLoggedIn ? n.inverse(this) : n.fn(this)
    }),
    Handlebars.registerHelper("ifiOS", function(n) {
        return WP.DOM.Browser.isIPhone || WP.DOM.Browser.isIPad || WP.DOM.Browser.isIPod || 78 === $$WP.ApplicationContext && $$WP.Utilities.UI.IsIos() ? n.fn(this) : n.inverse(this)
    }),
    Handlebars.registerHelper("proxyColorClass", function() {
        return $$WP.Utilities.UI.ProxyColorClass
    }),
    Handlebars.registerHelper("ifWorkflowRestricted", function(n) {
        return $$WP.Utilities.UI.IsWorkflowRestricted ? n.fn(this) : n.inverse(this)
    }),
    Handlebars.registerHelper("ifCapturedWorkflow", function(n) {
        return $$WP.Utilities.UI.IsCapturedWorkflow ? n.fn(this) : n.inverse(this)
    }),
    Handlebars.registerHelper("ifNotPrelogin", function(n) {
        return $$WP.Utilities.UI.IsMidLogin || $$WP.Utilities.UI.IsLoggedIn ? n.fn(this) : n.inverse(this)
    }),
    Handlebars.registerHelper("ifMidLogin", function(n) {
        return $$WP.Utilities.UI.IsMidLogin ? n.fn(this) : n.inverse(this)
    }),
    Handlebars.registerHelper("ifPreloginOrGuest", function(n) {
        return $$WP.Utilities.UI.IsMidLogin || $$WP.Utilities.UI.IsWorkflowRestricted || !$$WP.Utilities.UI.IsLoggedIn ? n.fn(this) : n.inverse(this)
    }),
    Handlebars.registerHelper("ifFromMyChartCentral", function(n) {
        return $$WP.Utilities.queryString("mccLocation") || sessionStorage.getItem("mccLocation") ? n.fn(this) : n.inverse(this)
    }),
    Handlebars.registerHelper("getContinueToOrgText", function() {
        return $$WP.Settings.OrganizationName ? ($$WP.Strings.addMnemonic("@MYCHART@MYORGNAME@", $$WP.Settings.OrganizationName),
        string = $$WP.Strings.getForTemplate("ContinueToOrg"),
        $$WP.Strings.removeMnemonic("@MYCHART@MYORGNAME@")) : string = $$WP.Strings.getForTemplate("ContinueToHome"),
        string
    }))
}
function registerI18NHelpers() {
    $$WP.I18N && (Handlebars.registerHelper("verticalDateWithYear", function(n, t, i) {
        var r = new Date(i,t - 1,n)
          , u = $$WP.I18N.getOrderedDatePieces(!1);
        return new Handlebars.SafeString($$WP.I18N.Handlebars.verticalDate(r, u))
    }),
    Handlebars.registerHelper("verticalDateWithDayName", function(n, t, i) {
        var u = new Date(i,t - 1,n)
          , r = $$WP.I18N.getOrderedDatePieces(!0);
        return "d" === r[0] ? r.unshift("dow") : r.push("dow"),
        new Handlebars.SafeString($$WP.I18N.Handlebars.verticalDate(u, r))
    }),
    Handlebars.registerHelper("verticalDateWithoutDay", function(n, t, i) {
        var r = new Date(i,t - 1,n)
          , u = $$WP.I18N.getOrderedDatePieces(!1, !1, !0);
        return new Handlebars.SafeString($$WP.I18N.Handlebars.verticalDate(r, u))
    }))
}
function registerStringsHelpers() {
    $$WP.Strings && (Handlebars.registerHelper("setStringNamespace", $$WP.Strings.setDefaultNamespace),
    Handlebars.registerHelper("clearStringNamespace", $$WP.Strings.clearDefaultNamespace),
    Handlebars.registerHelper("getStringResource", $$WP.Strings.getForTemplate),
    Handlebars.registerHelper("getDisplayString", function(n, t, i) {
        if ("string" == typeof i) {
            if (i)
                return $$WP.Strings.getForTemplate(n + "_" + i, t)
        } else if ("number" == typeof i)
            return $$WP.Strings.getForTemplate(n + "_" + i.toString(), t);
        return $$WP.Strings.getForTemplate(n, t)
    }),
    Handlebars.registerHelper("getDisplayStringWithMnemonics", function(n, t) {
        var r, i, u;
        for (i in r = "function" == typeof t ? t() : t)
            $$WP.Strings.addMnemonic("@MYCHART@" + i.toUpperCase() + "@", r[i].Value, r[i].IsLink, r[i].Namespace, r[i].EncodingType);
        for (i in u = $$WP.Strings.getForTemplate(n),
        r)
            $$WP.Strings.removeMnemonic("@MYCHART@" + i.toUpperCase() + "@", r[i].Namespace);
        return u
    }),
    Handlebars.registerHelper("addStringResourceMnemonic", $$WP.Strings.addMnemonic),
    Handlebars.registerHelper("addLinkMnemonic", function(n, t, i, r, u) {
        var f = '<a data-id="redirect" href="' + (i = $$WP.Strings.getNamespace().replaceMnemonics(i)) + '" data-redirect="' + i + '" data-organization="' + r;
        !0 === u && (f += '" target="_blank');
        $$WP.Strings.addMnemonic(n, f + '">' + $$WP.Strings.get(t) + "<\/a>", !1, null, $$WP.Strings.EncodingTypes.None)
    }),
    Handlebars.registerHelper("setOrganization", $$WP.Strings.setOrganization),
    Handlebars.registerHelper("clearOrganization", $$WP.Strings.clearOrganization),
    Handlebars.registerHelper("removeStringResourceMnemonic", $$WP.Strings.removeMnemonic),
    Handlebars.registerHelper("appendNewWindowNotification", function(n, t) {
        return $$WP.Strings.appendNewWindowNotification($$WP.Strings.get(n), t)
    }))
}
function registerInfoBubbleHelpers() {
    $$WP.UI.InfoBubble && (Handlebars.registerHelper("infoBubble", function(n, t, i, r, u) {
        return Handlebars.helpers.addTemplate("UI.InfoBubble", new $$WP.UI.InfoBubble({
            BubbleTitle: n,
            BubbleText: t,
            DisableHtmlEncoding: "boolean" == typeof i && !0 === i,
            Image: "images/info.png",
            BubbleLabelledBy: r,
            BubbleLabel: u
        }))
    }),
    Handlebars.registerHelper("customInfoBubble", function(n, t, i, r, u, f, e) {
        return Handlebars.helpers.addTemplate("UI.InfoBubble", new $$WP.UI.InfoBubble({
            BubbleTitle: t,
            BubbleText: i,
            DisableHtmlEncoding: "boolean" == typeof r && !0 === r,
            Image: n,
            UseSvgImage: !!u,
            BubbleLabelledBy: f,
            BubbleLabel: e
        }))
    }),
    Handlebars.registerHelper("simpleInfoBubble", function(n, t, i, r) {
        return Handlebars.helpers.addTemplate("UI.InfoBubble", $$WP.UI.InfoBubble.SimpleInfoBubble(n, "boolean" == typeof t && !0 === t, i, r))
    }),
    Handlebars.registerHelper("textInfoBubble", function(n, t, i, r) {
        return Handlebars.helpers.addTemplate("UI.InfoBubble", new $$WP.UI.InfoBubble({
            AnchorText: n,
            BubbleTitle: t,
            BubbleText: i,
            DisableHtmlEncoding: "boolean" == typeof r && !0 === r
        }))
    }),
    Handlebars.registerHelper("simpleTextInfoBubble", function(n, t, i) {
        return Handlebars.helpers.addTemplate("UI.InfoBubble", $$WP.UI.InfoBubble.SimpleTextInfoBubble(n, t, "boolean" == typeof i && !0 === i))
    }))
}
function registerBannerHelpers() {
    Handlebars.registerHelper("coreBanner", function(n) {
        return Handlebars.helpers.addTemplate("Core.Banner", n)
    });
    Handlebars.registerHelper("informationalBanner", function(n, t, i, r) {
        return Handlebars.helpers.addTemplate("Core.Banner", {
            BannerType: "informationalType",
            HeaderText: n,
            DetailText: t,
            IconOverride: "string" == typeof i ? i : null,
            FontSize: r
        })
    });
    Handlebars.registerHelper("successBanner", function(n, t, i, r) {
        return Handlebars.helpers.addTemplate("Core.Banner", {
            BannerType: "successType",
            HeaderText: n,
            DetailText: t,
            IconOverride: "string" == typeof i ? i : null,
            FontSize: r
        })
    });
    Handlebars.registerHelper("warningBanner", function(n, t, i, r) {
        return Handlebars.helpers.addTemplate("Core.Banner", {
            BannerType: "warningType",
            HeaderText: n,
            DetailText: t,
            IconOverride: "string" == typeof i ? i : null,
            FontSize: r
        })
    });
    Handlebars.registerHelper("criticalBanner", function(n, t, i, r) {
        return Handlebars.helpers.addTemplate("Core.Banner", {
            BannerType: "criticalType",
            HeaderText: n,
            DetailText: t,
            IconOverride: "string" == typeof i ? i : null,
            FontSize: r
        })
    })
}
var Epic = Epic || {}, $$WPUtil, $$WP, console, EpicPx;
Epic.PatientAccess = Epic.PatientAccess || {};
$$WP = $$WP || Epic.PatientAccess;
$$WP.Utilities = $$WP.Utilities || {};
$$WP.Utilities.UI = $$WP.Utilities.UI || {};
$$WP.Utilities.UI.Map = $$WP.Utilities.UI.Map || {};
$$WP.Utilities.UI.Map.Support = $$WP.Utilities.UI.Map.Support || {};
$$WP.Utilities.UI.MyChartCentral = $$WP.Utilities.UI.MyChartCentral || {};
EpicPx = EpicPx || {};
$$WP.Utilities.UI.SetContext = function() {
    var n = $afe.select("body"), t;
    $$WP.Utilities.UI.IsLoggedIn = n.hasClass("isInside");
    $$WP.Utilities.UI.IsLoggedIn || n.hasClass("isPrelogin") || EpicPx.isBuilder || $$WP.Debug.logError("Page body has neither isPrelogin nor isLoggedIn class. One or the other is required; assuming prelogin.");
    $$WP.Utilities.UI.IsMidLogin = n.hasClass("midlogin");
    $$WP.Utilities.UI.IsWorkflowRestricted = n.hasClass("workflowRestricted");
    $$WP.Utilities.UI.IsCapturedWorkflow = n.hasClass("capturedWorkflow");
    $$WP.Utilities.UI.IsMobile = $afe.select("html").hasClass("mobile");
    $$WP.Utilities.UI.IsStandaloneOpenScheduling = n.hasClass("md_openscheduling_index") || n.hasClass("md_anonymousscheduling_openscheduling") || n.hasClass("md_openscheduling_standalone");
    $$WP.Utilities.UI.IsSelfTriageForAll = (n.hasClass("md_landingpage_loadlandingpagedecisiontrees") || n.hasClass("md_selftriage_load") || n.hasClass("md_triagehistory_load")) && ($$WP.Utilities.UI.IsWorkflowRestricted || !$$WP.Utilities.UI.IsLoggedIn);
    $$WP.Utilities.UI.IsCrossDeploymentLoadingPage = n.hasClass("md_crossdeploymentscheduling_schedulefromtoken");
    $$WP.Utilities.UI.IsEmbeddedOpenSchedulingWidget = n.hasClass("embedded");
    $$WP.Utilities.UI.IsFileUploader = n.hasClass("uploaderfileinput");
    $$WP.Utilities.UI.IsFullHeightPreloginWorkflow = n.hasClass("fullHeightPrelogin");
    $$WP.Utilities.UI.IsUsingGraphicHeader = n.hasClass("graphicHeader");
    $$WP.Utilities.UI.IsMobileRTLInNonResponsive = n.hasClass("mobileRTLInNonResponsive");
    $$WP.Utilities.UI.IsOnMyWay = n.hasClass("md_onmyway_index");
    $$WP.Utilities.UI.ContextSet = !0;
    t = n.safeAttr("class") && n.safeAttr("class").match(/\bcolor\d+\b/);
    t && ($$WP.Utilities.UI.ProxyColorClass = t[0])
}
;
$$WP.Utilities.UI.OnPageLoad = function(n) {
    var t, o, r, u, f, i, e;
    if (!0 === $$WP.Utilities.UI.PageLoaded)
        throw "Full UI Load called again after completion. This is forbidden.";
    if (!0 !== $$WP.Utilities.UI.StopPageLoad && ("load" !== n.type && $$WP.Debug.logError("Full UI Load called by an event other than Page Load."),
    t = $afe.select("body"),
    o = ($afe.select("#wrap"),
    $afe.select("form")),
    $$WP.Utilities.UI.SetContext(),
    !0 !== $$WP.Utilities.UI.IsFileUploader)) {
        for ((($$WP.Utilities.UI.IsLoggedIn || $$WP.Utilities.UI.IsFullHeightPreloginWorkflow || $$WP.Utilities.UI.IsMidLogin) && $$WP.Utilities.UI.RenderHeader(),
        WP.Utils.minifyElement($afe.select("#header")),
        WP.Utils.minifyElement($afe.select("#content")),
        WP.Utils.minifyElement($afe.select("#footer")),
        $afe.select("#localeswitch").length > 0 && $afe.select("#header").addClass("haslocaleswitch"),
        o.submit(function() {
            $afe.jq(window).trigger("formSubmit")
        }),
        $$WP.Utilities.UI.ResizePage(n),
        EpicPx.isBuilder) || ($afe.select(".cssSwitcher").click(function(n) {
            var t;
            n && "A" === n.currentTarget.nodeName && (t = n.currentTarget.getAttribute("data-csstitle"));
            0 !== t.length && ($$WP.Utilities.UI.ActivateStylesheet(t),
            $$WP.Utilities.UI.FocusCssSwitcher(t))
        }),
        r = $$WP.Utilities.UI.GetAlternateStylesheetIfActive(),
        r && r.length > 0 ? $$WP.Utilities.UI.ActivateStylesheet(r) : $$WP.Utilities.UI.ActivateStylesheet("Default"),
        "1" === $$WP.Utilities.queryString("highcontrast") || "true" === $$WP.Utilities.queryString("highcontrast") ? $$WP.Utilities.UI.ActivateStylesheet("High Contrast") : "0" !== $$WP.Utilities.queryString("highcontrast") && "false" !== $$WP.Utilities.queryString("highcontrast") || $$WP.Utilities.UI.ActivateStylesheet("Default")),
        window.matchMedia && (u = window.matchMedia("(-ms-high-contrast: active)"),
        u.matches && $$WP.Utilities.UI.ActivateHighContrastThemeBasedOnMQL(u),
        u.addListener($$WP.Utilities.UI.ActivateHighContrastThemeBasedOnMQL)),
        $$WP.Utilities.UI.IsMobile && $$WP.Utilities.UI.Map.mobile(n),
        t.hasClass("passthru") && ($$WP.CommunityUtilities.checkIfCommunityJumpIsValid(),
        $afe.jq(window).on("message", $$WP.CommunityUtilities.externalJumpMessageListener),
        $afe.select("a[href*='mode=other']").remove()),
        t.on("popupStateChanged", $$WP.Utilities.UI.ReactPopupStateChangedListener),
        t.on("touchstart", ".button", function() {}),
        t.addClass("ready"),
        $$WP.Utilities.UI.IsLoggedIn && $afe.select(".component").trigger("resize"),
        navigator.userAgent.match(/Trident\/7./) && t.on("mousewheel", function(n) {
            if (!isDataTile() && !$afe.select("body").hasClass("scrollDisabled")) {
                var t = window.pageYOffset
                  , i = n.originalEvent.wheelDelta;
                if (n.ctrlKey)
                    return;
                n.preventDefault();
                window.scrollTo(window.pageXOffset, t - i)
            }
        }),
        "undefined" != typeof specialEffects && specialEffects(),
        $afe.select("#locale_container #localeswitch").length > 0 && new $$WP.UI.LocaleSwitcherController($afe.select("#locale_container")),
        i = $afe.select("#header"),
        e = !i.hasClass("static"),
        e && i.on("transitionend", function(n) {
            i.removeAttr("data-istransitioning");
            "height" == n.propertyName && $$WP.Utilities.UI.SetHeaderSize(!0)
        }),
        $afe.select("body").hasClass("isPrelogin") || $afe.jq(window).scroll(function() {
            var n, t, r;
            $afe.select("body, #wrap").hasClass("scrollDisabled") || (window.setTimeout(function() {
                $$WP.Utilities.UI.SetHeaderSize(e)
            }, 100),
            n = $$WPUtil.getScrollLeft(),
            "rtl" == $afe.select("html").safeAttr("dir") ? (t = $afe.select("body").width(),
            n = Math.min(n, t - $afe.jq(window).width()),
            r = Math.abs(n),
            i.css("right", -1 * r)) : (t = $afe.select("body").width(),
            n = Math.min(n, t - $afe.jq(window).width()),
            i.css("left", -1 * n)))
        }),
        $$WP.Utilities.UI.EnforceEpicLogoVisibility(!0),
        $afe.jq(window).on("compactHeader", function() {
            $$WP.Utilities.UI.EnforceEpicLogoVisibility(!1)
        }),
        $afe.jq(window).on("deCompactHeader", function() {
            $$WP.Utilities.UI.EnforceEpicLogoVisibility(!0)
        }),
        $$WP.Utilities.UI.MyChartCentral._overrideBackButton(),
        $$WP.Utilities.UI.PageLoaded = !0,
        f = 0; f < $$WP.Utilities.UI._onUIFrameworkLoadedCallbacks.length; f++)
            $$WP.Utilities.UI._onUIFrameworkLoadedCallbacks[f]();
        $$WP.Performance && $$WP.Performance.Tracker && $$WP.Performance.Tracker._recordFrameworkMeasurements()
    }
}
;
$$WP.Utilities.UI.SetHeaderSize = function(n) {
    var t = $afe.select("#header")
      , i = $$WPUtil.getScrollTop()
      , r = $$WP.Utilities.UI.IsUsingGraphicHeader ? 20 : 75;
    n && void 0 === t.safeAttr("data-istransitioning") && !sessionStorage.getItem("mccLocation") && (i > r ? $$WP.Utilities.UI.CollapseHeader(n) : $$WP.Utilities.UI.ExpandHeader(n))
}
;
$$WP.Utilities.UI.CollapseHeader = function(n) {
    var t = $afe.select("#header");
    t.hasClass("compact") || (t.addClass("compact"),
    $afe.jq(window).trigger("compactHeader"),
    n && t.safeAttr("data-istransitioning", !0),
    $$WP.Utilities.UI.UpdateHeaderHeightCssVariable(n))
}
;
$$WP.Utilities.UI.ExpandHeader = function(n) {
    var t = $afe.select("#header");
    t.hasClass("compact") && (t.removeClass("compact"),
    $afe.jq(window).trigger("deCompactHeader"),
    n && t.safeAttr("data-istransitioning", !0),
    $$WP.Utilities.UI.UpdateHeaderHeightCssVariable(n))
}
;
$$WP.Utilities.UI.UpdateHeaderHeightCssVariable = function(n) {
    var t = $afe.select("#header")
      , u = $afe.select("#main");
    n && t.addClass("noTransitions");
    var i = t.outerHeight()
      , r = t.css("top")
      , f = null != i && null != r ? i + parseInt(r, 10) + "px" : "0px"
      , e = u.css("padding-top");
    document.documentElement.style.setProperty("--wp-header-height", f);
    document.documentElement.style.setProperty("--wp-main-padding-top", e);
    t.safeAttr("data-istransitioning") && (t.toggleClass("compact"),
    t.outerHeight(),
    t.toggleClass("compact"));
    n && t.removeClass("noTransitions")
}
;
$$WP.Utilities.UI._onUIFrameworkLoadedCallbacks = [];
$$WP.Utilities.UI.OnUIFrameworkLoaded = function(n) {
    $$WP.Utilities.UI.PageLoaded ? n() : $$WP.Utilities.UI._onUIFrameworkLoadedCallbacks.push(n)
}
;
$$WP.Utilities.UI.ResizePage = function(n) {
    var t, r, i, e;
    if (!0 != !$$WP.Utilities.UI.ContextSet)
        if (!0 !== $$WP.Utilities.UI.CurrentlyResizing) {
            if (!0 !== $$WP.Utilities.UI.IsFileUploader) {
                if ($$WP.Utilities.UI.CurrentlyResizing = !0,
                $$WP.Debug.UpdateTopMarginForBanners(),
                $$WP.Utilities.UI.IsLoggedIn ? $$WP.Utilities.UI.Map.inside(n) : $$WP.Utilities.UI.Map.prelogin(n),
                $$WP.Utilities.UI.PageMode(n),
                $$WP.Utilities.UI.SupportFiles(n),
                !$$WP.Utilities.UI.IsMobile) {
                    if (t = $afe.select("#header"),
                    r = $afe.select("#main"),
                    !t.safeAttr("data-istransitioning")) {
                        var u = t.outerHeight()
                          , f = t.css("top")
                          , o = null != u && null != f ? u + parseInt(f, 10) + "px" : "0px"
                          , s = r.css("padding-top");
                        document.documentElement.style.setProperty("--wp-header-height", o);
                        document.documentElement.style.setProperty("--wp-main-padding-top", s)
                    }
                    !t.hasClass("midlogin") && t.hasClass("static") || $$WP.Utilities.UI.EnforceEpicLogoVisibility(!t.hasClass("compact"));
                    i = $afe.select("#footer").outerHeight();
                    e = null != i ? i + "px" : "0px";
                    document.documentElement.style.setProperty("--wp-footer-height", e)
                }
                $$WP.Utilities.UI.CurrentlyResizing = !1
            }
        } else
            $$WP.Debug.log("WARNING: ResizePage called again before resize could finish.");
    else
        $$WP.Debug.logError("ResizePage called before context was set. You should not call any part of the UI Framework before OnPageLoad has finished.")
}
;
$$WP.Utilities.UI.PageMode = function(n) {
    var t, i = $afe.select("body");
    8 !== WP.DOM.Browser.IEVersion && (t = (t = i.prop("class").split(" ").filter(function(n) {
        return /md_.*/.exec(n)
    })) && t.length > 0 ? t[0].substr(3) : null) && "function" == typeof $$WP.Utilities.UI.Map[t] && $$WP.Utilities.UI.Map[t](n)
}
;
$$WP.Utilities.UI.SupportFiles = function(n) {
    var t;
    for (t in $$WP.Utilities.UI.Map.Support)
        $$WP.Utilities.UI.Map.Support.hasOwnProperty(t) && "function" == typeof $$WP.Utilities.UI.Map.Support[t] && $$WP.Utilities.UI.Map.Support[t](n)
}
;
$$WP.Utilities.UI.ToggleButtonClick = function(n, t, i, r) {
    var e, o, f, u = $afe.jq(n);
    if (void 0 === u.prop("wasChecked") && u.is("[checked='checked']") && u.prop("wasChecked", "checked" === u.safeAttr("checked")),
    f = u.prop("type"),
    u.prop("wasChecked")) {
        if ("radio" === f && i)
            return !1;
        u.prop("checked", !1)
    } else
        u.prop("checked", !0);
    return u.prop("wasChecked", u.prop("checked")),
    u.parents("form").first().change(),
    "radio" === f && (o = u.prop("name"),
    (e = $afe.select("input[name='" + o + "']").not(u)).prop({
        checked: !1,
        wasChecked: !1
    }),
    r || e.trigger("input")),
    u.trigger("input"),
    !1
}
;
$$WP.Utilities.UI.ActivateStylesheet = function(n) {
    var t, i = "userstylesheet4" + makeLink("").replace(new RegExp("/","g"), "").toLowerCase();
    if (n && 0 !== n.length)
        for ("Default" === n ? ($afe.select("link[title]").safeAttr("rel", "alternate stylesheet").prop("disabled", !0),
        $afe.select("html").removeAttr("data-altstylesheet"),
        $$WPUtil.isLocalStorageAvailable() && void 0 !== window.localStorage && localStorage.removeItem(i)) : ($afe.select("link[title='" + n + "']").safeAttr("rel", "stylesheet").prop("disabled", !1),
        $afe.select("html").safeAttr("data-altstylesheet", n),
        $$WPUtil.isLocalStorageAvailable() && void 0 !== window.localStorage && localStorage.setItem(i, n)),
        "function" == typeof $$WP.Utilities.UI.StyleSheetAdjustment[n] && $$WP.Utilities.UI.StyleSheetAdjustment[n](),
        t = 0; t < $$WP.Utilities.UI._onStylesheetActivatedListeners.length; t++)
            $$WP.Utilities.UI._onStylesheetActivatedListeners[t].callback(n, $$WP.Utilities.UI._onStylesheetActivatedListeners[t].contextData)
}
;
$$WP.Utilities.UI.FocusCssSwitcher = function(n) {
    if (n && 0 !== n.length)
        switch (n) {
        case "Default":
            setTimeout(function() {
                $afe.select(".cssSwitcher[data-csstitle='High Contrast']").focus()
            }, 100);
            break;
        case "High Contrast":
            setTimeout(function() {
                $afe.select(".cssSwitcher[data-csstitle='Default']").focus()
            }, 100)
        }
}
;
$$WP.Utilities.UI._onStylesheetActivatedListeners = [];
$$WP.Utilities.UI.s_nextStylesheetActivatedListenerId = 1;
$$WP.Utilities.UI.OnStylesheetActivated = function(n, t) {
    n && "function" == typeof n || $$WP.Debug.logError("OnStylesheetActivated callback is not a function");
    var i = {
        callback: n,
        contextData: t,
        listenerId: $$WP.Utilities.UI.s_nextStylesheetActivatedListenerId++
    };
    return $$WP.Utilities.UI._onStylesheetActivatedListeners.push(i),
    $$WP.Utilities.UI.s_nextStylesheetActivatedListenerId
}
;
$$WP.Utilities.UI.GetAlternateStylesheetIfActive = function() {
    var n, t;
    return $$WPUtil.isLocalStorageAvailable() && void 0 !== window.localStorage && !$$WP.Utilities.UI.IsMobile && (n = "userstylesheet4" + makeLink("").replace(new RegExp("/","g"), "").toLowerCase(),
    t = localStorage.getItem(n)),
    t
}
;
$$WP.Utilities.UI.ReloadGraphs = function() {
    "function" == typeof loadGraphs && loadGraphs()
}
;
$$WP.Utilities.UI.StyleSheetAdjustment = {
    Default: $$WP.Utilities.UI.ReloadGraphs,
    "High Contrast": $$WP.Utilities.UI.ReloadGraphs
};
$$WP.Utilities.UI.IsHighContrast = function() {
    return "High Contrast" === document.documentElement.getAttribute("data-altstylesheet")
}
;
$$WP.Utilities.UI.ActivateHighContrastThemeBasedOnMQL = function(n) {
    var t;
    n.matches ? t = "High Contrast" : ($$WPUtil.isLocalStorageAvailable() && void 0 !== window.localStorage && (t = $$WP.Utilities.UI.GetAlternateStylesheetIfActive()),
    (!t || t.length <= 0) && (t = "Default"));
    $afe.select("link[title='" + t + "']").safeAttr("rel", "stylesheet").prop("disabled", !1);
    $afe.select("html").safeAttr("data-altstylesheet", t)
}
;
$$WP.Utilities.UI.IsSmallScreen = function() {
    return window.matchMedia("screen and (max-width:768px)").matches
}
;
$$WP.Utilities.UI.IsMediumSmallScreen = function() {
    return window.matchMedia("screen and (max-width:1300px)").matches
}
;
$$WP.Utilities.UI.ReactPopupStateChangedListener = function(n) {
    n && n.detail && "boolean" == typeof n.detail.isOpen && $$WP.Utilities.UI.ToggleBodyScrolling(n.detail.isOpen, $afe.select("#wrap"))
}
;
$$WP.Utilities.UI.ToggleBodyScrolling = function(n, t) {
    function r() {
        var e = Math.abs(parseInt(i.css("margin-top"))), u = i.hasClass("scrollDisabled"), n, t, r, f;
        u && i.removeClass("scrollDisabled");
        n = document.body.scrollHeight;
        t = document.body.clientHeight;
        (u && i.addClass("scrollDisabled"),
        n < e + t) && (r = t - n,
        i.css("margin-top", r + "px"),
        f = $$WP.Utilities.UI.IsUsingGraphicHeader ? 20 : 75,
        Math.abs(r) < f && ($afe.select("#header").removeClass("compact"),
        $$WP.Utilities.UI.EnforceEpicLogoVisibility(!0)))
    }
    var i = t || $afe.jq(document.body), u = $afe.jq(window), f = $afe.jq(document), e, o, s;
    !0 !== n || i.hasClass("scrollDisabled") ? !1 === n && (e = -parseInt(i.css("margin-top")),
    i.removeClass("scrollDisabled"),
    i.css("margin-top", ""),
    i.css("margin-left", ""),
    isDataTile() && null != window.frameElement || $$WPUtil.setScrollTop(e),
    u.off("resize orientationchange", r),
    f.off("visibilitychange", r)) : (isDataTile() && null != window.frameElement || (o = $$WPUtil.getScrollTop()),
    s = i.offset(),
    i.addClass("scrollDisabled"),
    i.css({
        "margin-top": -o,
        "margin-left": s.left
    }),
    u.on("resize orientationchange", r),
    f.on("visibilitychange", r))
}
;
$$WP.Utilities.UI.RenderHeader = function() {
    if ($$WP.Utilities.UI.IsUsingGraphicHeader) {
        var n = $afe.select("#graphicHeader");
        0 != n.length && ((n.safeAppend($afe.renderTemplate($$WP.Templates.Core.Header, {})),
        $afe.select("#logout_button").on("click", function() {
            ($$WP.Utilities.UI.IsSelfTriageForAll || "100" === $$WP.Utilities.queryString("workflow") && "signup" === $$WP.Utilities.queryString("postlogoutmode")) && $$WP.Utilities.UI.AddSelfTriageForAllOverrides();
            DoRedirect(null, !1)
        }),
        $afe.select("#logout_button").on("keypress", function(n) {
            32 != n.keyCode && 13 != n.keyCode || (($$WP.Utilities.UI.IsSelfTriageForAll || "100" === $$WP.Utilities.queryString("workflow") && "signup" === $$WP.Utilities.queryString("postlogoutmode")) && $$WP.Utilities.UI.AddSelfTriageForAllOverrides(),
            DoRedirect(null, !1))
        }),
        $$WP.Utilities.UI.MyChartCentral._setUpBackToMCCButton(),
        $$WP.Utilities.UI.IsLoggedIn && !$$WP.Utilities.UI.IsWorkflowRestricted) && new $$WP.Navigation.MenuController($afe.select("#header_menu"),function(n) {
            $afe.select("#header_menu_name").empty().text(n.ButtonDisplayName);
            $afe.select("#header_menu").safeAttr("title", n.ButtonDisplayName);
            null != n.Shortcuts ? $afe.select("#header_shortcuts").safeAppend($afe.renderTemplate($$WP.Templates.Core.HeaderShortcuts, n.Shortcuts)) : $afe.select("#header_shortcuts").remove();
            null != n.CovidShortcutDetails ? $afe.select("#header_covid_shortcut").safeAppend($afe.renderTemplate($$WP.Templates.Core.CovidShortcut, n.CovidShortcutDetails)) : $afe.select("#header_covid_shortcut").remove();
            "false" === sessionStorage.ShowCovidQuickAccess && $afe.select("#header_covid_shortcut").addClass("jqHidden");
            $$WP.Utilities.UI.OnUIFrameworkLoaded(function() {
                $afe.select("#header_navigation").css("max-width", "calc(100% - " + $afe.select("#header_extras_proxy").width() + "px)")
            })
        }
        ,"Menu","menu"),
        $$WP.Utilities.UI.IsLoggedIn && !$$WP.Utilities.UI.IsWorkflowRestricted && $$WP.ProxySwitch.Controllers.ProxySelectorController.getProxySelectorController($afe.select("#patient_name_switch")),
        location.href,
        $.ajax({
            type: "Get",
            url: makeLink("Localization/Links"),
            data: {
                alwaysShowDropdown: !0
            },
            datatype: "html",
            success: function(n) {
                n && (dangerou$.setHtml($afe.select("#locale_container"), n),
                $afe.select("#locale_container #localeswitch").length > 0 ? new $$WP.UI.LocaleSwitcherController($afe.select("#locale_container")) : $afe.select("#locale_container").remove())
            }
        }),
        $$WPUtil.IsNullOrEmpty($$WP.Settings.BannerLogoFileNameAndPath) || $afe.select("#graphicHeader:not(:empty) #header_logo .header_logo_link").css("background-image", "url('" + $$WP.Settings.BannerLogoFileNameAndPath + "')"),
        $afe.select("#header").focus())
    }
}
;
$$WP.Utilities.UI._bindToClickAndPress = function(n, t) {
    n.on("click", function(n) {
        t(n)
    });
    n.on("keypress", function(n) {
        32 != n.keyCode && 13 != n.keyCode || t(n)
    })
}
;
$$WP.Utilities.UI.AddSelfTriageForAllOverrides = function() {
    var n = !1
      , t = $$WPUtil.SafeToRedirectOverrideSettings;
    WP.Events.showBeforeUnloadMessage() || (WP.Events.beforeUnload(),
    n = !0);
    $$WPUtil.SafeToRedirectOverrideSettings = {
        TitleText: $$WP.Strings.get("EndSessionPopupTitle", "SelfTriage.SelfTriagePage"),
        Html: $$WP.Strings.get("EndSessionPopupPrompt", "SelfTriage.SelfTriagePage"),
        ToolbarButtons: [new $$WPComp.ComplexObjects.Button($$WP.Strings.get("StayOnPageButtonText", "SelfTriage.SelfTriagePage"),null,"","stay"), new $$WPComp.ComplexObjects.Button($$WP.Strings.get("EndSessionButtonText", "SelfTriage.SelfTriagePage"),null,"inlinedelete","leave")],
        callback: function(i) {
            $$WPUtil.SafeToRedirectOverrideSettings = t;
            n && WP.Events.cancelBeforeUnload();
            CreateLogOutPopup(i)
        }
    }
}
;
$$WP.Utilities.UI.EnforceEpicLogoVisibility = function(n) {
    var t = "display: block !important; visibility: visible !important; opacity: 1 !important; min-height: 2rem !important; height: 2rem !important; padding: 0 !important; margin-bottom: 0 !important; min-width: 3rem !important; position: static !important; z-index: auto !important;", i, r;
    n ? (window.innerWidth <= 302 && (t = "display: none;"),
    i = parseInt($afe.select("div#header_logo_by_epic").css("margin-top")),
    r = parseInt($afe.select("div#header_logo_by_epic img").css("margin-top")),
    (i > 30 || i < 0 || 0 != r) && (t += " margin-top: 0 !important"),
    $afe.select("div#header_logo_by_epic").safeAttr("style", t + " margin-left: 0.3rem !important; margin-right: 0.3rem !important;"),
    $afe.select("div#header_logo_by_epic img").safeAttr("style", t + " margin-left: 0 !important; margin-right: 0 !important;")) : ($afe.select("div#header_logo_by_epic").safeRemoveStyle(),
    $afe.select("div#header_logo_by_epic img").safeRemoveStyle())
}
;
$$WP.Utilities.UI.EnforceCopyrightEpicLogoVisibility = function() {
    if (!(0 === $afe.select("#mychart_by_epic_logo").length || $afe.select("#header_logo_by_epic").length > 0 || window.location.pathname.indexOf("/Authentication/TermsConditions") > -1)) {
        var n = "display: block !important; visibility: visible !important; opacity: 1 !important; min-height: 1rem !important; padding: 0 !important; margin: .5rem auto 0 auto !important; min-width: 6.5rem !important; width: 6.5rem !important; position: static !important; z-index: auto !important;";
        $afe.select("#mychart_by_epic_logo").safeAttr("alt", $$WP.Strings.get("MyChartByEpicAlt", "Global"));
        $afe.select("#mychart_by_epic_logo_wrapper").safeAttr("style", n);
        $afe.select("#mychart_by_epic_logo").safeAttr("style", n)
    }
}
;
$$WP.Utilities.UI.MyChartCentral._overrideBackButton = function() {
    var n, t, i;
    sessionStorage.getItem("mccLocation") && (n = $afe.select(".button.previousstep"),
    $$WP.Utilities.UI.MyChartCentral._backButtonGoesHome(n) && (t = $afe.select(".back.jqHidden"),
    t && t.removeClass("jqHidden"),
    i = $$WP.Settings.OrganizationName,
    i ? ($$WP.Strings.addMnemonic("@MYCHART@MYORGNAME@", i),
    n.text($$WP.Strings.get("ContinueToOrg")),
    $$WP.Strings.removeMnemonic("@MYCHART@MYORGNAME@")) : n.text($$WP.Strings.get("ContinueToHome")),
    $$WP.Utilities.UI._bindToClickAndPress(n, function() {
        $$WP.Utilities.UI.MyChartCentral._backButtonGoesHome() && sessionStorage.removeItem("mccLocation")
    })))
}
;
$$WP.Utilities.UI.MyChartCentral._backButtonGoesHome = function(n) {
    var t, i, r, u;
    return (n || (n = $afe.select(".button.previousstep")),
    t = n.safeAttr("href"),
    t) ? (i = t.indexOf("?"),
    i > 0 && (t = t.substring(0, i)),
    r = t.endsWith("/Home"),
    u = t.endsWith("/inside.asp"),
    r || u) : !1
}
;
$$WP.Utilities.UI.MyChartCentral._setUpBackToMCCButton = function() {
    var s = $$WP.Utilities.UI.MyChartCentral._getMccLocation(), r, u, f, t, n, i, e, h, o;
    if (s) {
        $afe.select("#header").addClass("isFromMCC");
        r = "#";
        u = "";
        try {
            f = new URLSearchParams(atob(decodeURIComponent(s)));
            t = f.get("url");
            u = f.get("target");
            n = $$WP.Settings.MyChartCentralURL;
            n.endsWith("/") && (n = n.substring(0, n.length - 1));
            t.startsWith("/") && (t = t.substring(1));
            i = n.split("/");
            e = t.split("/");
            i[i.length - 1] === e[0] && i.pop();
            h = i.concat(e);
            r = h.join("/")
        } catch (s) {}
        ($afe.select("#header_gotomcc").safeAttr("href", r),
        window.opener && !WP.DOM.Browser.isFirefox) ? (o = $afe.select("#header_gotomcc"),
        o.safeAttr("target", u),
        $$WP.Utilities.UI._bindToClickAndPress(o, function(n) {
            WP.Comm.logOut(null, !1);
            window.opener ? window.close() : (n.preventDefault(),
            window.location.href = r)
        })) : ($afe.select("#header_gotomcc").safeAttr("target", "_parent"),
        window.name = "");
        $$WP.Utilities.UI._bindToClickAndPress($afe.select("#header_logo"), function() {
            sessionStorage.removeItem("mccLocation")
        })
    }
}
;
$$WP.Utilities.UI.MyChartCentral._getMccLocation = function() {
    var t = sessionStorage.getItem("mccLocation")
      , n = $$WP.Utilities.queryString("mccLocation");
    return n && n !== t && (sessionStorage.setItem("mccLocation", n),
    t = n),
    t
}
;
$$WP.Utilities.UI.Inside = function(n) {
    if ("load" === n.type) {
        var t = $afe.select("#header");
        $afe.select("#menu .moremenu").each(function() {
            var n = $afe.jq(this)
              , t = n.find(".submenugroup");
            n.find(".submenu").addClass("columns_" + t.length)
        });
        $afe.select("#proxies a").on("mouseenter focus", function() {
            $afe.jq(this).addClass("grow").parentsUntil("#proxies", "li").addClass("preview");
            $afe.select("#proxies .selected").addClass("shrink")
        }).on("mouseleave blur", function() {
            $afe.select("#proxies .preview").removeClass("preview");
            $afe.select("#proxies .grow").removeClass("grow");
            $afe.select("#proxies .selected").removeClass("shrink")
        });
        t.on("touchstart click keydown", "#touchmenu-toggle, #proxies", $$WP.Utilities.UI.ToggleTouchMenu);
        WP.DOM.Browser.isIE && $afe.select("#header #menu").safeAttr("role", "menubar");
        $afe.select("#header").on("click", ".proxyLink", function() {
            $afe.select(".proxyLink").removeAttr("href");
            $afe.select(".proxyLink").removeAttr("onclick")
        })
    }
}
;
$$WP.Utilities.UI.HomePage = function() {
    $$WP.Utilities.UI.LoadHomePageSidebarTemplate()
}
;
$$WP.Utilities.UI.LoadHomePageSidebarTemplate = function() {
    var t, i = $afe.select("#sidebar"), n = $afe.select("#main #homepagesidebar");
    i.length > 0 && n.length > 0 && (i.safeAppend(n.clone()),
    t = widgetSettings || {},
    n.remove(),
    $$WPUtil.ComponentFactory.HomePage.Sidebar(t))
}
;
$$WP.Utilities.UI.NavTabs = function(n) {
    var t = $afe.select(".membertab")
      , i = $afe.select(".navparent");
    "load" === n.type && t.each(function() {
        $thisTab = $afe.jq(this);
        $thisTab.on("keydown", "", "", $$WP.Utilities.UI.NavTabsSpacebarHelper)
    });
    t.each(function() {
        var t, n = $afe.jq(this);
        n.find("a").safeAttr("role", "tab");
        (t = n.find("a").safeAttr("id")) && t.length > 10 && 0 === t.indexOf("tab_topic_") && ($tabContent = $afe.select("#" + t.slice(4)),
        $tabContent.safeAttr("aria-labelledby", t),
        $tabContent.safeAttr("role", "tabpanel"),
        n.find("a").safeAttr("aria-controls", $tabContent.safeAttr("id")));
        n.hasClass("selected") ? n.find("a").safeAttr("aria-selected", "true") : n.find("a").safeAttr("aria-selected", "false");
        n.prop("hoverable") || (n.hover(function(n) {
            "mouseenter" === n.type ? $afe.jq(this).addClass("hover") : $afe.jq(this).removeClass("hover")
        }),
        n.find("a").on("focus blur", function(n) {
            "focus" === n.type ? $afe.jq(this).parentsUntil(".membertab").addBack().parent(".membertab").addClass("hover") : $afe.jq(this).parentsUntil(".membertab").addBack().parent(".membertab").removeClass("hover")
        }),
        0 === n.parents(".tabcontainer").length && n.click(function() {
            var n = $afe.jq(this)
              , t = n.parents(".navparent")
              , i = t.safeAttr("data-tabset");
            void 0 !== i && (t.find(".membertab").removeClass("selected"),
            t.find(".membertab a").safeAttr("aria-selected", "false"),
            n.addClass("selected"),
            n.find("a").safeAttr("aria-selected", "true"),
            $afe.select(".tabcontainer[data-tabset='" + i + "']").addClass("hidden"),
            $afe.select(".tabcontainer[data-tabset='" + i + "'][data-tabname='" + n.safeAttr("data-tabname") + "']").removeClass("hidden"))
        }),
        n.prop("hoverable", !0))
    });
    i.each(function() {
        var t = $afe.jq(this), n = t.find(".navchild"), r = !0, i;
        $$WPUtil.IsNullOrEmpty(n) || (t.removeClass("condensed"),
        t.width() < n.prop("scrollWidth") && (t.addClass("condensed"),
        r = !1),
        "tablist" !== n.safeAttr("role") && n.safeAttr("role", "tablist"),
        n.safeAttr("aria-owns")) || (i = [],
        n.find(".membertab a").each(function() {
            var n = $afe.jq(this).safeAttr("id");
            n && i.push(n)
        }),
        i.length > 0 && n.safeAttr("aria-owns", i.join(" ")));
        r && t.removeClass("condensed")
    })
}
;
$$WP.Utilities.UI.NavTabsSpacebarHelper = function(n) {
    32 === n.which && (n.preventDefault(),
    $tab = $afe.jq(this),
    $tab.is("a") ? $tab.trigger("click") : $tab.find("a").trigger("click"))
}
;
$$WP.Utilities.UI.ToggleTouchMenu = function(n) {
    function i() {
        var n = $afe.select("#proxies")
          , t = $afe.select("body")
          , i = r()
          , u = $afe.select("#touchmenu-toggle");
        n.removeClass("droppeddown");
        t.removeClass("scrollDisabled");
        u.safeAttr("aria-expanded", "false");
        i.hide()
    }
    function r() {
        var n = $afe.select("#touchmenu"), r = $afe.select("#proxies"), t;
        return 0 === n.length && ((n = r.clone().empty().removeAttr("class").safeRemoveStyle().safeAttr("id", "touchmenu").safeAttr("tabindex", "-1")).safeAppend($afe.select("#locale_container").clone().safeAttr("id", "touchmenu-locale_container").removeAttr("class").find("#morelocales").removeAttr("aria-hidden").end().find("a").removeAttr("aria-haspopup").end()),
        n.safeAppend($afe.select("#account").clone().safeAttr("id", "touchmenu-account").removeAttr("class")),
        t = $afe.select("#header .proxy:not(#moreTabsTab)"),
        1 !== t.length && (t.each(function() {
            n.safeAppend($afe.jq(this).clone())
        }),
        $afe.select("#moretabs a").each(function() {
            var t = document.createElement("LI");
            n.safeAppend($afe.jq(t).addClass("proxy").safeAttr("role", "none").safeAppend($afe.jq(this).clone()))
        })),
        $afe.jq(window).on("resize", $$WP.Utilities.UI.ToggleTouchMenu),
        $afe.select("#header").safeAppend(n),
        $afe.select("#touchmenu-account .acctname").safeInsertBefore("#touchmenu-account .menuicon"),
        n.on("click", function(n) {
            0 === $afe.jq(n.target).parents(".proxy, #touchmenu-account, #touchmenu-locale_container").length && (i(),
            n.preventDefault())
        })),
        n
    }
    var t = !0;
    switch (n.type) {
    case "resize":
        $afe.jq(window).width() > 1300 && 0 !== $afe.select("#touchmenu").length && i();
        t = !1;
        break;
    case "keydown":
        (13 !== n.which && 32 !== n.which || $afe.jq(n.target).parents(".proxy").length > 0) && (t = !1);
        break;
    case "touchstart":
        (n.pageY || n.originalEvent.touches[0].pageY) > $afe.select("#proxies").height() && $afe.select("#proxies").hasClass("droppeddown") && (t = !1);
    case "click":
        if ("touchmenu-toggle" === n.target.id)
            break;
        ($afe.jq(document.activeElement.parentNode).hasClass("proxy") || "click" === n.type) && (t = !1)
    }
    return ($afe.jq(window).width() > 1300 || $afe.select('head meta[name="viewport"]').length < 1) && (t = !1),
    !t || ($afe.select("#proxies").hasClass("droppeddown") ? i() : function() {
        var t = $afe.select("#proxies")
          , i = $afe.select("body")
          , n = r()
          , u = $afe.select("#touchmenu-toggle");
        t.addClass("droppeddown");
        i.addClass("scrollDisabled");
        u.safeAttr("aria-expanded", "true");
        n.show();
        n.scrollTop(0)
    }(),
    !1)
}
;
$$WP.Utilities.UI.EnforceEpicLogoVisibility = function(n) {
    var u, f, o, s, t, i, r = "display: block !important; visibility: visible !important; opacity: 1 !important; min-height: 1.5rem !important; padding: 0 !important; margin-bottom: 0 !important; min-width: 2.6rem !important; position: relative !important; z-index: auto !important;", h = " margin-left: 0 !important; margin-right: 0 !important;", c = " margin-left: 0.3rem !important; margin-right: 0.3rem !important;", e;
    n ? (t = "#header_logo_by_epic",
    i = "#header_logo_by_epic_compact",
    window.innerWidth <= 300 && (r = "display: none;")) : (t = "#header_logo_by_epic_compact",
    i = "#header_logo_by_epic",
    (window.innerWidth <= 768 || WP.DOM.Browser.isMobile) && (r = "display: none;"));
    u = $afe.select(t);
    f = $afe.select(t + " img");
    o = $afe.select(i);
    s = $afe.select(i + " img");
    e = parseInt(u.css("margin-top"));
    (e > 30 || e < 0) && (c += " margin-top: 0 !important;");
    0 != parseInt(f.css("margin-top")) && (h += " margin-top: 0 !important;");
    u.safeAttr("style", r + c);
    f.safeAttr("style", r + h);
    o.safeRemoveStyle();
    s.safeRemoveStyle()
}
;
$$WP.Utilities.UI.Map.inside = $$WP.Utilities.UI.Inside;
$$WP.Utilities.UI.Map.main = $$WP.Utilities.UI.HomePage;
$$WP.Utilities.UI.Map.default = $$WP.Utilities.UI.HomePage;
$$WP.Utilities.UI.Map.Support.navtabs = $$WP.Utilities.UI.NavTabs;
$$WP.Utilities = $$WP.Utilities || {};
$$WPUtil = $$WP.Utilities;
$$WPUtil._lightboxFadeDelay = 200;
$$WPUtil.SetupRadioLabels = function() {
    $afe.select('input[type="radio"]').change(function() {
        $.each($afe.select('input[type="radio"][name="' + $afe.jq(this).safeAttr("name") + '"]'), function(n, t) {
            $afe.select('label[for="' + $afe.jq(t).safeAttr("id") + '"]').removeClass("selected")
        });
        $afe.select('label[for="' + $afe.jq(this).safeAttr("id") + '"]').addClass("selected")
    }).focus(function() {
        $afe.select('label[for="' + $afe.jq(this).safeAttr("id") + '"]').addClass("focused")
    }).blur(function() {
        $afe.select('label[for="' + $afe.jq(this).safeAttr("id") + '"]').removeClass("focused")
    });
    $afe.select(".radiolabel").click(function() {})
}
;
$$WPUtil.SetupRadioLabelsInContainer = function(n, t) {
    null !== n && (n.find('input[type="radio"]').change(function() {
        $.each(n.find('input[type="radio"][name="' + $afe.jq(this).safeAttr("name") + '"]'), function(t, i) {
            n.find('label[for="' + $afe.jq(i).safeAttr("id") + '"]').removeClass("selected")
        });
        n.find('label[for="' + $afe.jq(this).safeAttr("id") + '"]').addClass("selected");
        null !== t && t(this)
    }).focus(function() {
        n.find('label[for="' + $afe.jq(this).safeAttr("id") + '"]').addClass("focused")
    }).blur(function() {
        n.find('label[for="' + $afe.jq(this).safeAttr("id") + '"]').removeClass("focused")
    }),
    n.find(".radiolabel").click(function() {}))
}
;
$$WPUtil.SetDropdownContents = function(n, t, i, r) {
    var u;
    $$WPUtil.IsNullOrEmpty(n) || $$WPUtil.IsNullOrEmpty(t) || (r && (t = JSON.parse(t)),
    u = [],
    $.each(t, function(n, t) {
        u.push('<option value="' + n + '">' + t + "<\/option>")
    }),
    n.empty(),
    dangerou$.setHtml(n, u.join()),
    i && u.length < 2 ? n.prop("disabled", !0) : n.prop("disabled", !1))
}
;
$$WPUtil.SmoothScrollToElement = function(n, t, i, r) {
    $$WPUtil.SmoothScrollToElementWithOffset(n, t, 0, i, r)
}
;
$$WPUtil.SmoothScrollToElementWithOffset = function(n, t, i, r, u) {
    var e, f;
    if ($$WPUtil.IsNullOrEmpty(t) || 0 === t.length)
        throw "Cannot scroll to an empty target.";
    if ($$WPUtil.IsNullOrEmpty(n))
        throw "Cannot scroll nothingness.";
    $$WPUtil.IsNullOrEmpty(r) && (r = 400);
    $$WPUtil.IsNullOrEmpty(i) && (i = 0);
    e = $afe.jq(t).offset().top;
    (f = $afe.jq(n)).animate({
        scrollTop: e - i
    }, r, function() {
        u && u();
        f.addClass("force_redraw");
        window.setTimeout(function() {
            f.removeClass("force_redraw")
        }, 1)
    })
}
;
$$WPUtil.IsNullOrEmpty = function(n) {
    return null == n || "" === n
}
;
$$WPUtil.AddThrottledListener = function(n, t, i, r, u) {
    var f;
    if ($$WPUtil.IsNullOrEmpty(n))
        throw "Element to bind cannot be empty";
    if ($$WPUtil.IsNullOrEmpty(t))
        throw "You must specificy at least one event to throttle";
    $.isNumeric(r) || (r = 100);
    $$WPUtil.IsNullOrEmpty(u) && $$WPUtil.IsNullOrEmpty(i) && (i = "change");
    "function" != typeof u && (u = null);
    f = !1;
    $afe.jq(n).on(t, function(t) {
        f || (f = !0,
        window.setTimeout(function() {
            $$WPUtil.IsNullOrEmpty(i) || $afe.jq(n).trigger(i);
            $$WPUtil.IsNullOrEmpty(u) || u(t);
            f = !1
        }, r))
    })
}
;
$$WPUtil.AddImmediateThrottledListener = function(n, t, i, r, u) {
    var f;
    if ($$WPUtil.IsNullOrEmpty(n))
        throw "Element to bind cannot be empty";
    if ($$WPUtil.IsNullOrEmpty(t))
        throw "You must specificy at least one event to throttle";
    $.isNumeric(r) || (r = 100);
    $$WPUtil.IsNullOrEmpty(u) && $$WPUtil.IsNullOrEmpty(i) && (i = "change");
    "function" != typeof u && (u = null);
    f = !1;
    $afe.jq(n).on(t, function(t) {
        f || (f = !0,
        $$WPUtil.IsNullOrEmpty(i) || $afe.jq(n).trigger(i),
        $$WPUtil.IsNullOrEmpty(u) || u(t),
        window.setTimeout(function() {
            f = !1
        }, r))
    })
}
;
$$WPUtil.AddToggleListener = function(n, t, i, r, u, f, e, o, s, h) {
    var c;
    if ($$WPUtil.IsNullOrEmpty(t))
        throw "Toggle control ID is required.";
    $$WPUtil.IsNullOrEmpty(i) && (i = "click");
    !0 !== s && !1 !== s && (s = !0);
    $$WPUtil.GetUniqueJQueryById(n, t).on(i, function(i) {
        var l, v, a;
        return l = $$WPUtil.GetUniqueJQueryById(n, t).safeAttr("data-toggle-for"),
        $$WPUtil.IsNullOrEmpty(l) || (a = (v = $afe.select("#" + l)).safeAttr("data-toggled"),
        c = $afe.jq(o),
        $.each(c, function(n, t) {
            var i;
            $afe.select('[data-toggle-for="' + $afe.jq(this).safeAttr("id") + '"]').removeClass(r).addClass(u);
            (i = $afe.jq(t)).safeAttr("data-toggled", "false");
            i.removeClass(f).addClass(e)
        }),
        $$WPUtil.SetElementToggled(v, $afe.jq(this), "true" !== a, f, e, r, u),
        "function" == typeof h && h("true" === a, i)),
        !s
    })
}
;
$$WPUtil.SetElementToggled = function(n, t, i, r, u, f, e) {
    var s, o;
    o = $afe.jq(n);
    s = $$WPUtil.IsNullOrEmpty(t) ? $afe.select('[data-toggle-for="' + o.safeAttr("id") + '"]') : $afe.jq(t);
    "true" === i || !0 === i ? (o.safeAttr("data-toggled", "true"),
    o.removeClass(u).addClass(r),
    s.length > 0 && s.removeClass(e).addClass(f)) : (o.safeAttr("data-toggled", "false"),
    o.removeClass(r).addClass(u),
    s.length > 0 && s.removeClass(f).addClass(e))
}
;
$$WPUtil.ElementHasXOverflow = function(n) {
    return n.offsetWidth < n.scrollWidth
}
;
$$WPUtil.ElementHasYOverflow = function(n) {
    var t = $afe.select("html").get(0).offsetHeight
      , i = n.offsetHeight
      , r = n.scrollHeight;
    return t > i ? i < r : t === i && t === r ? $afe.jq(window).height() < t : void 0
}
;
$$WPUtil.IsElementInView = function(n) {
    var t, r, i;
    return isDataTile() && null != window.frameElement ? (t = parent,
    i = window.frameElement.offsetTop) : (t = window,
    i = 0),
    r = $afe.jq(t),
    n.offset().top >= t.pageYOffset && n.offset().top + n.height() + i <= t.pageYOffset + r.height()
}
;
$$WPUtil.ElementHasScrolledToBottom = function(n, t) {
    var i, f = $afe.jq(n), r = $afe.select("html").get(0).offsetHeight, e = n.offsetHeight, u = n.scrollHeight;
    return $.isNumeric(t) || (t = .8),
    i = f,
    r === e && r === u && (i = $afe.jq(window)),
    i.scrollTop() + i.innerHeight() >= u * t
}
;
$$WPUtil.GUIDPrefix = function(n) {
    return n ? n + "_" : ""
}
;
$$WPUtil.GetUniqueJQueryById = function(n, t) {
    return $afe.select("#" + $$WPUtil.GUIDPrefix(n) + t)
}
;
$$WPUtil.GetStringResource = function(n, t, i) {
    var u = null
      , r = "";
    return t && (r = (u = $$WPUtil.GetUniqueJQueryById(n, "resources").find('div[data-rsrc-id="' + t + '"]')).safeAttr("data-rsrc-val"),
    $$WPUtil.IsNullOrEmpty(r) && (r = u.html()),
    $$WPUtil.IsNullOrEmpty(i) || (r = $$WPUtil.ReplaceStringMnemonics(r, i))),
    r || ""
}
;
$$WPUtil.ReplaceStringMnemonics = function(n, t) {
    var i;
    return $$WPUtil.IsNullOrEmpty(n) ? null : ($$WPUtil.IsNullOrEmpty(t) || $.each(t, function(t, r) {
        i = new RegExp("@MYCHART@" + t + "@","gi");
        n = n.replace(i, r)
    }),
    n)
}
;
$$WPUtil.PopulateComplexTemplate = function(n, t, i, r, u, f) {
    var e, s, h, o;
    if ($$WPUtil.IsNullOrEmpty(t))
        throw "You must supply a template ID";
    return $$WPUtil.IsNullOrEmpty(f) && (f = 0),
    $$WPUtil.IsNullOrEmpty(r) && (r = {}),
    o = (n ? n + "_" : "") + t + "_" + f,
    "true" === (e = $$WPUtil.GetUniqueJQueryById(n, t).clone()).safeAttr("data-template-children-only") ? e = e.children() : "true" === e.safeAttr("data-template-no-id") ? e.safeAttr("id", "") : e.safeAttr("id", o),
    o += "_",
    s = $$WPUtil.RecurseComplexTemplate(e, r, u, o),
    $$WPUtil.IsNullOrEmpty(i) || ((h = $afe.jq(i)).empty(),
    s.safeAppendTo(h)),
    s
}
;
$$WPUtil.RecurseComplexTemplate = function(n, t, i, r, u, f) {
    var s, e, o;
    return $.each(n, function(e, o) {
        var c, p, l, k, a, s, w, d, h, g, nt, b, v, y, tt;
        if (c = (o = $afe.jq(o)).safeAttr("data-template-group"),
        p = o.safeAttr("data-template-group-source"),
        h = o.safeAttr("data-template-source"),
        b = o.safeAttr("data-template-id"),
        a = s = w = !1,
        tt = (o.safeAttr("data-template-type") || "").split(" "),
        $.each(tt, function(n, t) {
            switch (t) {
            case "collection":
                a = !0;
                break;
            case "object":
                s = !0;
                break;
            case "value":
                w = !0;
                break;
            case "nullable":
                d = !0;
                break;
            case "fill":
                nt = !0
            }
        }),
        l = !$$WPUtil.IsNullOrEmpty(c) && !$$WPUtil.IsNullOrEmpty(p),
        k = !$$WPUtil.IsNullOrEmpty(c) && a,
        (s || w) && d && $$WPUtil.IsNullOrEmpty(t[h]) || nt)
            n = n.not(o.empty().remove());
        else if ((a || s || l) && !k)
            l && (o = o.parent().children('[data-template-group="' + c + '"]'),
            h = p),
            y = $$WPUtil.IsNullOrEmpty(h) ? t : t[h],
            s && (y = [y]),
            s || $$WPUtil.IsNullOrEmpty(b) || (v = 0),
            $.each(y, function(t, u) {
                var f, e;
                "function" == typeof i && (u = i(h, t, u));
                $$WPUtil.IsNullOrEmpty(u) || (f = o.clone(),
                l ? (f.removeAttr("data-template-group"),
                f.removeAttr("data-template-group-source")) : (f.removeAttr("data-template-type"),
                f.removeAttr("data-template-source")),
                f.safeInsertBefore(o.get(0)),
                e = $$WPUtil.RecurseComplexTemplate(f, u, i, r, b, v),
                $.isNumeric(v) && (v += 1),
                f.safeReplaceWith(e),
                n = n.add(e))
            }),
            n = n.not(o.empty().remove());
        else {
            if (!$$WPUtil.IsNullOrEmpty(o.safeAttr("data-template-group")))
                return;
            o.children().length > 0 && (g = $$WPUtil.RecurseComplexTemplate(o.children(), t, i, r, u, f),
            o.children().remove(),
            g.safeAppendTo(o),
            n = n.not(o).add(o))
        }
    }),
    s = $$WPUtil.SerializeNodes(n),
    "string" == typeof t && (t = {
        "#Value": t
    }),
    o = $.isNumeric(f),
    t["#ID"] = r + (u || "") + (u && o ? "_" + f : ""),
    t["#NUM"] = o ? f : "",
    e = dangerou$.parseHtml($$WPUtil.ReplaceTemplateMnemonics(s, t)),
    $.each(e, function(n, t) {
        var r, u, i = $afe.jq(t);
        r = i.safeAttr("data-src-url");
        $$WPUtil.IsNullOrEmpty(r) || (i.safeAttr("src", r),
        i.removeAttr("data-src-url"));
        u = i.safeAttr("data-headers");
        $$WPUtil.IsNullOrEmpty(u) || (i.safeAttr("headers", u),
        i.removeAttr("data-headers"));
        r = i.safeAttr("data-href-url");
        $$WPUtil.IsNullOrEmpty(r) || (i.safeAttr("href", r),
        i.removeAttr("data-href-url"))
    }),
    e
}
;
$$WPUtil.SerializeNodes = function(n) {
    var i, t = "";
    return "function" == typeof XMLSerializer ? (i = new XMLSerializer,
    $.each(n, function(n, r) {
        t += r.outerHTML || i.serializeToString(r)
    })) : $.each(n, function(n, i) {
        t += i.outerHTML || i.xml
    }),
    t
}
;
$$WPUtil.ReplaceTemplateMnemonics = function(n, t) {
    var i;
    return $$WPUtil.IsNullOrEmpty(n) ? null : ($$WPUtil.IsNullOrEmpty(t) || $.each(t, function(t, r) {
        i = new RegExp("__" + t + "__","gi");
        "string" == typeof r && (r = HTMLEncode(r));
        n = n.replace(i, r)
    }),
    n)
}
;
$$WPUtil.CenterContainerOnPage = function(n, t) {
    var i, r = 0;
    $afe.jq(window).height();
    i = $afe.jq(n);
    t && $$WPUtil.setScrollTop(0);
    (r = $$WPUtil.getScrollTop() + ($afe.jq(window).height() - i.height()) / 2) < 0 && (r = 0);
    i.css({
        top: r + "px"
    })
}
;
$$WP.Utilities.isAbsoluteURL = function(n) {
    return new RegExp("^(?:[a-z]+:)?//","i").test(n)
}
;
$$WPUtil.ShowUrlInLightbox = function(n, t, i, r, u) {
    var f;
    (f = n.url || n) && $.ajax($.extend({
        url: f,
        type: "GET",
        dataType: "html",
        success: function(n) {
            var f, t;
            $$WPUtil.ShowLightboxOverlay(null, r, u);
            t = $afe.select("#lightbox");
            dangerou$.setHtml(t, "");
            f = $afe.select(".ajaxspinner").length > 0;
            dangerou$.setHtml(t, n);
            f && t.find(".ajaxspinner").remove();
            $afe.select("body").addClass("showLightBox");
            t.removeClass("hidden").show(function() {
                $$WPUtil.CenterContainerOnPage(t)
            }).promise().done(function() {
                i && "function" == typeof i && i()
            })
        }
    }, t || n.settings))
}
;
$$WPUtil.ShowContainerAsLightbox = function(n, t, i) {
    var r, u = {
        container: n,
        hideLightboxCallback: i
    };
    $$WPUtil.ShowLightboxOverlay(n, t, i);
    (r = $afe.jq(n)).show($$WPUtil._lightboxFadeDelay, function() {
        r.find(".slider").trigger("matchCardHeights");
        $$WPUtil.CenterContainerOnPage(n)
    });
    r.on("keydown", function(n) {
        $$WPUtil.LightboxKeyDownHandler(n, r, $$WPUtil.LightboxEscKeyHandler, null, null, u)
    })
}
;
$$WPUtil.LightboxEscKeyHandler = function(n, t) {
    var i = t.container
      , r = t.hideLightboxCallback;
    $$WPUtil.HideLightbox(i, r);
    n.preventDefault()
}
;
$$WPUtil.ShowLightboxOverlay = function(n, t, i) {
    var r = $afe.select("#lightbox_overlay");
    r.off("click");
    r.on({
        click: function() {
            $$WPUtil.HideLightbox(n, i)
        }
    });
    r.show($$WPUtil._lightboxFadeDelay).promise().done(function() {
        t && "function" == typeof t && t()
    })
}
;
$$WPUtil.LightboxKeyDownHandler = function(n, t, i, r, u, f) {
    var e, o, s;
    switch (o = (e = t.find("a[href]:not([tabindex='-1']), area[href]:not([tabindex='-1']), input:not([tabindex='-1']), select:not([tabindex='-1']), textarea:not([tabindex='-1']), button:not([tabindex='-1']), [tabindex]:not([tabindex='-1'])"))[0],
    s = e[e.length - 1],
    n.which) {
    case 9:
        n.shiftKey ? document.activeElement === o && ($afe.jq(s).focus(),
        n.preventDefault()) : document.activeElement === s && ($afe.jq(o).focus(),
        n.preventDefault());
        break;
    case 27:
        null !== i && "function" == typeof i && i(n, f);
        break;
    case 38:
        null !== r && "function" == typeof r && r(n, f);
        break;
    case 40:
        null !== u && "function" == typeof u && u(n, f)
    }
}
;
$$WPUtil.HideLightbox = function(n, t) {
    !0 !== $$WPUtil.PreventHideLightbox && ($$WPUtil.IsNullOrEmpty(n) || $afe.jq(n).hide($$WPUtil._lightboxFadeDelay),
    $afe.select(".lb_content").hide($$WPUtil._lightboxFadeDelay),
    $afe.select("#lightbox_overlay").hide($$WPUtil._lightboxFadeDelay),
    $afe.select("body").removeClass("showLightBox"),
    hideLightbox(),
    t && "function" == typeof t && t())
}
;
$$WPUtil.AjaxifyForm = function(n, t, i, r, u) {
    var f = {};
    t && (f.url = $afe.jq(t).safeAttr("action"),
    f.type = $afe.jq(t).safeAttr("method"),
    f.sendFormData = !0,
    t.off("submit").on("submit", $$WPUtil.SubmitAjaxifiedForm(f, n, t, i, r, u)))
}
;
$$WPUtil.SubmitAjaxifiedForm = function(n, t, i, r, u, f) {
    return function() {
        var e, o, s, h;
        return e = $$WPUtil.AjaxifyFormSubmitHandler(t, i, r, u, f),
        o = n.url,
        s = n.type,
        h = n.sendFormData ? $afe.jq(i).serialize() : {},
        !!$$WPUtil.ValidateForm(t, i) && ($.ajax({
            url: o,
            type: s,
            data: h,
            context: $afe.jq(i),
            datatype: "json",
            error: $$WPUtil.DisplayAjaxError,
            statusCode: {
                404: function() {}
            },
            success: e
        }),
        !1)
    }
}
;
$$WPUtil.AjaxifyFormSubmitHandler = function(n, t, i, r, u) {
    return function(f) {
        if ("syncchart" !== f.action)
            if ("endworkflow" !== f.action) {
                if ("showerrors" === f.action)
                    return $$WPUtil.WriteErrorsToForm(n, $afe.jq(t), f.errors, f.Mnemonics),
                    void $$WPUtil._invokeErrorCallback(i, f.errors);
                if ($$WPUtil.RunCallbackForType(u),
                r && "function" == typeof r) {
                    var e = !0;
                    try {
                        e = r(f)
                    } catch (n) {}
                    if (!e)
                        return
                }
                "lightbox" === f.action && f.url.length > 0 ? $$WPUtil.ShowUrlInLightbox(f) : "redirect" !== f.action || window.location.assign(f.url || "/")
            } else
                $$WPUtil._invokeErrorCallback(i, f.errors);
        else
            $$WPUtil._invokeErrorCallback(i, f.info)
    }
}
;
$$WPUtil._invokeErrorCallback = function(n, t) {
    if (n && "function" == typeof n)
        try {
            n(t)
        } catch (n) {
            $$WPUtil.ShowUrlInLightbox("Error")
        }
}
;
$$WPUtil.CallbackTypeEnum = {
    Authenticate: "Authenticate"
};
$$WPUtil.RegisterCallbackForType = function(n, t) {
    var i = $$WPUtil.CallbackTypeEnum[n];
    $$WP.CallbacksForType || ($$WP.CallbacksForType = {});
    !$$WPUtil.IsNullOrEmpty(i) && t && "function" == typeof t && ($$WP.CallbacksForType[i] = t)
}
;
$$WPUtil.RunCallbackForType = function(n) {
    var t, i = $$WPUtil.CallbackTypeEnum[n];
    $$WPUtil.IsNullOrEmpty(i) || (t = $$WP.CallbacksForType[i]) && "function" == typeof t && t()
}
;
$$WPUtil.DisplayAjaxError = function(n, t) {
    alert("An error occurred while processing the request: " + t)
}
;
$$WPUtil.ValidateForm = function(n, t) {
    var i = {}
      , r = !1;
    return t.find("[data-form-valmsg-for=" + t.safeAttr("id") + "]").removeClass("field-validation-error").addClass("field-validation-valid").empty(),
    t.find("span[data-valmsg-for]").removeClass("field-validation-error").addClass("field-validation-valid").empty(),
    t.find("input").each(function() {
        if ("true" === $afe.jq(this).safeAttr("data-val")) {
            var n = $afe.jq(this).safeAttr("data-val-required");
            n && "" === this.value ? (i[$afe.jq(this).safeAttr("name")] = n,
            r = !0) : $afe.jq(this).removeClass("input-validation-error")
        }
    }),
    !r || ($$WPUtil.WriteErrorsToForm(n, t, i),
    !1)
}
;
$$WPUtil.WriteErrorsToForm = function(n, t, i, r) {
    var u, f, e = {};
    for (u in i = $$WPUtil.MapValidationCodesFromServer(n, i, r),
    t.find("input").each(function() {
        var n = $afe.jq(this).safeAttr("name")
          , r = $afe.jq(this).safeAttr("id")
          , u = i[n];
        1 !== e[n] && (u ? ($afe.jq(this).addClass("input-validation-error"),
        dangerou$.setHtml(t.find('span[data-valmsg-for="' + r + '"]').removeClass("field-validation-valid").addClass("field-validation-error"), u),
        delete i[n],
        e[n] = 1) : ($afe.jq(this).removeClass("input-validation-error"),
        t.find('span[data-valmsg-for="' + r + '"]').removeClass("field-validation-error").addClass("field-validation-valid").empty()))
    }),
    (f = i.formlevelmsg) ? (dangerou$.setHtml(t.find('div[data-valmsg-summary="true"]').removeClass("validation-summary-valid").addClass("validation-summary-errors").find("ul").safeAppend("li"), f),
    delete i.formlevelmsg) : t.find('div[data-valmsg-summary="true"]').removeClass("validation-summary-errors").addClass("validation-summary-valid").find("ul").empty(),
    i)
        i.hasOwnProperty(u) && (f = i[u]) && dangerou$.setHtml(t.find('span[data-valmsg-for*="' + u + '"]').removeClass("field-validation-valid").addClass("field-validation-error"), f)
}
;
$$WPUtil.MapValidationCodesFromServer = function(n, t, i) {
    var r, u;
    return $$WPUtil.GetUniqueJQueryById(n, "resources"),
    r = {},
    $.each(t, function(t, f) {
        var e;
        $$WPUtil.IsNullOrEmpty(i) || (e = i[t]);
        u = $$WPUtil.GetStringResource(n, f, e);
        r[t] = u || f
    }),
    r
}
;
$$WPUtil.LogAction = function(n, t, i) {
    var r = $afe.select("#logActionUrl").html();
    $.ajax(r, {
        type: "POST",
        action: t,
        mnemonicsString: JSON.stringify(i),
        suppressEpicDefaultAjaxErrorHandler: !0
    })
}
;
$$WPUtil.getScrollNode = function() {
    var n;
    return (n = isDataTile() ? parent.document : document).scrollingElement || n.documentElement
}
;
$$WPUtil.ScrollableBody = function() {
    var n;
    return n = $$WPUtil.getScrollNode(),
    $afe.jq(n)
}
;
$$WPUtil.getScrollTop = function() {
    return $$WPUtil.getScrollNode().scrollTop
}
;
$$WPUtil.setScrollTop = function(n) {
    $$WPUtil.IsNullOrEmpty(n) && (n = 0);
    $$WPUtil.getScrollNode().scrollTop = n
}
;
$$WPUtil.getScrollLeft = function() {
    return $$WPUtil.getScrollNode().scrollLeft
}
;
$$WPUtil.setScrollLeft = function(n) {
    $$WPUtil.IsNullOrEmpty(n) && (n = 0);
    $$WPUtil.getScrollNode().scrollLeft = n
}
;
$$WPUtil.ActivateHelp = function(n) {
    $afe.select('a[data-lightbox-guid="' + n + '"]').each(function() {
        $afe.jq(this).off("click").on("click", function() {
            $$WPUtil.ShowContainerAsLightbox($$WPUtil.GetUniqueJQueryById(n, $afe.jq(this).safeAttr("data-lightbox-id")))
        })
    })
}
;
$$WPUtil.getDataTileScrollTop = function(n) {
    return Math.max(0, -n.getBoundingClientRect().top)
}
;
$$WPUtil.SetupCustomTabbingForFields = function(n) {
    var i, r, t;
    for (n[n.length],
    t = 0; t < n.length; t++)
        i = t > 0 ? n[t - 1] : null,
        r = t < n.length - 1 ? n[t + 1] : null,
        n[t].on("keydown", {
            $tabFrom: i,
            $tabTo: r
        }, $$WPUtil._CustomTabbingForField),
        null !== i && null !== r && n[t].safeAttr("tabindex", -1)
}
;
$$WPUtil._CustomTabbingForField = function(n) {
    var t;
    9 === n.keyCode && null !== (t = n.shiftKey ? n.data.$tabFrom : n.data.$tabTo) && (t.focus(),
    n.stopPropagation(),
    n.preventDefault())
}
;
$$WPUtil.quickPopup = function(n, t) {
    Array.isArray(n) ? t.Components = n : t = $$WPUtil.mergeObjects({
        Components: n
    }, t, !0);
    var i = new $$WPContain.Popup(t);
    return i.show(!0),
    i
}
;
$$WPUtil.SafeToRedirectOverrideSettings = {};
$$WPUtil.SafeToRedirect = function(n, t) {
    var r, i;
    if (WP.Events.showBeforeUnloadMessage()) {
        if (!0 !== WP.Events.SafeToUnloadWarningDisplayed)
            return i = {
                callback: n
            },
            $.extend(i, $$WPUtil.SafeToRedirectOverrideSettings),
            r = new $$WPComp.SafeToRedirectComponent(i),
            $$WPUtil.quickPopup(r, {
                positioningFunction: t
            })
    } else
        n(!0)
}
;
$$WPUtil.TryRedirect = function(n, t, i, r, u) {
    var f, e, o, s = function(t) {
        var o, s;
        if (t) {
            var f, h, e = $$WPUtil.parseQueryString(n).mode, l = ($$WPUtil.queryString("mode"),
            $$WPUtil.TryRedirect._mustPickOrganizationModes), a = $$WPUtil.TryRedirect._mustPickOrganizationRoutes, c = function(n, t, i) {
                var r, f;
                if ($$WPUtil.IsH2GActivity(n))
                    return -1 === n.toLowerCase().indexOf(makeLink("").toLowerCase()) && (n = makeLink(n)),
                    void (window.location = n);
                i && "1" !== i && !i.IsLocal ? (r = (f = n.toLowerCase().indexOf(makeLink("").toLowerCase())) > -1 ? n.substr(f + makeLink("").length) : n,
                "string" == typeof i ? $$WP.CommunityUtilities.getOrganization(i, function(n, t, i) {
                    $$WP.CommunityUtilities.openDeepLink("netredirect", i, {
                        targetUrl: n
                    }, t ? $$WP.CommunityUtilities.openDeepLinkType.InNewTab : $$WP.CommunityUtilities.openDeepLinkType.InPopup)
                }, [r, t]) : $$WP.CommunityUtilities.openDeepLink("netredirect", i, {
                    targetUrl: r
                }, t ? $$WP.CommunityUtilities.openDeepLinkType.InNewTab : $$WP.CommunityUtilities.openDeepLinkType.InPopup)) : t ? openWindow(n, "", "", "", u) : window.location = n
            };
            if (!i) {
                if (o = $$WPUtil.parseQueryString(n).local,
                s = null,
                void 0 !== o ? "1" === o ? f = !1 : "0" === o && (f = !0) : l.indexOf(e) > -1 ? f = !0 : $.each(a, function(t, i) {
                    const r = n.indexOf(t)
                      , u = r + t.length;
                    if (r > -1 && (u >= n.length || !/[a-zA-Z0-9]/.test(n[u])))
                        return f = !0,
                        e = i,
                        void (s = makeLink("inside.asp?mode=" + e))
                }),
                f)
                    return -1 !== ["msgoptions", "medrefill", "custsvc", "refrequest"].indexOf(e) && (h = $$WP.Strings.get("PickOrganization", "Messaging.Review")),
                    void $$WP.CommunityUtilities.pickOrganization(function(n, t) {
                        "close" !== t && (s && (n = s),
                        c(n, r, t))
                    }, h, [n], e, $$WP.Strings.get("PickOrganizationTitle", "Messaging.Review"));
                i = "1"
            }
            c(n, r, i)
        }
    };
    f = (f = window.location.protocol + "//" + window.location.hostname).toLowerCase();
    o = (e = n.toLowerCase()).substring(0, 4);
    (r = r || e.indexOf(f) < 0 && "http" === o) ? s(!0) : $$WPUtil.SafeToRedirect(s, t)
}
;
$$WPUtil.TryRedirect._mustPickOrganizationModes = ["msgoptions", "refrequest"];
$$WPUtil.TryRedirect._mustPickOrganizationRoutes = {
    "/AskQuestion": "msgoptions",
    "/RequestReferral": "refrequest"
};
$$WPUtil.DidNotRedirect = function() {
    $$WPComp.SafeToRedirectComponent.canceledRedirect()
}
;
$$WPUtil.setActivity = function() {
    if (checkActivity && checkActivity.sessionTimeout && $$WPUtil.setActivity.msSinceLastActivity() >= checkActivity.sessionTimeout)
        return document.write(""),
        void (window.location = makeLink("default.asp"));
    $$WPUtil.setActivity.__lastActivity = new Date;
    $$WPUtil.IsNullOrEmpty($$WP.CommunityUtilities.getParentJumpGUID()) || parent.postMessage(JSON.stringify({
        message: "setActivity",
        externalGUID: $$WP.CommunityUtilities.getParentJumpGUID()
    }), $$WP.CommunityUtilities.getParentDomain())
}
;
$$WPUtil.NotifyMobileOfActivity = function() {
    window.Android && window.Android.webViewIsActive ? Android.webViewIsActive() : window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.webViewIsActive && window.webkit.messageHandlers.webViewIsActive.postMessage("")
}
;
$$WPUtil.checkActivity = function() {
    checkActivity()
}
;
$$WPUtil.setActivity.msSinceLastActivity = function() {
    return new Date - $$WPUtil.setActivity.__lastActivity
}
;
$$WPUtil.copyObject = function(n) {
    if (!n)
        return null;
    if (!Array.isArray(n))
        return $$WPUtil.mergeObjects(n, {}, !1, !0);
    var i, t, r;
    for (i = [],
    r = n.length,
    t = 0; t < r; t++)
        i.push(n[t]);
    return i
}
;
$$WPUtil.mergeObjects = function(n, t, i, r) {
    if ((Array.isArray(n) || Array.isArray(t)) && console.error("mergeObjects cannot be used on arrays"),
    t = t || {},
    i && (t = $$WPUtil.copyObject(t)),
    !n)
        return t;
    var f, u, e;
    for (u in e = function(n) {
        return n && "object" == typeof n && !(n instanceof jQuery) && !$$WPComp.isComponent(n) && !Array.isArray(n) && !(n instanceof Handlebars.SafeString)
    }
    ,
    n)
        void 0 !== (f = n[u]) && (e(f) ? t[u] = $$WPUtil.mergeObjects(n[u], t[u], !1, r) : !r && t[u] || (Array.isArray(f) && (f = $$WPUtil.copyObject(f)),
        t[u] = f));
    return t
}
;
$$WP.Utilities.guaranteeExistence = function(n, t, i) {
    n = n || $$WP;
    for (var u = t.split("."), f = u.length - 1, r = 0; r < f; r++)
        n.hasOwnProperty(u[r]) || (n[u[r]] = {}),
        n = n[u[r]];
    return n.hasOwnProperty(u[r]) || (n[u[r]] = arguments.length > 2 ? i : {}),
    n
}
;
$$WPUtil.preventEvent = function(n) {
    return n.stopPropagation(),
    n.preventDefault(),
    !1
}
;
$$WPUtil.parseQueryString = function(n) {
    "&" === n.charAt(n.length - 1) && (n = n.substring(0, n.length - 1));
    for (var r, f, i = n.substr(n.indexOf("?") + 1).split("&"), u = {}, t = 0; t < i.length; t++)
        -1 === (r = i[t].indexOf("=")) && t > 0 ? u[f] += "&" + i[t] : u[f = i[t].substr(0, r).toLowerCase()] = i[t].substr(r + 1);
    return u
}
;
$$WPUtil.queryString = function(n) {
    return $$WPUtil.queryString.parsed || ($$WPUtil.queryString.parsed = $$WPUtil.parseQueryString(window.location.search)),
    $$WPUtil.queryString.parsed[n.toLowerCase()] || ""
}
;
$$WPUtil.removeParamsFromQueryString = function(n) {
    return $$WPUtil.queryString.parsed || ($$WPUtil.queryString.parsed = $$WPUtil.parseQueryString(window.location.search)),
    "string" == typeof n ? delete $$WPUtil.queryString.parsed[n.toLowerCase()] : n.forEach(function(n) {
        delete $$WPUtil.queryString.parsed[n.toLowerCase()]
    }),
    Object.keys($$WPUtil.queryString.parsed).map(function(n) {
        return n + "=" + $$WPUtil.queryString.parsed[n]
    }).join("&")
}
;
$$WPUtil.verticalScrollBarWidth = function() {
    var n, t, i, r;
    return $$WPUtil.verticalScrollBarWidth._cached || (t = (n = $afe.renderTemplate($$WP.Templates.Core.scrollbarwidth)).children(0).get(0),
    document.body.appendChild(n.get(0)),
    i = t.offsetWidth,
    n.css("overflow", "scroll"),
    (r = t.offsetWidth) === i && (r = n.get(0).clientWidth),
    n.remove(),
    $$WPUtil.verticalScrollBarWidth._cached = i - r),
    $$WPUtil.verticalScrollBarWidth._cached
}
;
$$WPUtil.preventAndroidLongPress = function(n, t, i) {
    navigator.userAgent.indexOf("Android") >= 0 && (1 !== n.length || t || (t = n,
    i = ""),
    t && t.on("contextmenu", i, function(n) {
        n.preventDefault()
    }))
}
;
$$WPUtil.isBrowserCapableOf = function(n, t) {
    var i;
    switch (n) {
    case "flexbox":
        return void 0 !== document.body.style.flex;
    case "input":
        return i = document.createElement("input"),
        $afe.jq(i).safeAttr("type", t.type),
        i.type === t.type;
    case "touchEvents":
        return "ontouchstart"in window || window.navigator.msMaxTouchPoints && window.navigator.msMaxTouchPoints > 0;
    case "canvas":
        return !!window.HTMLCanvasElement;
    case "ActiveX":
        return !!window.ActiveXObject;
    case "Intl":
        return "object" == typeof Intl && "DateTimeFormat"in Intl && "NumberFormat"in Intl
    }
}
;
$$WPUtil.isValidBrowser = function() {
    return $$WPUtil.isBrowserCapableOf("canvas") && !$$WPUtil.isBrowserCapableOf("ActiveX") && $$WPUtil.isBrowserCapableOf("Intl")
}
;
$$WPUtil.addUrlParameter = function(n, t, i) {
    return -1 === n.indexOf("?") ? n += "?" : "&" !== n[n.length - 1] && (n += "&"),
    n + t + "=" + i
}
;
$$WPUtil.isNaN = function(n) {
    return isNaN(n) || !n && 0 !== n
}
;
$$WPUtil.confirmFormSubmission = function(n, t, i, r, u, f, e) {
    return i ? $$WPUtil.quickMessageBoxByEnum(t, i, $$WPUtil.confirmFormSubmission.submitForm, [n, r]) : $$WPUtil.quickMessageBox(t, f, u, $$WPUtil.confirmFormSubmission.submitForm, [n, r], "", e),
    !1
}
;
$$WPUtil.confirmFormSubmission.submitForm = function(n, t, i) {
    var r;
    "function" == typeof t && !1 === t(n, i) || i === $$WP.Components.TOOLBARIDENTIFIER + "continue" && (r = n.onclick,
    n.onclick = null,
    $(n).off(),
    n.click(),
    n.onclick = r)
}
;
$$WPUtil.quickMessageBoxByEnum = function(n, t, i, r, u) {
    var f, e, o = $$WPUtil.quickMessageBoxByEnum.typeEnum;
    switch (t = t || $$WPUtil.quickMessageBoxByEnum.typeEnum.ContinueGoback) {
    case o.ContinueGoback:
        f = $$WP.Strings.get("ContinueGobackTitle", "Core.Utilities");
        e = $$WPUtil.createContinueGoBackButtons();
        break;
    case o.DeleteGoback:
        f = $$WP.Strings.get("DeleteGobackTitle", "Core.Utilities");
        e = $$WPUtil.createDeleteGoBackButtons();
        break;
    case o.YesNo:
        f = $$WP.Strings.get("YesNoTitle", "Core.Utilities");
        e = $$WPUtil.createYesNoButtons();
        break;
    case o.Ok:
        f = $$WP.Strings.get("AlertTitle", "Core.Utilities");
        e = $$WPUtil.createOkButton();
        break;
    case o.RemoveGoback:
        f = $$WP.Strings.get("ContinueGobackTitle", "Core.Utilities");
        e = $$WPUtil.createRemoveGoBackButtons();
        break;
    case o.RestoreGoback:
        f = $$WP.Strings.get("ContinueGobackTitle", "Core.Utilities");
        e = $$WPUtil.createRestoreGoBackButtons();
        break;
    default:
        return
    }
    return $$WPUtil.quickMessageBox(n, f, e, i, r, u)
}
;
$$WPUtil.quickMessageBoxByEnum.typeEnum = {
    ContinueGoback: 1,
    DeleteGoback: 2,
    YesNo: 3,
    Ok: 4,
    RemoveGoback: 5,
    RestoreGoback: 6
};
$$WPUtil.createContinueGoBackButtons = function() {
    return [new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Continue", "Core.Utilities"),null,"completeworkflow","continue"), new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Goback", "Core.Utilities"),null,"previousstep","cancel")]
}
;
$$WPUtil.createDeleteGoBackButtons = function() {
    return [new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Delete", "Core.Utilities"),null,"inlinedelete","continue"), new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Goback", "Core.Utilities"),null,"previousstep","cancel")]
}
;
$$WPUtil.createYesNoButtons = function() {
    return [new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Yes", "Core.Utilities"),null,"completeworkflow","continue"), new $$WPComp.ComplexObjects.Button($$WP.Strings.get("No", "Core.Utilities"),null,"previousstep","cancel")]
}
;
$$WPUtil.createOkButton = function() {
    return [new $$WPComp.ComplexObjects.Button($$WP.Strings.get("MessageBoxOK", "global"),null,"otherbutton","continue")]
}
;
$$WPUtil.createRemoveGoBackButtons = function() {
    return [new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Remove", "Core.Utilities"),null,"inlinedelete","continue"), new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Goback", "Core.Utilities"),null,"previousstep","cancel")]
}
;
$$WPUtil.createRestoreGoBackButtons = function() {
    return [new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Restore", "Core.Utilities"),null,"inlinesave","continue"), new $$WPComp.ComplexObjects.Button($$WP.Strings.get("Goback", "Core.Utilities"),null,"previousstep","cancel")]
}
;
$$WPUtil.quickMessageBox = function(n, t, i, r, u, f, e) {
    $$WPUtil.IsNullOrEmpty(t) || t === HTMLUnencode(t) || $$WP.Debug.logError("$$WPUtil.quickMessageBox was probably called with an HTML formatted title. The title should be raw text, not HTML");
    var o, s = $$WP.Strings.getNamespace("Global.Confirm");
    return o = new $$WPComp.MessageComponent({
        TitleText: t || s.getStringForTemplate("GenericConfirmTitle"),
        Message: n,
        callback: r,
        CallbackArgs: u,
        ToolbarButtons: i
    }),
    $$WPUtil.quickPopup(o, {
        Size: i.length < 3 ? $$WPContain.Popup.SizeEnum.SMALL : $$WPContain.Popup.SizeEnum.MEDIUM,
        Class: f + " sm-autosizedpopup",
        HasBackButton: e
    })
}
;
$$WPUtil.generateGUID = function() {
    return $$WPUtil.generateGUID._last = $$WPUtil.generateGUID._last || 0,
    $$WPUtil.generateGUID._last++,
    $$WPUtil.generateGUID._last
}
;
$$WPUtil.generateGUID._last;
$$WPUtil.getDomain = function(n) {
    try {
        return n.protocol + "//" + n.host
    } catch (n) {
        return null
    }
}
;
$$WPUtil.canWriteCookies = function() {
    setCookie("testCookie", "testValue", !0);
    var n = "" !== getCookie("testCookie", !0);
    return n && deleteCookie("testCookie", !0),
    n
}
;
$$WPUtil.canWriteCookiesAsync = function() {
    return new Promise(function(n) {
        "function" == typeof document.requestStorageAccess ? ($$WPUtil.canWriteCookies() && n(!0),
        document.requestStorageAccess().then(function() {
            n($$WPUtil.canWriteCookies())
        }).catch(function() {
            n(!1)
        })) : n($$WPUtil.canWriteCookies())
    }
    )
}
;
$$WPUtil.cssValueToPixels = function(n) {
    return n.indexOf("rem") > -1 ? ($$WPUtil.cssValueToPixels.emSize || ($$WPUtil.cssValueToPixels.emSize = parseFloat($afe.select("body").css("font-size"))),
    Math.round(parseFloat(n, 10) * $$WPUtil.cssValueToPixels.emSize)) : n.indexOf("px") > -1 ? parseFloat(n, 10) : void (isNaN(parseFloat(n, 10)) || console.log("CSS value cannot be converted to pixels: " + n))
}
;
$$WPUtil.instantiateComponent = function(n, t, i) {
    var r = {};
    return r.SupportedComponents = n,
    r.$parent = $afe.select("#" + t),
    i && (r.ComponentProperties = i),
    new $$WPContain.HTMLTemplateContainer(r)
}
;
$$WPUtil.getPopupParent = function(n) {
    return n.parents("#main, #sidebar, #lightbox, .Popup, .direct_message, .menudetailstable.leftmenu .leftcolumn, .popupOwner, #listHolder")
}
;
$$WPUtil.positionElementNear = function(n, t) {
    var h, i, u, r, c, e, f, l, s, o, a;
    return n.removeClass("onRight onLeft onBottom onTop"),
    t.removeClass("onRight onLeft onBottom onTop"),
    i = (h = $$WPUtil.getPopupParent(t)).boxModel(!1),
    s = h[0].offsetWidth - h[0].clientWidth,
    o = 0,
    "main" !== h.safeAttr("id") && "sidebar" !== h.safeAttr("id") || (i.top += $afe.select("#header").outerHeight(),
    (a = $afe.select("#footer").outerHeight(!1)) > 0 && (i.height -= a,
    i.bottom = i.top + i.height)),
    r = n.boxModel(!1),
    f = null,
    e = null,
    400 < i.width ? t.outerWidth(400) : (t.outerWidth(i.width - 16),
    o = i.left + 8),
    u = t.boxModel(!1),
    (c = {
        toRight: i.right - r.right - s,
        toLeft: r.left - i.left,
        above: r.top - i.top,
        below: i.bottom - r.bottom
    }).toRight > u.width ? (n.addClass("onRight"),
    t.addClass("onRight"),
    f = r.right + o) : c.above > u.height ? (n.addClass("onTop"),
    t.addClass("onTop"),
    e = r.top - u.height,
    l = !0) : c.toLeft > u.width ? (n.addClass("onLeft"),
    t.addClass("onLeft"),
    f = r.left - u.width + o) : c.below > u.height && (n.addClass("onBottom"),
    t.addClass("onBottom"),
    e = r.bottom),
    null !== f ? r.bottom - u.height > i.top ? e = r.bottom - u.height + 2 : r.top + u.height < i.bottom ? (e = r.top - 2,
    t.addClass("infoPopupAlignTop")) : ((e = r.top + r.height / 2 - u.height / 2) < i.top || e > i.bottom) && (e = i.top,
    $$WP.Debug.log("Popup cannot be fit to screen")) : null !== e ? r.left + u.width + s < i.right ? f = r.left - 2 + o : r.right - u.width > i.left ? f = r.right - u.width + 2 + o : (f = r.left + r.width / 2 - u.width / 2 + o,
    i.width < u.width + f + s && (f = i.left + 8,
    t.outerWidth(i.width - 16 - s),
    l && (u = t.boxModel(!1),
    e = r.top - u.height)),
    (f < i.left || f > i.right) && (f = i.left + 8,
    t.outerWidth(i.width - 16 - s),
    l && (u = t.boxModel(!1),
    e = r.top - u.height),
    $$WP.Debug.log("Popup cannot be fit to screen"))) : ($$WP.Debug.log("Popup cannot be fit to screen"),
    n.addClass("onRight"),
    e = r.top,
    f = r.right),
    {
        top: e,
        left: f
    }
}
;
$$WPUtil.positionElementNearRTL = function(n, t) {
    var s, r, u, i, o, e, f, h, c;
    return n.removeClass("onRight onLeft onBottom onTop"),
    t.removeClass("onRight onLeft onBottom onTop"),
    r = (s = t.parents("#main, #sidebar, #lightbox, .Popup, .direct_message, .menudetailstable.leftmenu .leftcolumn, .popupOwner")).boxModel(!1),
    "main" !== s.safeAttr("id") && "sidebar" !== s.safeAttr("id") || (r.top += $afe.select("#header").outerHeight(),
    (c = $afe.select("#footer").outerHeight(!1)) > 0 && (r.height -= c,
    r.bottom = r.top + r.height)),
    i = n.boxModel(!1),
    o = {
        toRight: r.right - i.right,
        toLeft: i.left - r.left,
        above: i.top - r.top,
        below: r.bottom - i.bottom
    },
    f = null,
    e = null,
    400 < r.width ? t.outerWidth(400) : t.outerWidth(r.width),
    u = t.boxModel(!1),
    o.toLeft > u.width ? (n.addClass("onRight"),
    t.addClass("onRight"),
    f = i.right) : o.below > u.height ? (n.addClass("onBottom"),
    t.addClass("onBottom"),
    e = i.bottom) : o.toRight > u.width ? (n.addClass("onLeft"),
    t.addClass("onLeft"),
    f = i.left - u.width) : o.above > u.height && (n.addClass("onTop"),
    t.addClass("onTop"),
    e = i.top - u.height,
    h = !0),
    null !== f ? i.bottom - u.height > r.top ? e = i.bottom - u.height + 2 : i.top + u.height < r.bottom ? (e = i.top - 2,
    t.addClass("infoPopupAlignTop")) : ((e = i.top + i.height / 2 - u.height / 2) < r.top || e > r.bottom) && (e = r.top,
    $$WP.Debug.log("Popup cannot be fit to screen")) : null !== e ? i.left + u.width < r.right ? f = i.right - u.width + 2 : i.right - u.width > r.left ? f = i.left - 2 : u.width === r.width ? (t.outerWidth(r.width - 16),
    f = i.left + i.right - r.right + 8) : (f = i.left + i.width / 2 - u.width / 2,
    u.left < r.left && (f = i.left + i.right - r.right + 8,
    t.width(r.width - 32),
    h && (u = t.boxModel(!1),
    e = i.top - u.height)),
    (f < i.right - r.right + i.left || f > r.right + i.right + i.left) && (f = i.left + i.right - r.width - r.left,
    $$WP.Debug.log("Popup cannot be fit to screen"))) : ($$WP.Debug.log("Popup cannot be fit to screen"),
    n.addClass("onRight"),
    e = i.top,
    f = i.right),
    {
        top: e,
        left: f
    }
}
;
$$WPUtil.handlePopupInstructions = function(n, t) {
    var i = void 0;
    "focus" === n.type || "mouseenter" === n.type || "click" === n.type ? i = !0 : ("blur" === n.type || "mouseleave" === n.type || "keydown" === n.type && 27 === n.keyCode) && (i = !1);
    void 0 !== i && ($$WPUtil.togglePopupInstructions($afe.jq(n.target), i, t),
    n.stopPropagation())
}
;
$$WPUtil.handlePopupInstructionsKeydown = function(n, t) {
    "keydown" === n.type && 27 === n.keyCode && $afe.select("#main").find(".popupiconcontainer .popupinstructionsicon.showPopup").each(function() {
        var n = $afe.jq(this);
        $$WPUtil.togglePopupInstructions(n, !1, t)
    })
}
;
$$WPUtil.togglePopupInstructions = function(n, t, i) {
    var r, o, u, s, f, e;
    i = i || "Global";
    n.hasClass("popupiconcontainer") || (n = n.parents(".popupiconcontainer").first());
    0 !== n.length && (u = (r = n.find(".popupInstructions")).siblings(".popupinstructionsicon"),
    o = r.parents("#main, #sidebar, .Popup, .popupOwner"),
    t ? (s = "PopupHelpIconAltFull",
    u.find("img").data("altnode") && (s = u.find("img").data("altnode") + "Full"),
    u.find("img").safeAttr("alt", $$WP.Strings.get(s, i)),
    r.removeClass("hidden isblur"),
    u.addClass("showPopup"),
    o.addClass("allowOverflow"),
    "1" !== u.safeAttr("data-ispositioned") && (e = u.offset(),
    "rtl" == $afe.select("html").safeAttr("dir") ? ((f = $$WPUtil.positionElementNearRTL(u, r)).top -= e.top,
    f.left -= e.left,
    r.css({
        right: f.left + "px",
        top: f.top + "px"
    })) : ((f = $$WPUtil.positionElementNear(u, r)).top -= e.top,
    f.left -= e.left,
    r.css({
        left: f.left + "px",
        top: f.top + "px"
    })),
    r.safeAttr("data-ispositioned", "1"))) : (r.addClass("isblur"),
    window.setTimeout(function(n, t, r) {
        var u = t.find("img").data("altnode") || "PopupHelpIconAlt";
        r.hasClass("isblur") && (n.removeClass("allowOverflow"),
        r.removeClass("isblur"),
        r.addClass("hidden"),
        t.removeClass("showPopup"),
        t.find("img").safeAttr("alt", $$WP.Strings.get(u, i)))
    }, 100, o, u, r)))
}
;
$$WPUtil.handlePopupEndAnchor = function(n, t) {
    var r, i, u, f;
    t = t || "Global";
    $popupiconcontainer = (r = $afe.jq(n.target)).hasClass("popupiconcontainer") ? r : r.parents(".popupiconcontainer").first();
    0 !== $popupiconcontainer.length && (f = (i = $popupiconcontainer.find(".popupInstructions")).siblings(".popupinstructionsicon"),
    u = i.parents("#main, #sidebar, .Popup"),
    "keyup" === n.type && "Tab" === n.key && !1 === n.shiftKey ? (i.addClass("isblur"),
    window.setTimeout(function(n, i, r) {
        var u = i.find("img").data("altnode") || "PopupHelpIconAlt";
        r.hasClass("isblur") && (n.removeClass("allowOverflow"),
        r.removeClass("isblur"),
        r.addClass("hidden"),
        i.removeClass("showPopup"),
        i.find("img").safeAttr("alt", $$WP.Strings.get(u, t)))
    }, 100, u, f, i),
    WP.DOM.Search.getNextFocusable(n.target).focus()) : "keyup" === n.type && "Tab" === n.key && !0 === n.shiftKey && WP.DOM.Search.getPreviousFocusable($popupiconcontainer[0].parentNode).focus())
}
;
$$WPUtil.printHtmlClass = function(n) {
    var t;
    t = $afe.select("." + n);
    $$WPUtil.printElement(t)
}
;
$$WPUtil.printImage = function(n) {
    var t = dangerou$.parseHtml("<img src='" + n + "' style='height: 100%' />");
    $$WPUtil.printElement(t)
}
;
$$WPUtil.printElement = function(n) {
    var i, t;
    t = openWindow("", "Print", "resizable");
    i = $afe.jq(n).get(0).outerHTML;
    t.focus();
    dangerou$.setHtml(t.document.body, i);
    window.setTimeout(function(n) {
        n.print();
        n.close()
    }, 10, t)
}
;
$$WPUtil.postify = function(n) {
    var t = {}
      , i = function(n, r) {
        var u, f;
        for (u in n) {
            f = isFinite(u) ? ("" != r ? r : "") + "[" + u + "]" : ("" != r ? r + "." : "") + u;
            switch (typeof n[u]) {
            case "number":
            case "string":
            case "boolean":
                t[f] = n[u];
                break;
            case "object":
                i(n[u], "" != f ? f : u)
            }
        }
    };
    return i(n, ""),
    t
}
;
$$WPUtil.postForm = function(n, t, i) {
    var r = $afe.jq(document.createElement("form")), f, e, u;
    if (r.safeAttr("method", "post"),
    r.safeAttr("action", n),
    r.safeAttr("target", i),
    t)
        for (f = 0; f < t.length; f++)
            e = t[f],
            u = $afe.jq(document.createElement("input")),
            u.safeAttr("type", "hidden"),
            u.safeAttr("name", e.Name),
            u.safeAttr("value", e.Value),
            r.safeAppend(u);
    $afe.select("body").safeAppend(r);
    r.submit();
    $afe.select("body").remove(r)
}
;
$$WPUtil.generateRandomGUID = function() {
    for (var i = "", n = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", t = 0; t < 16; t++)
        i += n.charAt(Math.floor(Math.random() * n.length));
    return i
}
;
$$WPUtil.highlightNodeText = function(n, t) {
    var r, f, i, u, e;
    if (null !== n && null !== (r = n.childNodes) && 0 !== r.length)
        try {
            for (f = new RegExp("(" + t + ")","gi"),
            u = 0; u < r.length; u += 1)
                null !== (i = r[u]) && (3 === i.nodeType ? f.test(i.nodeValue) && (e = document.createElement("span"),
                dangerou$.setHtml(e, HTMLEncode(i.nodeValue).replace(f, '<span class="hilite">$1<\/span>')),
                n.insertBefore(e, i),
                n.removeChild(i)) : 1 === i.nodeType && $$WPUtil.highlightNodeText(i, t))
        } catch (n) {}
}
;
$$WPUtil.createAriaLabel = function(n, t) {
    var i = $afe.select("#" + n)
      , r = $afe.select("#arialabels");
    0 === i.length && (0 === r.length && (r = $afe.jq(document.body).safeAppend($$WP.SimpleTemplates.Div({
        id: "arialabels"
    }))),
    i = $$WP.SimpleTemplates.Span({
        "class": "clearlabel",
        id: n
    }, t),
    r.safeAppend(i))
}
;
$$WPUtil.addPopupListener = function(n, t) {
    null == n && (n = $afe.select("#main"));
    document.addEventListener("keydown", function(n) {
        $$WPUtil.handlePopupInstructionsKeydown(n, t)
    });
    n.find(".popupiconcontainer").each(function() {
        var n = $afe.jq(this);
        $$WPUtil.addSinglePopupListener(n, t)
    })
}
;
$$WPUtil.AddPopupListener = $$WPUtil.addPopupListener;
$$WPUtil.addSinglePopupListener = function(n, t, i) {
    n.off().hover($$WPUtil.handlePopupInstructions);
    n.find(".popupinstructionsicon").off().on("blur focus keydown click", function(n) {
        $$WPUtil.handlePopupInstructions(n, t)
    });
    n.find(".popupInstructions").off().on("blur focus keydown click", function(n) {
        $$WPUtil.handlePopupInstructions(n, t)
    });
    i && document.addEventListener("keydown", function(n) {
        $$WPUtil.handlePopupInstructionsKeydown(n, t)
    })
}
;
$$WPUtil.removePopupListener = function(n) {
    null == n && (n = $afe.jq("#main"));
    var t = n.find(".popupiconcontainer");
    t.off();
    t.find(".popupinstructionsicon").off();
    t.find(".popupInstructions").off()
}
;
$$WPUtil.isValidPhoneNumber = function(n) {
    return new RegExp(/^\+?\d{6,13}((x|X)?\d{4})?$/).test(n)
}
;
$$WPUtil.PrintAndAuditNET = function() {
    window.print();
    $.ajax({
        url: makeLink("Home/AuditPrint"),
        type: "POST",
        data: {
            title: document.title
        }
    })
}
;
$$WPUtil.clearAlertCache = function() {}
;
$$WPUtil.logoutAndShowError = function(n) {
    $$WP.Utilities.TryRedirect(makeLink("Home/Logout?error=" + n))
}
;
$$WPUtil.regExEscapeString = function(n) {
    var i, t;
    if ("string" != typeof n)
        return "";
    for (i = "",
    t = 0; t < n.length; t++)
        i += "\\u" + ("0000" + n.charCodeAt(t).toString(16)).substr(-4);
    return i
}
;
$$WPUtil.IsSupportedChars = function(n) {
    return new RegExp(/^[\x09\x0A\x0D\x20-\x7E\xA0-\xFF\u0152\u0153\u0160\u0161\u0178\u017D\u017E\u0192\u02C6\u02DC\u2013\u2014\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2026\u2030\u2039\u203A\u20AC\u2122]*$/).test(n)
}
;
$$WPUtil.RemoveUnsupportedChars = function(n) {
    return n.split("").filter($$WPUtil.IsSupportedChars).join("")
}
;
$$WPUtil.IsH2GActivity = function(n) {
    return !!$$WPUtil.IsVisitsListUrl(n) || !!$$WPUtil.IsTestResultsUrl(n) || !!$$WPUtil.IsMedsListUrl(n) || !!$$WPUtil.IsAllergiesListUrl(n) || !!$$WPUtil.IsHealthIssuesUrl(n)
}
;
$$WPUtil.IsVisitsListUrl = function(n) {
    return -1 !== (n = n.toLowerCase()).indexOf("visits/visitslist") || -1 !== n.indexOf("mode=appointments") || -1 !== n.indexOf("mode=visits") || -1 !== n.indexOf("mode=recentappts")
}
;
$$WPUtil.IsTestResultsUrl = function(n) {
    return -1 !== (n = n.toLowerCase()).indexOf("clinical/testresults") || -1 !== n.indexOf("mode=labs")
}
;
$$WPUtil.IsMedsListUrl = function(n) {
    return -1 !== (n = n.toLowerCase()).indexOf("clinical/medications/list") || -1 !== n.indexOf("mode=medslist")
}
;
$$WPUtil.IsAllergiesListUrl = function(n) {
    return -1 !== (n = n.toLowerCase()).indexOf("clinical/allergies") || -1 !== n.indexOf("mode=allergies")
}
;
$$WPUtil.IsHealthIssuesUrl = function(n) {
    return -1 !== (n = n.toLowerCase()).indexOf("clinical/healthissues") || -1 !== n.indexOf("mode=hlthissues")
}
;
$$WPUtil.IsHealthSummaryUrl = function(n) {
    return -1 !== (n = n.toLowerCase()).indexOf("mode=snapshot")
}
;
$$WPUtil.defaultAjaxErrorHandler = function(n, t, i) {
    var e, u, r, f;
    if (!0 !== $$WP.IsEpicAjaxErrorHandlerDisabled)
        if (i.suppressEpicDefaultAjaxErrorHandler || i.hasOwnErrorHandler || 200 === t.status)
            $$WP.Debug.IsEnabled && $$WP.Debug.logError("Ajax call to " + i.url + " received an error response and has the default error handler suppressed.", !0);
        else if ("abort" === t.statusText || "canceled" === t.statusText || function(n) {
            return 0 === n.status && !n.getAllResponseHeaders()
        }(t))
            $$WP.Debug.log(t.statusText + " ajax call to " + i.url + ".", !0);
        else if (!i.hasOwnErrorHandler) {
            if (WP.Events.cancelBeforeUnload(),
            !$$WP.Debug.IsEnabled && ($afe.select("#content").children().addClass("hidden"),
            $$WP.Utilities.UI.IsMobile))
                return void (window.location.href = makeLink("500.aspx"));
            if (0 !== $afe.select(".AjaxErrorHandler.Popup").length)
                return;
            f = $$WPContain.Popup.SizeEnum.SMALL;
            $$WP.Debug.IsEnabled && void 0 !== t.responseText ? (u = (r = (r = t.responseText).substring(r.indexOf("<body"), r.indexOf("<\/body"))).substring(r.indexOf(">") + 1, r.length),
            f = $$WPContain.Popup.SizeEnum.LARGE) : u = $$WP.Strings.get("DefaultAjaxErrorHandlerMessage", "global");
            e = new $$WPComp.MessageComponent({
                TitleText: $$WP.Strings.get("DefaultAjaxErrorHandlerTitle", "global"),
                Message: u,
                ToolbarButtons: [new $$WPComp.ComplexObjects.Button($$WP.Strings.get("ClosePopupButton", "Core.Utilities"),null,"cancelworkflow")]
            });
            $$WPUtil.quickPopup(e, {
                Size: f,
                positioningFunction: $$WPContain.Positions.InsideNearTop,
                HasBackButton: !1,
                Class: "AjaxErrorHandler"
            });
            $afe.select("#content").removeAttr("id");
            $afe.select(".messageComponent").find("#content").removeAttr("id")
        }
}
;
$$WPUtil.isLocalStorageAvailable = function() {
    var n = "test";
    try {
        window.localStorage.setItem(n, n);
        window.localStorage.removeItem(n)
    } catch (n) {
        return !1
    }
    return !0
}
;
$$WPUtil.UseHTML5InputControls = function() {
    $$WP.Utilities.isBrowserCapableOf("input", {
        type: "number"
    }) && $afe.select("input[data-inputtype='number']").each(function() {
        this.type = "number"
    });
    $$WP.Utilities.isBrowserCapableOf("input", {
        type: "phone"
    }) && $afe.select("input[data-inputtype='phone']").each(function() {
        this.type = "phone"
    });
    $$WP.Utilities.isBrowserCapableOf("input", {
        type: "email"
    }) && $afe.select("input[data-inputtype='email']").each(function() {
        this.type = "email"
    });
    $$WP.Utilities.isBrowserCapableOf("input", {
        type: "date"
    }) && $afe.select("input[data-inputtype='date']").each(function() {
        this.type = "date"
    });
    $$WP.Utilities.isBrowserCapableOf("input", {
        type: "time"
    }) && $afe.select("input[data-inputtype='time']").each(function() {
        this.type = "time"
    })
}
;
$$WPUtil.FixScrollingForIOS = function(n) {
    n.on("blur", "input, textarea", function() {
        window.scrollBy(0, 0)
    })
}
;
$$WPUtil.ShowAjaxSpinner = function(n, t) {
    if (null !== n) {
        if (n.length > 1 && $$WP.Debug.logError("Multiple ajax spinners passed to ShowAjaxSpinner"),
        !0 !== t && n.removeClass("hidden"),
        !n.hasClass("hidden")) {
            var i = n.contents();
            n.empty();
            n.safeAppend(i)
        }
        !0 !== t && setTimeout(function(n) {
            $$WPUtil.ShowAjaxSpinner(n, !0)
        }, 1500, n)
    }
}
;
$$WPUtil.HideAjaxSpinner = function(n) {
    n.addClass("hidden")
}
;
$$WPUtil.GetRawString = function(n) {
    return n && !$$WPUtil.IsNullOrEmpty(n.string) ? n.string : "string" == typeof n ? n : ""
}
;
$$WPUtil.GetQueryStringParameterValue = function(n, t) {
    var i;
    return null === (i = new RegExp("[?&]" + t + "=([^&#]*)").exec(n)) ? "" : decodeURIComponent(i[1])
}
;
$$WPUtil.GetTextareaBucketClass = function(n) {
    if (n < 1)
        return "";
    var t = n - 1 - (n - 1) % 25 + 25;
    return t > 300 && (t = "unlimited"),
    "textbucket" + t + "chars"
}
;
$$WPUtil.AddSingleLineTextareaListeners = function() {
    $afe.select(".singleLineFreeText").each(function() {
        this.addEventListener("keydown", function(n) {
            13 === (n.which || n.keyCode) && n.preventDefault()
        });
        this.addEventListener("input", function(n) {
            n.target.value = n.target.value.replace(/\n/g, "")
        })
    })
}
;
$$WPUtil.SetCrossDomainData = function(n) {
    window.parent.postMessage({
        method: "setValues",
        data: n
    }, $$WP.ParentDomain)
}
;
$$WPUtil.DeleteCrossDomainData = function(n) {
    window.parent.postMessage({
        method: "deleteLocalStorageValue",
        key: n
    }, $$WP.ParentDomain)
}
;
$$WPUtil.GetCrossDomainData = function(n) {
    return new Promise(function(t) {
        var i = new MessageChannel;
        i.port1.onmessage = function(n) {
            t(n.data)
        }
        ;
        window.parent.postMessage({
            method: "getValue",
            key: n
        }, $$WP.ParentDomain, [i.port2])
    }
    )
}
;
$$WPUtil.GetIframeWidth = function() {
    return new Promise(function(n) {
        var t = new MessageChannel;
        t.port1.onmessage = function(t) {
            n(t.data)
        }
        ;
        window.parent.postMessage({
            method: "getWidth",
            id: $$WP.WidgetID
        }, $$WP.ParentDomain, [t.port2])
    }
    )
}
;
$$WPUtil.SetCrossDomainIframeHeight = function(n) {
    window.parent.postMessage({
        method: "setHeight",
        height: n,
        id: $$WP.WidgetID
    }, $$WP.ParentDomain)
}
;
$$WPUtil.SetCrossDomainIframeMinHeight = function(n) {
    window.parent.postMessage({
        method: "setMinHeight",
        height: n,
        id: $$WP.WidgetID
    }, $$WP.ParentDomain)
}
;
$$WPUtil.ScrollTopOfTheIframeCrossDomain = function() {
    window.parent.postMessage({
        method: "scrollTopOfTheIframe",
        id: $$WP.WidgetID
    }, $$WP.ParentDomain)
}
;
$$WPUtil.RefreshHeader = function() {
    var n = function() {
        alert($$WP.Strings.get("WidgetRefreshAlert", "Global")) || window.location.reload()
    };
    $$WP.WidgetMode && $.ajax({
        url: makeLink("Widget/RefreshHeader"),
        type: "GET",
        success: function(t) {
            t.headerValue ? $$WP._WidgetToken = t.headerValue : n()
        },
        error: n
    })
}
;
$$WPUtil.GetPageNonce = function() {
    var n = document.getElementById("cspScripts");
    return n ? n.nonce || n.getAttribute("nonce") : ""
}
;
$$WPUtil.LogTabClick = function(n, t) {
    !n || t <= 0 || getCSRFTokenAsQS(function() {
        $.ajax({
            url: makeLink("Home/LogTabClick"),
            type: "POST",
            data: {
                idnId: n,
                count: t
            }
        })
    })
}
;
$$WPUtil.SendBeacon = function(n, t, i, r) {
    return i = void 0 === i || i,
    void 0 === r && "string" != typeof t && i ? ($$WP.Debug.logError("contentType must be specified when calling SendBeacon with data that is not a string."),
    !1) : (r = void 0 !== r ? r : "text/plain;charset=UTF-8",
    navigator.sendBeacon ? navigator.sendBeacon(n, t) : !!i && ($.ajax({
        url: n,
        method: "POST",
        data: t,
        contentType: r
    }),
    !0))
}
;
Epic = Epic || {};
Epic.PatientAccess = Epic.PatientAccess || {};
$$WP = $$WP || Epic.PatientAccess;
$$WP.Settings = $$WP.Settings || {};
$$WP.Settings.ScriptPath = "Scripts/";
console = console || {
    error: function() {},
    log: function() {},
    warn: function() {}
};
!function() {
    var n = function(n) {
        var t;
        if ("object" !== $.type(n))
            return !1;
        if (n instanceof this)
            return !0;
        if ("function" == typeof n._constructor && Array.isArray(n._constructors)) {
            if (n._constructor === this)
                return !0;
            for (t = 0; t < n._constructors.length; t++)
                if (n._constructors[t] === this)
                    return !0
        }
        return !1
    };
    Function.prototype.extend = function(t, i) {
        var u, r, e, s, o, h, c, f;
        if ("function" == typeof t && "object" === $.type(t.prototype)) {
            if (e = (r = t)._className,
            c = i,
            "function" != typeof r || "object" !== $.type(r.prototype))
                return void console.error("Provided parent class was not a valid class. Cannot perform inheritance.")
        } else {
            for (r = i || $$WP,
            s = t.split("."),
            e = t.replace(/\./g, "$"),
            o = 0; o < s.length; o++) {
                if ("object" !== $.type(r)) {
                    r = null;
                    break
                }
                r = r[s[o]]
            }
            if ("function" != typeof r || "object" !== $.type(r.prototype))
                return void console.error("Did not find a class named " + t + " in the given root namespace. Cannot perform inheritance.")
        }
        for (u in this._inheritedMethods = {},
        this.prototype[e] = r,
        this._inheritedMethods[e] = !0,
        this._className = c,
        h = {
            _constructor: !0,
            _constructors: !0
        },
        r.prototype)
            "string" != typeof u || h[u] || (f = r.prototype[u],
            "function" == typeof r.prototype[u] && (r._inheritedMethods[u] ? (this.prototype[u] = f,
            this._inheritedMethods[u] = !0) : (this.prototype[e + "$" + u] = f,
            this._inheritedMethods[e + "$" + u] = !0)),
            void 0 === this.prototype[u] && (this.prototype[u] = "object" !== $.type(f) || f instanceof jQuery || Array.isArray(f) ? f : $$WP.Utilities.copyObject(f)));
        this.prototype._constructor = this;
        this.prototype._constructors = $$WP.Utilities.copyObject(r.prototype._constructors);
        this.prototype._constructors.push(r);
        this.isInstance = n
    }
    ;
    $$WP.BaseObject = function() {}
    ;
    $$WP.BaseObject._className = "WP$BaseObject";
    $$WP.BaseObject._inheritedMethods = {};
    $$WP.BaseObject.prototype = {
        _constructor: $$WP.BaseObject,
        _constructors: []
    }
}();
window.onerror = function(n, t, i, r, u) {
    var f;
    if (f = n ? '"' + n + '"' : "unhandled exception",
    u && u.stack)
        try {
            WP && WP.DOM && WP.DOM.Browser.isIE || WP.DOM.Browser.isLegacyEdge ? (console.groupCollapsed("Stack Trace for " + f),
            console.error(u.stack),
            console.groupEnd()) : (console.groupCollapsed("Stack Trace for " + f, ""),
            console.error(u.message),
            console.groupEnd());
            $$WP.Debug._errorCount++;
            $$WP.Debug._updateErrorCountDisplay()
        } catch (n) {}
}
;
$$WP = $$WP || {};
$$WP.Utilities = $$WP.Utilities || {};
$$WP.Utilities.UI = $$WP.Utilities.UI || {};
$$WP.Utilities.UI.OnUIFrameworkLoaded && $$WP.Utilities.UI.OnUIFrameworkLoaded(function() {
    !$$WP.Utilities.UI.IsMobile && $$WP.Debug.CheckForStringResources && $.ajax({
        url: makeLink("/Tests/CheckStringResources"),
        dataType: "json",
        global: !1,
        error: function() {
            $$WP.Debug.log("Debug: Couldn't check for missing string resources. /Tests/CheckStringResources is not available.")
        },
        success: function(n) {
            var i, r, t = "";
            if (!n.IsSuccess) {
                if (t += '<div id="missingStringsWarning">',
                t += '<p>Incorrect strings detected in .resx files!!! <a href="#" data-function="dismiss">[X]<\/a><\/p>',
                t += '<p><a href="#" data-function="toggleDetails">[+/- details]<\/a><\/p>',
                t += '<div data-contents="details" class="jqHidden">',
                n.MissingStrings && n.MissingStrings.length > 0)
                    for (t += "~ MISSING ~<br/>",
                    i = 0; i < n.MissingStrings.length; i++)
                        t += n.MissingStrings[i] + "<br/>";
                if (n.ModifiedStrings && n.ModifiedStrings.length > 0)
                    for (t += "~ MODIFIED ~<br/>",
                    i = 0; i < n.ModifiedStrings.length; i++)
                        t += n.ModifiedStrings[i] + "<br/>";
                if (n.ExtraStrings && n.ExtraStrings.length > 0)
                    for (t += "~ UNUSED ~<br/>",
                    i = 0; i < n.ExtraStrings.length; i++)
                        t += n.ExtraStrings[i] + "<br/>";
                t += "<\/div>";
                t += "<\/div>";
                (r = dangerou$.parseHtml(t)).on("click", '[data-function="toggleDetails"]', function(n) {
                    n.preventDefault();
                    n.stopPropagation();
                    r.find('[data-contents="details"]').toggle()
                });
                r.on("click", '[data-function="dismiss"]', function(n) {
                    n.preventDefault();
                    n.stopPropagation();
                    r.remove()
                });
                $afe.select("body").safeAppend(r)
            }
        }
    })
});
$$WP = $$WP || {};
$$WP.Debug = $$WP.Debug || {};
$$WP.Debug.UI = $$WP.Debug.UI || {};
$$WP.Debug.UnitTest = $$WP.Debug.UnitTest || {};
$$WP.Debug.UnitTest.tests = $$WP.Debug.UnitTest.tests || [];
$$WP.Debug._failedAssertions = 0;
$$WP.Debug._assertions = 0;
$$WP.Debug._errorCount = 0;
$$WP.Debug._$errorCountDisplay = null;
$$WP.Debug.log = function(n, t) {
    var i;
    if (n = n || "",
    $$WP.Debug.IsEnabled)
        try {
            i = new Error(n);
            t && console.trace ? (console.groupCollapsed($$WP.Debug.messagePrefix + n),
            console.trace(),
            console.groupEnd()) : t && "stack"in i ? (console.groupCollapsed($$WP.Debug.messagePrefix + n),
            console.log(i.stack),
            console.groupEnd()) : console.log($$WP.Debug.messagePrefix + n)
        } catch (n) {}
}
;
$$WP.Debug.logError = function(n, t) {
    var r, i;
    if (n = n || "",
    "boolean" != typeof t && (t = !0),
    t) {
        try {
            WP && WP.DOM && WP.DOM.Browser.isIE || WP.DOM.Browser.isLegacyEdge ? (console.groupCollapsed($$WP.Debug.messagePrefix + n),
            console.trace(),
            console.groupEnd()) : console.error($$WP.Debug.messagePrefix + n, "");
            i = !0
        } catch (t) {
            try {
                (r = new Error(n)).stack.length > 0 && (console.groupCollapsed($$WP.Debug.messagePrefix + n),
                console.error(r.stack, ""),
                console.groupEnd(),
                i = !0)
            } catch (n) {}
        }
        if (!i)
            try {
                console.error($$WP.Debug.messagePrefix + n, "")
            } catch (n) {}
    } else
        try {
            console.error($$WP.Debug.messagePrefix + n, "")
        } catch (n) {}
    $$WP.Debug._errorCount++;
    $$WP.Debug._updateErrorCountDisplay()
}
;
$$WP.Debug._updateErrorCountDisplay = function() {
    $$WP.Debug.IsEnabled && (null === $$WP.Debug._$errorCountDisplay && ($$WP.Debug._$errorCountDisplay = $afe.jq(document.createElement("div")),
    $$WP.Debug._$errorCountDisplay.css({
        position: "absolute",
        "background-color": "red",
        color: "white",
        "font-weight": "bold",
        width: "auto",
        padding: "1px",
        "margin-left": "2px",
        "z-index": "100"
    }),
    $afe.select("#header").safePrepend($$WP.Debug._$errorCountDisplay)),
    $$WP.Debug._$errorCountDisplay.empty(),
    $$WP.Debug._$errorCountDisplay.text("Errors in console: " + $$WP.Debug._errorCount))
}
;
$$WP.Debug.ShowNonProdBanner = function() {
    if ("true" !== sessionStorage.HideNonProdBanner) {
        var t, n = "";
        n += '<div id="nonProdBanner">';
        n += "<strong><span>" + $$WP.Strings.get("NonProdErrorMessage", "global") + '&nbsp;<a href="#" data-function="dismiss" title="' + $$WP.Strings.get("NonProdErrorMessageDismissTitle", "global") + '">[X]<\/a><\/span><\/strong>';
        n += "<\/div>";
        (t = dangerou$.parseHtml(n)).on("click", '[data-function="dismiss"]', function(n) {
            sessionStorage.setItem("HideNonProdBanner", "true");
            n.preventDefault();
            n.stopPropagation();
            $$WP.Debug.RemoveBanner(t)
        });
        $$WP.Debug.AddBanner(t)
    }
}
;
$$WP.Debug.ShowAdminElevationBanner = function() {
    var t, i, n, r;
    t = $$WP.Strings.get("AdminBannerText", "global");
    i = $$WP.Strings.get("AdminBannerAction", "global");
    n = '<div class="adminElevationBanner" id="adminElevationBanner">';
    n += "<strong><span>" + t + '&nbsp;[<a href="#"  data-function="endsession" ';
    n += 'title="' + $$WP.Strings.get("AdminBannerActionTitle", "global") + '">' + i + "<\/a>]<\/span><\/strong ><\/div >";
    (r = dangerou$.parseHtml(n)).on("click", '[data-function="endsession"]', $$WP.Debug.PromptToEndElevatedSession);
    $$WP.Debug.AddBanner(r)
}
;
$$WP.Debug.PromptToEndElevatedSession = function() {
    var n, t;
    n = {
        ToolbarButtons: [{
            Text: $$WP.Strings.get("AdminPopupConfirmButtonText", "global"),
            Class: "completeworkflow"
        }, {
            Text: $$WP.Strings.get("AdminPopupCancelButtonText", "gloal"),
            Class: "cancelworkflow"
        }],
        TitleText: $$WP.Strings.get("AdminPopupTitleText", "global"),
        Html: $$WP.Strings.get("AdminPopupMessageText", "global"),
        IsClosable: !0,
        callback: function(n) {
            n && ($$WP.Debug.ClearClipboard(),
            this.dispose(!0),
            window.location.href = makeLink("/Authentication/ServerAdmin/ClearElevation"))
        }
    };
    t = new $$WPComp.ConfirmComponent(n,{
        Size: $$WPContain.Popup.SizeEnum.SMALL
    });
    $$WPUtil.quickPopup(t)
}
;
$$WP.Debug.ClearClipboard = function() {
    var n;
    n = dangerou$.parseHtml('<input id="clearClipboard" type="text" id="clearText" value=" " />');
    $afe.select("body").safePrepend(n);
    n.select();
    document.execCommand("copy");
    n.remove()
}
;
$$WP.Debug.AddBanner = function(n) {
    $$WP.Debug.CreateBannerContainer();
    setTimeout(function() {
        $afe.select("#sitebanner").safePrepend(n);
        $$WP.Debug.UpdateTopMarginForBanners()
    }, 100)
}
;
$$WP.Debug.RemoveBanner = function(n) {
    $afe.select("#sitebanner").safeAttr("role", "");
    n.remove();
    $afe.select("#sitebanner").safeAttr("role", "alert");
    $$WP.Debug.UpdateTopMarginForBanners()
}
;
$$WP.Debug.UpdateTopMarginForBanners = function() {
    var i = $afe.select("#wrap")
      , r = $afe.select("#header")
      , u = $afe.select("#content")
      , n = $afe.select(".titlebar")
      , t = $afe.select(".Popup");
    $$WP.Debug.UpdateTopMarginForBanner(i);
    $$WP.Debug.UpdateTopMarginForBanner(t);
    $$WP.Utilities.UI.IsLoggedIn && ($$WP.Debug.UpdateTopMarginForBanner(r),
    $$WP.Debug.UpdateTopMarginForBanner(u));
    $afe.jq(document).width() < 1300 && !t ? $$WP.Debug.UpdateTopMarginForBanner(n) : 0 !== n.length && n.css("margin-top", 0)
}
;
$$WP.Debug.UpdateTopMarginForBanner = function(n) {
    var t = $afe.select("#sitebanner").height();
    0 !== n.length && n.css("margin-top", t)
}
;
$$WP.Debug.CreateBannerContainer = function() {
    if (0 === $afe.select("#sitebanner").length) {
        var n;
        n = dangerou$.parseHtml('<div id="sitebanner" class="sitebanners" role="alert"><\/div>');
        $afe.select("body").safePrepend(n)
    }
}
;
$$WP.Debug._synchronousAjax = function(n, t) {
    var i;
    (i = (i = "object" == typeof n ? n : t) || {}).async = !1;
    $$WP.Debug._oldAjax(n, i)
}
;
$$WP.Debug.makeAjaxSynchronous = function() {
    if ($$WP.Debug.IsEnabled) {
        if ($.ajax === $$WP.Debug._synchronousAjax)
            return;
        $$WP.Debug._oldAjax = $$WP.Debug._oldAjax || $.ajax || jQuery.ajax;
        $.ajax = $$WP.Debug._synchronousAjax
    }
}
;
$$WP.Debug.allowAjaxAsynchronous = function() {
    $.ajax === $$WP.Debug._synchronousAjax && ($.ajax = $$WP.Debug._oldAjax)
}
;
$$WP.Debug.UnitTest.assert = function(n, t) {
    $$WP.Debug._assertions++;
    n || ($$WP.Debug._failedAssertions++,
    $$WP.Debug.logError(t, !1))
}
;
$$WP.Debug.UnitTest.assertValue = function(n, t, i) {
    $$WP.Debug.UnitTest.assert(n === t, i + "(expected '" + n + "', got '" + t + "')")
}
;
$$WP.Debug.UnitTest.cssClassesMatch = function(n, t) {
    var i, r;
    if (i = n.safeAttr("class").split(" "),
    (t = t.split(" ")).length !== i.length)
        return !1;
    for (i.sort(),
    t.sort(),
    r = 0; r < i.length; r++)
        if (i[r] !== t[r])
            return !1;
    return !0
}
;
$$WP.Debug.UnitTest.resetCounters = function() {
    $$WP.Debug._failedAssertions = 0;
    $$WP.Debug._assertions = 0
}
;
$$WP.Debug.UnitTest.getFailedAssertionCount = function() {
    return $$WP.Debug._failedAssertions
}
;
$$WP.Debug.UnitTest.runAll = function(n) {
    var t, f, i, e, h, a, o, s, r, u, c, l;
    if ($$WP.Debug.IsEnabled)
        for (n = n || $afe.select("body"),
        l = $$WP.SimpleTemplates.WarningIcon({
            "class": "testWarning"
        }),
        0 !== (t = $afe.select("#WP-Debug-UnitTest-TestingRange")).length ? ((f = t.find('table[name="resultsTable"]')).empty(),
        (i = t.find('div[name="sandbox"]')).empty()) : (t = $$WP.SimpleTemplates.Div({
            id: "WP-Debug-UnitTest-TestingRange"
        }),
        f = dangerou$.parseHtml('<table name="resultsTable"><tr><th class="testName">Test name<\/th><th class=""testResult>Result<\/th><\/tr><\/table>'),
        i = $$WP.SimpleTemplates.Div({
            name: "sandbox"
        }),
        n.safeAppend(t),
        t.safeAppend(f),
        t.safeAppend(i)),
        e = 0; e < $$WP.Debug.UnitTest.tests.length; e++) {
            h = $$WP.Debug.UnitTest.tests[e];
            $$WP.Debug.UnitTest.resetCounters();
            c = !1;
            try {
                h(i)
            } catch (n) {
                $$WP.Debug.log(n.stack);
                c = !0
            }
            s = $$WP.Debug.UnitTest.getFailedAssertionCount();
            r = $$WP.Debug._assertions;
            c ? ($$WP.Debug.log("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX Test Failed XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"),
            u = dangerou$.parseHtml('<td class="testResult exceptionThrown">' + l[0].outerHTML + " Test failed " + s + " of " + r + " checks. Did not run the entire test due to an unhandled exception.<br/>See console for more details<\/td>")) : s > 0 ? ($$WP.Debug.log("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX Test Failed XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"),
            u = dangerou$.parseHtml('<td class="testResult failedAssertion">' + l[0].outerHTML + " Test failed " + s + " of " + r + " checks. See console for more details.<\/td>")) : 0 === r ? ($$WP.Debug.log("No test cases defined for this module."),
            u = dangerou$.parseHtml('<td class="testResult noAssertion">No test cases defined for this module.<\/td>')) : u = dangerou$.parseHtml('<td class="testResult passed">Test passed all ' + r + " checks<\/td>");
            i.empty();
            o = dangerou$.parseHtml("<tr><\/tr>");
            a = h.name || "Test";
            o.safeAppend(dangerou$.parseHtml('<td class="testName">' + a.replace(/UnitTests\$/, "") + "<\/td>"));
            o.safeAppend(u);
            f.safeAppend(o)
        }
}
,
function() {
    var n = {}
      , t = function() {};
    t.prototype = {
        addMonitor: function(t, i) {
            $$WP.Debug.IsEnabled && (n[t] = i)
        },
        getWorkflow: function(t) {
            if ($$WP.Debug.IsEnabled && n[t])
                return n[t]
        },
        removeMonitor: function(t) {
            $$WP.Debug.IsEnabled && delete n[t]
        }
    };
    $$WP.Debug.Workflow = $$WP.Debug.Workflow || new t
}();
!function() {
    $$WP.I18N = $$WP.I18N || {
        DateFormat: null,
        TimeFormat: null,
        TimeSeparator: null,
        AmDesignator: null,
        PmDesignator: null,
        Days: [],
        Months: [],
        DecimalSeparator: null,
        GroupSeparator: null,
        RangeSeparator: null,
        NegativePattern: null,
        CenturyRollover: 15,
        BirthdayRollOver: 0
    };
    $$WP.I18N.getMyChartLocale = function() {
        return $$WP.I18N.Identifier
    }
    ;
    $$WP.I18N.getDateFormatForDisplay = function() {
        return this.DateFormat.toLowerCase().replace(/m+/g, $$WP.Strings.get("MM", "Core.FormValidation")).replace(/d+/g, $$WP.Strings.get("DD", "Core.FormValidation")).replace(/y+/g, $$WP.Strings.get("YYYY", "Core.FormValidation"))
    }
    ;
    $$WP.I18N.getTimeFormatForDisplay = function() {
        return this.TimeFormat.toLowerCase().replace(/h+/g, $$WP.Strings.get("HH", "Core.FormValidation")).replace(/m+/g, $$WP.Strings.get("MI", "Core.FormValidation")).replace(/t+/g, $$WP.Strings.get("TT", "Core.FormValidation"))
    }
    ;
    $$WP.I18N.getOrderedDatePieces = function(n, t, i) {
        var u = $$WP.I18N.DateFormat.toLowerCase(), r;
        return n && u.replace(/y+/, ""),
        r = {},
        i || (r.d = u.indexOf("d")),
        t || (r.m = u.indexOf("m")),
        n || (r.y = u.indexOf("y")),
        Object.keys(r).sort(function(n, t) {
            return r[n] - r[t]
        })
    }
    ;
    $$WP.I18N.formatPatientGivenDate = function(n, t) {
        var i, r;
        return n instanceof Date ? (void 0 === t && (t = !1),
        r = $$WP.I18N.DateFormat.toLowerCase(),
        (i = {
            dayOfMonth: t ? n.getDate() : n.getUTCDate(),
            month: (t ? n.getMonth() : n.getUTCMonth()) + 1,
            year: ("0000" + (t ? n.getFullYear() : n.getUTCFullYear())).substr(-4)
        }).dayOfMonth < 10 && r.indexOf("dd") > -1 && (i.dayOfMonth = "0" + i.dayOfMonth),
        i.month < 10 && r.indexOf("mm") > -1 && (i.month = "0" + i.month),
        -1 === r.indexOf("yyyy") && (i.year = (i.year + "").substring(2, 4)),
        r.replace(/d+/, i.dayOfMonth).replace(/m+/, i.month).replace(/y+/, i.year)) : ""
    }
    ;
    $$WP.I18N.parseDate = function(n, t) {
        var i = new $$WP.I18N.Date(n,"",t);
        return i.isSpilledOver() ? null : i.DateObject
    }
    ;
    $$WP.I18N.ISOUTCToLocaleDateTime = function(n, t) {
        var i, r;
        return $$WP.Utilities.IsNullOrEmpty(t) && (t = (new Intl.DateTimeFormat).resolvedOptions().timeZone),
        r = new Date(n),
        i = $$WP.I18N.getMyChartLocale(),
        r.toLocaleString(i, {
            timeZone: t,
            timeZoneName: "short"
        })
    }
    ;
    $$WP.I18N.formatPatientGivenTime = function(n, t) {
        var i, r, u;
        return n instanceof Date ? (void 0 === t && (t = !1),
        u = (r = $$WP.I18N.TimeFormat.toLowerCase()).indexOf("t") > -1,
        i = {
            hour: t ? n.getHours() : n.getUTCHours(),
            minute: t ? n.getMinutes() : n.getUTCMinutes(),
            amPm: ""
        },
        u && (i.hour >= 12 ? (i.amPm = $$WP.I18N.PmDesignator,
        i.hour > 12 && (i.hour = i.hour - 12)) : (i.amPm = $$WP.I18N.AmDesignator,
        0 === i.hour && (i.hour = 12))),
        r.indexOf("hh") > -1 && i.hour < 10 && (i.hour = "0" + i.hour),
        i.minute < 10 && (i.minute = "0" + i.minute),
        r.replace(/h+/, i.hour.toString()).replace(/m+/, i.minute.toString()).replace(/t+/, i.amPm)) : ""
    }
    ;
    $$WP.I18N.parseTime = function(n) {
        var t, r, i, u, f, e;
        if ("string" != typeof n || (n = n.toLocaleLowerCase().replace(/\s/g, ""),
        f = $$WP.I18N.AmDesignator.toLocaleLowerCase().replace(/[^a-zA-Z]/g, ""),
        e = $$WP.I18N.PmDesignator.toLocaleLowerCase().replace(/[^a-zA-Z]/g, ""),
        null === (t = n.match(new RegExp("(?:[a-z].? ?)+|[0-9]{1,2}","g"))) || 1 !== t.length && 2 !== t.length && 3 !== t.length))
            return null;
        for (r = 0; r < t.length; r++)
            if (0 === t[r].length)
                return null;
        return 2 !== t.length && 3 !== t.length || !isNaN(Number(t[0])) && !isNaN(Number(t[1])) && 2 === t[0].length && 1 === t[1].length && n.indexOf(t[0] + "" + t[1]) > -1 && (t[1] = t[0].charAt(1) + "" + t[1],
        t[0] = t[0].charAt(0)),
        null === (i = this._validateHours(t[0])) ? null : 1 === t.length ? this._buildTime(i, 0) : 2 === t.length ? (t[1] = t[1].replace(/[^a-zA-Z0-9]/g, ""),
        t[1] !== f.substring(0, t[1].length) && t[1] !== e.substring(0, t[1].length) ? null === (u = this._validateMinutes(t[1])) ? null : this._buildTime(i, u) : this._buildTime(i, 0, t[1], f, e)) : null === (u = this._validateMinutes(t[1])) ? null : (t[2] = t[2].replace(/[^a-zA-Z0-9]/g, ""),
        this._buildTime(i, u, t[2], f, e))
    }
    ;
    $$WP.I18N._validateHours = function(n) {
        var t = Number(n);
        return isNaN(t) || t < 0 || t > 23 ? null : t
    }
    ;
    $$WP.I18N._validateMinutes = function(n) {
        var t;
        return 2 !== n.length ? null : (t = Number(n),
        isNaN(t) || t < 0 || t > 59 ? null : t)
    }
    ;
    $$WP.I18N._accountForAmPm = function(n, t, i, r) {
        if (n < 1 || n > 12)
            return null;
        if (t === i.substring(0, t.length))
            12 === n && (n = 0);
        else {
            if (t !== r.substring(0, t.length))
                return null;
            12 !== n && (n += 12)
        }
        return n
    }
    ;
    $$WP.I18N._buildTime = function(n, t, i, r, u) {
        var f;
        return i && null === (n = this._accountForAmPm(n, i, r, u)) ? null : ((f = new Date(0)).setUTCHours(n),
        f.setUTCMinutes(t),
        f)
    }
    ;
    $$WP.I18N.parse24HrTime = function(n) {
        var t, i, r;
        return RegExp("^[0-9]{1,2}:{1}[0-9]{2}$").test(n) ? (t = n.split(":"),
        null === (i = $$WP.I18N._validateHours(t[0])) || null === (r = $$WP.I18N._validateMinutes(t[1])) ? null : $$WP.I18N._buildTime(i, r)) : null
    }
    ;
    $$WP.I18N.formatNumber = function(n, t, i) {
        var u, s, r, c, h, e, f, o;
        return "number" != typeof n ? "" : (t = t || 0,
        s = Math.abs(n),
        r = Math.floor(s),
        o = s.toString().length - r.toString().length - 1,
        i && (o = t),
        o < 0 && (o = 0),
        h = (c = $$WP.I18N.Round(s - r, o)) - 0,
        t > 0 ? (f = (e = $$WP.I18N.Round(h, t)) - 0,
        i ? (f >= 1 && (r += 1,
        e = $$WP.I18N.Round(f - 1, t)),
        u = r.toFixed(0) + $$WP.I18N.DecimalSeparator + e.substring(2)) : 0 === h ? u = r : c.substring(2).length <= t ? u = r.toFixed(0) + $$WP.I18N.DecimalSeparator + c.substring(2) : (f >= 1 && (r += 1,
        e = $$WP.I18N.Round(f - 1, t)),
        u = f > 0 ? r.toFixed(0) + $$WP.I18N.DecimalSeparator + e.substring(2) : r.toFixed(0))) : u = h >= .5 ? (r + 1).toFixed(0) : r.toFixed(0),
        n < 0 && (u = $$WP.I18N.NegativePattern.replace("n", u)),
        u)
    }
    ;
    $$WP.I18N.Round = function(n, t) {
        return Number(Math.round(n + "e" + t) + "e-" + t).toFixed(t)
    }
    ;
    $$WP.I18N.parseCurrency = function(n) {
        var t = $$WP.Currency.Helpers.currencyToNumber(n);
        return isNaN(t) ? NaN : t
    }
    ;
    $$WP.I18N.parseNumber = function(n) {
        var i, f, c, r, l, e, o, s, a, v, y, t, h, u;
        return 0 === (n += "").length ? NaN : ((s = getGroupSeparator()).length > 0 && ((v = new RegExp("\\s","g")).test(s) ? n = n.replace(v, "") : (a = new RegExp($$WP.Utilities.regExEscapeString(s),"g"),
        n = n.replace(a, ""))),
        c = $$WP.Utilities.regExEscapeString("n"),
        r = $$WP.Utilities.regExEscapeString($$WP.I18N.DecimalSeparator),
        e = (l = $$WP.Utilities.regExEscapeString($$WP.I18N.NegativePattern).replace(c, "n")).replace("n", ""),
        n = n.trim(),
        new RegExp("[^\\d" + r + e + "]").test(n) ? NaN : (o = "((\\d+(" + r + "\\d*)?)|(" + r + "\\d+))",
        t = n,
        (y = new RegExp("^" + l.replace("n", o) + "$").test(n)) && (t = n.replace(new RegExp("[" + e + "]","g"), "")),
        new RegExp("^" + o + "$").test(t) ? (h = 0,
        u = 0,
        t.charAt(0) === $$WP.I18N.DecimalSeparator ? u = Number(t.substring(1)) / Math.pow(10, t.length - 1) : (i = t.split($$WP.I18N.DecimalSeparator),
        h = Number(i[0]),
        i.length > 1 && (u = Number(i[1]) / Math.pow(10, i[1].length))),
        f = h + u,
        y && (f *= -1),
        f) : NaN))
    }
    ;
    $$WP.I18N.getDateAriaString = function(n) {
        return $$WP.I18N.getDateAriaStringCore(n, !0, !1)
    }
    ;
    $$WP.I18N.getDateAriaStringCore = function(n, t, i) {
        return $$WP.I18N.getFormattedDateString(n, t, !0, !0, i)
    }
    ;
    $$WP.I18N.getCalendarDateAriaString = function(n) {
        var t = $$WP.I18N.CalendarDateAriaFormat;
        return t ? buildFormat(t)(n) : $$WP.I18N.getDateAriaString(date)
    }
    ;
    $$WP.I18N.getFormattedDateString = function(n, t, i, r, u) {
        var f = $$WP.I18N.DateFormat.toLowerCase().replace(/[^mdy]/g, " ");
        return f = (f = (f = f.replace(/dd+/, r ? n.getDate() : "")).replace(/yy+/, t ? n.getFullYear() : "")).replace(/mm+/, i ? getMonthName(n.getMonth() + 1) : ""),
        u && (f = f + " " + getDayName(n.getDay())),
        f
    }
    ;
    $$WP.I18N.monthTitleFormat = function(n) {
        return buildFormat("MMMM yyyy")(n)
    }
    ;
    $$WP.I18N.upperCaseFirstLetter = function(n) {
        return n.charAt(0).toUpperCase() + n.slice(1)
    }
    ;
    $$WP.I18N.Handlebars = {
        verticalDate: function(n, t) {
            for (var s, u = '<div><span class="clearlabel">*REPLACE*<\/span>', e = !1, o = !1, i = "", r = "", f = 0; f < t.length; f++) {
                switch (t[f]) {
                case "d":
                    i = "verticalDateOfMonth";
                    r = n.getDate();
                    break;
                case "m":
                    i = "verticalMonth";
                    r = getMonthAbbr(n.getMonth() + 1);
                    break;
                case "y":
                    i = "verticalYear";
                    r = n.getFullYear();
                    e = !0;
                    break;
                case "dow":
                    i = "verticalDayOfWeek";
                    r = getDayAbbr(n.getDay());
                    o = !0
                }
                u = u + '<div aria-hidden="true" class="' + i + '">' + r + "<\/div>"
            }
            return u += "<\/div>",
            s = $$WP.I18N.getDateAriaStringCore(n, e, o),
            u.replace("*REPLACE*", s)
        }
    };
    $$WP.I18N.setClientTimeZone = function() {
        if ($$WPUtil.canWriteCookies()) {
            var n = Intl.DateTimeFormat().resolvedOptions().timeZone;
            $.ajax({
                url: makeLink("Localization/LogClientTimeZone"),
                data: {
                    timeZoneIdentifier: n
                },
                type: "POST"
            })
        }
    }
    ;
    $$WP.I18N.formatList = function(n, t) {
        var u, i, r;
        u = $$WP.I18N.getMyChartLocale();
        (i = t || {}).style && i.style.length > 0 && (!i.type || 0 === i.type.length) && $$WP.Debug && $$WP.Debug.log && $$WP.Debug.log("Invalid list formatting options, if you specify a style you should specify a type.", !0);
        try {
            r = new Intl.ListFormat(u,i)
        } catch (n) {}
        return void 0 === r ? n.join(", ") : r.format(n)
    }
    ;
    $$WP.I18N.parseYear = function(n, t) {
        var r, i, u;
        return 2 === n.length ? (r = (new Date).getFullYear(),
        i = Number(n),
        i += r - r % 100,
        u = $$WP.I18N.CenturyRollover,
        t && (u = $$WP.I18N.BirthdayRollOver),
        i > r + u && (i -= 100)) : i = Number(n),
        $$WP.I18N.__validateYear(i) ? i : null
    }
    ;
    $$WP.I18N.numDaysInMonth = function(n, t) {
        switch (year = void 0 === t ? 2016 : t,
        n) {
        case 2:
            return year % 4 != 0 || year % 100 == 0 && year % 400 != 0 ? 28 : 29;
        case 4:
        case 6:
        case 9:
        case 11:
            return 30;
        default:
            return 31
        }
    }
    ;
    $$WP.I18N.__newReferenceFieldHistory = function(n) {
        var t = {};
        return t.history = n.history,
        t.pointer = n.pointer,
        t
    }
    ;
    $$WP.I18N.__createFieldHistory = function(n) {
        return n || (n = ""),
        {
            history: [String(n)],
            pointer: 1
        }
    }
    ;
    $$WP.I18N.__peekFieldHistory = function(n) {
        return n.history[n.pointer - 1]
    }
    ;
    $$WP.I18N.__pushFieldHistory = function(n, t) {
        return (n = $$WP.I18N.__newReferenceFieldHistory(n)).history = n.history.slice(0, n.pointer),
        n.history[n.pointer] = t,
        n.pointer++,
        n
    }
    ;
    $$WP.I18N.__resizeFieldHistory = function(n) {
        return (n = $$WP.I18N.__newReferenceFieldHistory(n)).history.length === n.pointer && 42 === n.pointer && (n.history = n.history.slice(n.pointer - 21, n.pointer),
        n.pointer -= 21),
        n
    }
    ;
    $$WP.I18N.__undoFieldHistory = function(n) {
        return (n = $$WP.I18N.__newReferenceFieldHistory(n)).pointer > 1 && n.pointer--,
        n
    }
    ;
    $$WP.I18N.__redoFieldHistory = function(n) {
        return (n = $$WP.I18N.__newReferenceFieldHistory(n)).pointer < n.length && n.pointer++,
        n
    }
    ;
    var r = function(t, i, r, u, f, e) {
        return !(t.length <= 1 || f >= u - 1) && (max = n(i, r),
        e > max || "y" === i && 3 === t.length && 10 * e > max)
    }
      , n = function(n, t) {
        switch (t || (t = {}),
        t.m || (t.m = 1),
        n) {
        case "d":
            max = $$WP.I18N.numDaysInMonth(t.m, t.y);
            break;
        case "m":
            max = 12;
            break;
        default:
            max = (new Date).getFullYear() + $$WP.I18N.CenturyRollover
        }
        return max
    }
      , i = function(n, t) {
        return n.toLowerCase().replace(new RegExp("[" + t.join("") + "]","g"), "").charAt(0)
    }
      , u = function(n, t, i, r, u, f, e, o) {
        return e < n.length - 1 || !(e >= u - 1) && (1 === t.length && 10 * n[e] > i || !(e !== n.length - 1 || !r) || e < u - 1 && t.length === o && t[t.length - 1] !== f)
    };
    $$WP.I18N.__validateYear = function(n) {
        return (n = parseInt(n)) > 999 && n < 1e4
    }
    ;
    var f = function(n, t, i) {
        var r = n
          , u = 2;
        for ("y" === t && (r = null === (r = $$WP.I18N.parseYear(n, i)) ? n : r.toString(),
        u = 4); r.length < u; )
            r = "0" + r;
        return r
    }
      , e = function(t, i, r) {
        return fieldLength = "y" === i ? 4 : 2,
        max = n(i, r),
        !(t.length >= fieldLength) && (num = parseInt(t),
        10 * num <= n(i, r))
    }
      , o = function(n, t) {
        return fieldLength = "y" === t ? 4 : 2,
        n.length > fieldLength
    }
      , t = function(n, t) {
        return n.indexOf(t) > -1
    };
    $$WP.I18N.deleteLiveDateFormatter = function(n) {
        for (var f = i($$WP.I18N.DateFormat, $$WP.I18N.getOrderedDatePieces()), u = 0, r = 0, t = n.length - 1; t >= 0; t--)
            if (n[t] === f ? u++ : /[1-9]/.test(n[t]) ? r++ : "0" === n[t] && 0 === t ? u++ : "0" === n[t] && t > 0 && /[1-9]/.test(n[t - 1]) || "0" === n[t] && t > 1 && "0" === n[t - 1] && /[1-9]/.test(n[t - 2]) || "0" === n[t] && t > 2 && "0" === n[t - 1] && "0" === n[t - 2] && /[1-9]/.test(n[t - 3]) ? r++ : u++,
            2 === r) {
                r--;
                break
            }
        return n.slice(0, n.length - u - r)
    }
    ;
    $$WP.I18N.processLiveDateFormatter = function(t, s, h) {
        var d, c, tt, it;
        if (t.length !== s)
            return t;
        var w, b, rt, v, k, et = $$WP.I18N.DateFormat, y = $$WP.I18N.getOrderedDatePieces(), nt = y.length, g = i(et, y), ut = function(n, t) {
            return n.replace(/[\\|\/|\.|,|\-| ]/g, t)
        }(t, g).split(g), ft = function(n, t, i) {
            return n.length <= i && n.length > 1 && (1 === n[n.length - 2].length || "y" === t[n.length - 2]) && "" === n[n.length - 1]
        }(ut, y, nt), l = ut.reduce(function(n, t) {
            var i = t.replace(/[\D]/g, "");
            return "" !== i && n.push(i),
            n
        }, []), a = [], p = {};
        if (function(n) {
            return 1 === n.length && !!/^[0-9]+$/.test(n[0])
        }(l) && l[0].length > ("y" === y[0] ? 4 : 2)) {
            for (d = "",
            c = 0; c < l[0].length; c++)
                d = $$WP.I18N.processLiveDateFormatter(d + l[0][c], d.length + 1, h);
            return d
        }
        for (c = 0; c < l.length; c++)
            k = "y" === (v = y[c]) ? 4 : 2,
            o(l[c], v) ? (a.push(l[c].slice(0, k)),
            p[v] = parseInt(l[c]),
            a.push(l[c].slice(k, l[c].length))) : "0" !== l[c].charAt(0) ? (b = parseInt(l[c]),
            r(l[c], v, p, nt, c, b) ? (a.push(Math.floor(b / 10).toString()),
            p[v] = parseInt(l[c]),
            a.push((b % 10).toString())) : (p[v] = parseInt(l[c]),
            a.push(b.toString()))) : (a.push(l[c]),
            p[v] = parseInt(l[c]));
        for (a = a.slice(0, y.length),
        tt = "",
        c = 0; c < a.length; c++)
            k = "y" === (v = y[c]) ? 4 : 2,
            w = new String(a[c]),
            rt = n(y[c], p),
            it = u(a, w, rt, ft, nt, g, c, k),
            (it || !e(a[c], v, p) && ft && c === a.length - 1) && (w = f(w, y[c], h)),
            it && (w += g),
            tt += w;
        return tt
    }
    ;
    $$WP.I18N.__clearFormatterAriaAnnouncement = function(n) {
        var t = n.safeAttr("id")
          , i = (t = t.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g, "\\$1")) + "_autoformatted";
        $afe.select("#" + i).empty()
    }
    ;
    $$WP.I18N.__appendFormatterAriaAnnouncement = function(n, t, i, r, u) {
        var s = n.safeAttr("id"), e = (s = s.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g, "\\$1")) + "_autoformatted", h, c, f, o;
        return $$WP.Strings.setDefaultNamespace("core.formvalidation"),
        h = $$WP.Strings.get(r ? "Birthdate" : u ? "Time" : "Date"),
        $$WP.Strings.addMnemonic("@MYCHART@FIELDNAME@", h),
        $$WP.Strings.addMnemonic("@MYCHART@FORMATTEDFIELDVALUE@", i || n.val(), ""),
        c = $$WP.Strings.getForTemplate("FieldUpdatedAnnouncementWithValue").toString(),
        $$WP.Strings.removeMnemonic("@MYCHART@FORMATTEDFIELDVALUE@"),
        $$WP.Strings.clearDefaultNamespace(),
        f = $("#" + e),
        f.length || (o = $$WP.SimpleTemplates.Span({
            "class": "clearlabel",
            id: e,
            "aria-live": "polite"
        }),
        o.safeInsertAfter(n.next().hasClass("calendar") ? n.next() : n),
        f = o),
        t || (f.empty(),
        f.safeAppend(dangerou$.parseHtml("<span>" + c + "<\/span>"))),
        e
    }
    ;
    $$WP.I18N.liveDate = function(n, i, r, u, f, e, o) {
        var c, l, h;
        void 0 === n && (n = "");
        var a = !1
          , s = void 0
          , v = !1;
        return "deleteContentBackward" === n && o ? (c = $$WP.I18N.__peekFieldHistory(e),
        s = c ? $$WP.I18N.deleteLiveDateFormatter(c) : i,
        c && c.length - s.length > 1 && (a = !0)) : t(n, "delete") ? s = i : t(n, "insert") ? (l = $$WP.I18N.processLiveDateFormatter(i, u, f),
        void 0 !== l && i !== l ? (s = l,
        a = !0) : s !== $$WP.I18N.__peekFieldHistory(e) && (s = i)) : "historyUndo" === n ? (e = $$WP.I18N.__undoFieldHistory(e),
        s = $$WP.I18N.__peekFieldHistory(e),
        v = !0) : "historyRedo" === n ? (e = $$WP.I18N.__redoFieldHistory(e),
        s = $$WP.I18N.__peekFieldHistory(e),
        v = !0) : s = i,
        e.pointer > 0 && s !== $$WP.I18N.__peekFieldHistory(e) && !t(n, "history") && (e = $$WP.I18N.__pushFieldHistory(e, s)),
        e = $$WP.I18N.__resizeFieldHistory(e),
        h = {},
        h.fieldHistory = e,
        h.next = s,
        h.appendAria = a,
        h.preventDefault = v,
        h
    }
    ;
    var s = function(n) {
        var t = $(n.target);
        "deleteContentBackward" === n.originalEvent.inputType && t[0].selectionStart === t[0].selectionEnd && t[0].selectionStart === n.target.value.length ? t.attr("data-runDeleter", "true") : t.attr("data-runDeleter", "false")
    }
      , h = function(n) {
        var t = $(n.target)
          , u = JSON.parse(t.attr("data-fieldHistory"))
          , f = "true" === t.attr("data-runDeleter")
          , r = !!JSON.parse(t.attr("data-validation-settings")).isDOB
          , i = $$WP.I18N.liveDate(n.originalEvent.inputType, n.target.value, t[0].selectionStart, t[0].selectionEnd, r, u, f);
        void 0 !== i.next && t.val(i.next);
        i.appendAria ? $$WP.I18N.__appendFormatterAriaAnnouncement(t, void 0, void 0, r) : $$WP.I18N.__clearFormatterAriaAnnouncement(t);
        i.preventDefault && n.preventDefault();
        t.attr("data-fieldHistory", JSON.stringify(i.fieldHistory))
    }
      , c = function(n) {
        var i = $(n.target)
          , t = JSON.parse(i.attr("data-fieldHistory"));
        n.target.value !== $$WP.I18N.__peekFieldHistory(t) && (t = $$WP.I18N.__pushFieldHistory(t, n.target.value));
        i.attr("data-fieldHistory", JSON.stringify(t))
    };
    $$WP.I18N.attachLiveDateFormatter = function(n) {
        var t, i;
        "1" !== n.attr("data-formatter-attached") && ("rtl" === $("html").attr("dir") && (n.attr("dir", "ltr"),
        n.css("text-align", "right")),
        $$WP.I18N.__appendFormatterAriaAnnouncement(n, !0),
        t = JSON.parse(n.attr("data-validation-settings")),
        t.format = !0,
        n.attr("data-validation-settings", JSON.stringify(t)),
        n.attr("inputmode", "numeric"),
        i = $$WP.I18N.processLiveDateFormatter(n.val(), n.val().length, t.isDOB),
        n.val(i),
        n.attr("data-fieldHistory", JSON.stringify($$WP.I18N.__createFieldHistory(i))),
        n.attr("data-formatter-attached", "1"),
        n.on("beforeinput", s),
        n.on("input", h),
        n.on("blur", c))
    }
}(),
function() {
    var n = function() {
        return this.prototype = {
            Value: null,
            isValid: function() {
                return null
            }
        },
        function(n, t) {
            this.Value = n;
            this.isValid = t
        }
    }()
      , t = {
        DateObject: null,
        DayOfMonth: new n,
        Month: new n,
        Year: new n,
        isSpilledOver: function() {
            return null !== this.DateObject && (this.DateObject.getUTCDate() !== this.DayOfMonth.Value || this.DateObject.getUTCMonth() !== this.Month.Value - 1 || this.DateObject.getUTCFullYear() !== this.Year.Value)
        },
        isValid: function() {
            return this.Month.isValid() && this.DayOfMonth.isValid() && this.Year.isValid()
        }
    }
      , i = function(n, t) {
        var e, o, s, h, i, u, f;
        return o = (e = $$WP.I18N.DateFormat.toLowerCase().replace(/[^ymd]*([ymd])+[^ymd]*/g, "$1")).indexOf("d"),
        s = e.indexOf("m"),
        h = e.indexOf("y"),
        r(n) ? (2 === n.length ? (f = (new Date).getFullYear(),
        u = Number(n[s]),
        i = Number(n[o])) : 3 === n.length && (f = $$WP.I18N.parseYear(n[h], t),
        u = Number(n[s]),
        i = Number(n[o])),
        null === i || isNaN(i) || null === u || isNaN(u) || null === f || isNaN(f) ? null : {
            DayOfMonth: i,
            Month: u,
            Year: f
        }) : null
    }
      , r = function(n) {
        if (2 !== n.length && 3 !== n.length)
            return !1;
        for (var t = 0; t < n.length; t++)
            if (0 === n[t].length)
                return !1;
        return !0
    }
      , u = function(n) {
        return n > 0 && n < 13
    }
      , f = function(n, t, i) {
        return !(n < 1) && n <= $$WP.I18N.numDaysInMonth(t, i)
    };
    $$WP.I18N.Date = function(t, r, e, o) {
        var s, a, l, h, c;
        if (e = void 0 !== e && e,
        o = void 0 !== o && o,
        "date" === r)
            s = t.trim().split("-"),
            l = Number(s[2]),
            h = Number(s[1]),
            c = Number(s[0]);
        else {
            if ("string" != typeof t || /[a-zA-Z]/.test(t))
                return;
            if (o && /^[0-9]+$/.test(t) && (t = $$WP.I18N.processLiveDateFormatter(t, t.length, e)),
            s = t.trim().split(/[^\d]+/),
            null === (a = i(s, e)))
                return;
            l = a.DayOfMonth;
            h = a.Month;
            c = a.Year
        }
        this.DayOfMonth = new n(l,function() {
            return f(l, h, c)
        }
        );
        this.Month = new n(h,function() {
            return u(h)
        }
        );
        this.Year = new n(c,function() {
            return $$WP.I18N.__validateYear(c)
        }
        );
        this.DateObject = new Date(0);
        this.DateObject.setUTCFullYear(c);
        this.DateObject.setUTCMonth(h - 1);
        this.DateObject.setUTCDate(l)
    }
    ;
    $$WP.I18N.Date.prototype = t
}();
$$WP.Debug.UnitTest = $$WP.Debug.UnitTest || {};
$$WP.Debug.UnitTest.tests = $$WP.Debug.UnitTest.tests || [];
$$WP.Debug.UnitTest.tests.push(function() {
    var n, t, i, r, u, f;
    n = $$WP.Debug.UnitTest.assert;
    r = $$WP.I18N.DecimalSeparator;
    u = $$WP.I18N.NegativePattern;
    f = $$WP.I18N.GroupSeparator;
    $$WP.I18N.DecimalSeparator = ",";
    $$WP.I18N.GroupSeparator = ".";
    $$WP.I18N.NegativePattern = "(n)";
    t = $$WP.I18N.parseNumber;
    i = $$WP.I18N.formatNumber;
    n(1234 === t("1234"), "Failed to parse number string: '1234'");
    n(1234 === t(" 1234"), "Failed to parse number string: ' 1234'");
    n(1 === t("1,0"), "Failed to parse number string: '1,0'");
    n(1.234 === t("1,234"), "Failed to parse number string: '1,234'");
    n(1234.234 === t("1234,234"), "Failed to parse number string: '1234,234'");
    n(1234.234 === t(" 1234,234"), "Failed to parse number string: ' 1234,234'");
    n(1234 === t("1.234"), "Failed to parse number string: '1.234'");
    n(1234567 === t("1.234.567"), "Failed to parse number string: '1.234.567'");
    n(-1 === t("(1)"), "Failed to parse number string: '(1)'");
    n(-1234 === t("(1234)"), "Failed to parse number string: '(1234)'");
    n(-1 === t("(1,0)"), "Failed to parse number string: '(1,0)'");
    n(-1.234 === t("(1,234)"), "Failed to parse number string: '(1,234)'");
    n(-1234.234 === t("(1234,234)"), "Failed to parse number string: '(1234,234)'");
    n(-1234567 === t("(1.234.567)"), "Failed to parse number string: '(1.234.567)'");
    n(isNaN(t("abc")), "Did not reject invalid number string: 'abc'");
    n(isNaN(t("((123")), "Did not reject invalid number string: '((123'");
    n(isNaN(t("(123,,0")), "Did not reject invalid number string: '(123,,0'");
    n(isNaN(t("(123,0,0")), "Did not reject invalid number string: '(123,0,0'");
    n(isNaN(t("(123(")), "Did not reject invalid number string: '(123('");
    n(isNaN(t("(123,0(")), "Did not reject invalid number string: '(123,0('");
    n(isNaN(t("(1@123,0)")), "Did not reject invalid number string: '(1.123,0)'");
    n(isNaN(t("(1@234)")), "Did not reject invalid number string: '(1.234)'");
    n(isNaN(t("(1@234,234)")), "Did not reject invalid number string: '(1.234,234)'");
    $$WP.I18N.GroupSeparator = "";
    n(1234 === t("1 234"), "Failed to parse number string: '(1 234)'");
    $$WP.I18N.GroupSeparator = "";
    n(1234 === t("1 234"), "Failed to parse number string: '(1 234)'");
    $$WP.I18N.GroupSeparator = ".";
    n("123" === i(123), "Did not properly format 123 as '123'");
    n("123" === i(123.4), "Did not properly format 123.4 as '123'");
    n("123,4" === i(123.4, 1), "Did not properly format 123.4 as '123.4'");
    n("124" === i(123.5), "Did not properly format 123.5 as '124'");
    n("123,5" === i(123.5, 3), "Did not properly format 123.5 as '123.5'");
    n("(123)" === i(-123), "Did not properly format -123 as '(123)'");
    n("(123)" === i(-123.4), "Did not properly format -123.4 as '(123)'");
    n("(123,4)" === i(-123.4, 1), "Did not properly format -123.4 as '(123,4)'");
    n("(124)" === i(-123.5), "Did not properly format -123.5 as '(124)'");
    n("(123,5)" === i(-123.5, 3), "Did not properly format -123.5 as '(123,5)'");
    n("11,000" === i(10.99999, 3), "Did not properly format 10.99999 as '11,000'");
    $$WP.I18N.DecimalSeparator = r;
    $$WP.I18N.NegativePattern = u;
    $$WP.I18N.GroupSeparator = f
});
$$WP.Debug.UnitTest.tests.push(function() {
    var l, n, r, h, y, t, f, u, i, a, v;
    l = $$WP.Debug.UnitTest.assert;
    n = $$WP.Debug.UnitTest.assertValue;
    y = $$WP.I18N.DateFormat;
    r = $$WP.I18N.parseDate;
    h = $$WP.I18N.formatPatientGivenDate;
    t = $$WP.I18N.processLiveDateFormatter;
    f = $$WP.I18N.deleteLiveDateFormatter;
    $$WP.I18N.liveDate;
    var c = $$WP.I18N.__createFieldHistory
      , s = $$WP.I18N.__pushFieldHistory
      , p = $$WP.I18N.__undoFieldHistory
      , w = $$WP.I18N.__redoFieldHistory
      , e = $$WP.I18N.liveDate("deleteContentBackward", "", 0, 0, !1, c(), !0)
      , o = {
        fieldHistory: c(),
        next: "",
        appendAria: !1,
        preventDefault: !1
    };
    for (n(JSON.stringify(e), JSON.stringify(o), "delete at init"),
    u = c(),
    u = s(u, "10/"),
    e = $$WP.I18N.liveDate("deleteContentBackward", "1", 1, 1, !1, u, !0),
    o = {
        fieldHistory: u = s(u, "1"),
        next: "1",
        appendAria: !0,
        preventDefault: !1
    },
    n(JSON.stringify(e), JSON.stringify(o), "runDeleter"),
    u = s(u = c(), "10/"),
    e = $$WP.I18N.liveDate("delete", "1/", 1, 1, !1, u, !1),
    o = {
        fieldHistory: u = s(u, "1/"),
        next: "1/",
        appendAria: !1,
        preventDefault: !1
    },
    n(JSON.stringify(e), JSON.stringify(o), "delete"),
    u = c(),
    e = $$WP.I18N.liveDate("insert", "1", 1, 1, !1, u, !1),
    o = {
        fieldHistory: s(u, "1"),
        next: "1",
        appendAria: !1,
        preventDefault: !1
    },
    n(JSON.stringify(e), JSON.stringify(o), "type 1"),
    u = s(u = c(), "1"),
    e = $$WP.I18N.liveDate("insert", "10", 2, 2, !1, u, !1),
    o = {
        fieldHistory: u = s(u, "10/"),
        next: "10/",
        appendAria: !0,
        preventDefault: !1
    },
    n(JSON.stringify(e), JSON.stringify(o), "type 10"),
    e = $$WP.I18N.liveDate("historyUndo", "10/", 3, 3, !1, u, !1),
    o = {
        fieldHistory: u = p(u),
        next: "1",
        appendAria: !1,
        preventDefault: !0
    },
    n(JSON.stringify(e), JSON.stringify(o), "undo"),
    e = $$WP.I18N.liveDate("historyRedo", "1", 1, 1, !1, u, !1),
    o = {
        fieldHistory: u = w(u),
        next: "10/",
        appendAria: !1,
        preventDefault: !0
    },
    n(JSON.stringify(e), JSON.stringify(o), "redo"),
    n(JSON.stringify({
        history: [""],
        pointer: 1
    }), JSON.stringify($$WP.I18N.__createFieldHistory()), "create - no init param"),
    n(JSON.stringify({
        history: ["4"],
        pointer: 1
    }), JSON.stringify($$WP.I18N.__createFieldHistory("4")), "create - init param"),
    n(JSON.stringify({
        history: ["4"],
        pointer: 1
    }), JSON.stringify($$WP.I18N.__createFieldHistory(4)), "create - number init param"),
    i = $$WP.I18N.__createFieldHistory(),
    n("", $$WP.I18N.__peekFieldHistory(i), "peek - uninitialized history"),
    i = $$WP.I18N.__createFieldHistory("4"),
    n("4", $$WP.I18N.__peekFieldHistory(i), "peek - return from init state"),
    i = $$WP.I18N.__pushFieldHistory(i, "5"),
    n("5", $$WP.I18N.__peekFieldHistory(i), "peek - after push"),
    i = $$WP.I18N.__undoFieldHistory(i),
    n("4", $$WP.I18N.__peekFieldHistory(i), "peek - after undo"),
    a = i = $$WP.I18N.__createFieldHistory(),
    l(a !== (i = $$WP.I18N.__pushFieldHistory(i, "1")), "Reference to object not updated."),
    n(JSON.stringify({
        history: ["", "1"],
        pointer: 2
    }), JSON.stringify(i), "push - add to non-init fieldHistory"),
    i = $$WP.I18N.__createFieldHistory(1),
    i = $$WP.I18N.__pushFieldHistory(i, "2"),
    n(JSON.stringify({
        history: ["1", "2"],
        pointer: 2
    }), JSON.stringify(i), "push - add to fieldHistory"),
    i = $$WP.I18N.__createFieldHistory(""),
    v = 1; v < 42; v++)
        i = $$WP.I18N.__pushFieldHistory(i, v);
    n(42, i.history.length, "resize - setup");
    l((a = i) !== (i = $$WP.I18N.__resizeFieldHistory(i)), "Reference to object not updated");
    n(21, i.history.length, "resize - test history length");
    n(21, i.pointer, "resize - pointer");
    i = $$WP.I18N.__createFieldHistory("1");
    l((a = i = $$WP.I18N.__pushFieldHistory(i, "2")) !== (i = $$WP.I18N.__undoFieldHistory(i)), "Reference to object not updated");
    n(JSON.stringify(i), JSON.stringify({
        history: ["1", "2"],
        pointer: 1
    }));
    l((a = i) !== (i = $$WP.I18N.__redoFieldHistory(i)), "Reference to object not updated");
    n(JSON.stringify(i), JSON.stringify({
        history: ["1", "2"],
        pointer: 2
    }));
    $$WP.I18N.DateFormat = "MM/dd/YYYY";
    n("03/", t("3", 1), "Failed to format live date: there are no double digit months starting with 3");
    n("1", t("1", 1), "Failed to format live date: there are double digit months starting with 1");
    n("01/3", t("13", 2), "There is no 13th month");
    n("02/03/", t("02/3", 4), "no Feb 30th");
    n("02/29/", t("02/29", 5), "leap day");
    n("0", t("0", 1), "type zeroes");
    n("01/", t("01", 2), "type zeroes");
    n("12/01/", t("12/1/", 5), "type slashes");
    n("02/03/1999", t("2/3/1999", 8), "paste");
    n("02/03/1999", t("2.3.1999", 8), "paste from another format");
    n("02/03/99", t("2.3.99", 6), "paste from another format");
    n("03/14/1999", t("03141999", 8), "paste from another format - this would work in hyperspace");
    n("03/14/99", t("031499", 6), "paste from format that would work in hyperspace");
    n("03/04/8", t("03/04/8", 7), "random bug");
    n("12/29/94", t("122994", 6), "would work in hyperspace");
    n("01/04/", t("014", 3), "deletion");
    n("01/31/", t("01/31", 5), "January 31 valid");
    n("02/29/", t("02/29", 5), "February 29 valid");
    n("03/31/", t("03/31", 5), "March 31 valid");
    n("04/30/", t("04/30", 5), "April 30 valid");
    n("05/31/", t("05/31", 5), "May 31 valid");
    n("06/30/", t("06/30", 5), "June 30 valid");
    n("07/31/", t("07/31", 5), "July 31 valid");
    n("08/31/", t("08/31", 5), "August 31 valid");
    n("09/30/", t("09/30", 5), "September 30 valid");
    n("10/31/", t("10/31", 5), "October 31 valid");
    n("11/30/", t("11/30", 5), "November 30 valid");
    n("12/31/", t("12/31", 5), "December 31 valid");
    n("01/03/2", t("01/32", 5), "January 32 invalid");
    n("02/03/0", t("02/30", 5), "February 30 invalid");
    n("03/03/2", t("03/32", 5), "March 32 invalid");
    n("04/03/1", t("04/31", 5), "April 31 invalid");
    n("05/03/2", t("05/32", 5), "May 32 invalid");
    n("06/03/1", t("06/31", 5), "June 31 invalid");
    n("07/03/2", t("07/32", 5), "July 32 invalid");
    n("08/03/2", t("08/32", 5), "August 32 invalid");
    n("09/03/1", t("09/31", 5), "September 31 invalid");
    n("10/03/2", t("10/32", 5), "October 32 invalid");
    n("11/03/1", t("11/31", 5), "November 31 invalid");
    n("12/03/2", t("12/32", 5), "December 32 invalid");
    n("05/", t("p5", 2), "Forms validation attached late");
    n("", t("p/", 2), "Forms validation attached late");
    n("05/", t("/5", 2), "Forms validation attached late");
    n("", t("//", 2), "Forms validation attached late");
    n("03/", t("03;", 3), "Non-number where a spacer should be");
    n("03/14/", t("03/14;", 6), "Non-number where a spacer should be");
    n("03/14/1999", t("Here is a random date: 3/14/1999", 32), "Random sentence pasted in");
    n("03/14/1999", t("3/14/1999: That was a random date", 33), "Random sentence pasted in");
    n("03/14/1999", t("Crazy day: 3/14/1999: That was a random date", 44), "Random sentence pasted in");
    n("03/14/", t("Here is a random date: 3/14", 27), "Random sentence pasted in");
    n("03/14/", t("3/14: That was a random date", 28), "Random sentence pasted in");
    n("03/14/", t("Crazy day: 3/14: That was a random date", 39), "Random sentence pasted in");
    n("03/", t("Here is a random date: 3", 24), "Random sentence pasted in");
    n("03/", t("3: That was a random date", 25), "Random sentence pasted in");
    n("03/", t("Crazy day: 3: That was a random date", 36), "Random sentence pasted in");
    n("03/14/1999", t("03\\14\\1999", 10), "Accept backslash");
    n("01/01/11", t("1\\1\\11", 6), "Accept backslash");
    n("01/02/2003", t("01/02/20030", 11), "Overflow");
    n("08/08/90", t("8890", 4), "accept 4 digit dates");
    n("12/08/90", t("12890", 5), "accept 5 digit dates");
    n("12/11/90", t("121190", 6), "accept 6 digit dates");
    n("03/14/1990", t("3141990", 7), "accept 7 digit dates");
    n("12/04/1990", t("1241990", 7), "accept 7 digit dates");
    n("12/11/1999", t("12111999", 8), "accept 8 digit dates");
    n("12/03/4", t("1234", 4), "Copy/paste");
    n("01/03/45", t("1345", 4), "Copy/paste");
    n("08/08/1999", t("881999", 6), "6-digit uneasy formatting");
    n("08/08/888", t("08/08/888", 9), "Don't add zeroes on typos");
    n("02/22/222", t("02/22/222", 9), "Don't add zeroes on typos");
    n("09/09/999", t("09/09/999", 9), "Don't add zeroes on typos");
    n("01/01/204", t("01/01/204", 9), "Don't add zeroes on typos");
    n("01/01/2040", t("01/01/2040", 10), "Don't add zeroes on typos");
    n("01/03/923", t("01/03/923", 9), "Don't add zeroes on typos");
    n("01/01/998", t("01/01/998", 9), "Don't add zeroes on typos");
    $$WP.I18N.DateFormat = "YYYY/MM/DD";
    n("2001/", t("01/", 3), "doesn't allow 2-digit years");
    n("2001/", t("2001", 4), "basic 4-digit year");
    n("0003/03/3", t("3/3/3", 5), "allows 1-digit year");
    n("0103/03/3", t("103/3/3", 7), "allows 3-digit year");
    n("22", t("22", 2), "2 chars entered");
    n("2002/", t("2002 ", 5), "space entered");
    n("2002/", t("2002", 4), "nothing entered");
    n("2022/01/3", t("2022/13", 7), "regular month checking");
    n("2022/0", t("220", 3), "6-digit leadup");
    n("2022/02/25", t("220225", 6), "6-digit");
    n("2022/03/1", t("2022031", 7), "7-digit");
    n("2022/03/3", t("2022033", 7), "7-digit");
    n("2022/03/4", t("2022034", 7), "7-digit");
    n("2022/03/01", t("20220301", 8), "8-digit");
    n("2002/09/30", t("2002 09 30", 10), "space separator");
    n("2001/08/12", t("2001/08/12", 10), "slash separator");
    n("2001/08/12", t("2001.08.12", 10), "period separator");
    n("2001/08/12", t("2001,08,12", 10), "comma separator");
    n("2001/08/12", t("2001-08-12", 10), "dash separator");
    n("2001/08/12", t("2001\\08\\12", 10), "backslash separator");
    n("2001/02/03", t("2001/02/033", 11), "Overflow");
    n("1999/08/8", t("1999/08/8", 9), "6digit test");
    n("1999/08/8", t("199988", 6), "6-digit uneasy formatting");
    n("03/14/199", f("03/14/1999"), "Simple deletion");
    n("03/14/19", f("03/14/199"), "Simple deletion");
    n("10", f("10/02/"), "Clear digit");
    n("", f("02/"), "Remove leading zero");
    n("11/11/100", f("11/11/1000"), "Delete zero");
    n("11/11/10", f("11/11/100"), "Delete zero");
    n("11/11/1", f("11/11/10"), "Delete zero");
    n("09/09/999", f("09/09/9999"), "6 9's");
    n("09/09/99", f("09/09/999"), "6 9's");
    n("09/09/9", f("09/09/99"), "6 9's");
    n("09/09", f("09/09/9"), "6 9's");
    n("09", f("09"), "6 9's");
    $$WP.I18N.DateFormat = "MM/dd/YYYY";
    n("09/10/2016", h(new Date("2016-09-10")), "Failed to format date ");
    n("02/01/0123", h(new Date("0123-02-01")), "Failed to format date ");
    $$WP.I18N.DateFormat = "M/d/YY";
    n("9/10/16", h(new Date("2016-09-10")), "Failed to format date ");
    n("2/1/23", h(new Date("0123-02-01")), "Failed to format date ");
    n("10/11/16", h(new Date("2016-10-11")), "Failed to format date ");
    $$WP.I18N.DateFormat = "MM/dd/yyyy";
    n(new Date("2016-10-09").getTime(), r("10/9/2016").getTime(), "Date parsed incorrectly.");
    n(new Date("2016-10-09").getTime(), r(" 10 / 9 - 2016 ").getTime(), "Date parsed incorrectly.");
    n(new Date("2016-10-09").getTime(), r("10-9-16").getTime(), "Date parsed incorrectly.");
    n(new Date("1975-10-09").getTime(), r("10-9-75").getTime(), "Date parsed incorrectly.");
    n(new Date("2016-02-29").getTime(), r("2-29-16").getTime(), "Date parsed incorrectly.");
    n(new Date("2016-12-31").getTime(), r("12-31-16").getTime(), "Date parsed incorrectly.");
    n(new Date("2016-01-01").getTime(), r("1-1-16").getTime(), "Date parsed incorrectly.");
    n(new Date((new Date).getFullYear() + "-01-01").getTime(), r("1-1").getTime(), "Date parsed incorrectly.");
    $$WP.I18N.DateFormat = "M/d/y";
    n(new Date("2016-10-09").getTime(), r("10/9/2016").getTime(), "Date parsed incorrectly.");
    n(new Date("2016-10-09").getTime(), r(" 10 / 9 - 2016 ").getTime(), "Date parsed incorrectly.");
    n(new Date("2016-10-09").getTime(), r("10-9-16").getTime(), "Date parsed incorrectly.");
    n(new Date("1975-10-09").getTime(), r("10-9-75").getTime(), "Date parsed incorrectly.");
    $$WP.I18N.DateFormat = "dd-MM-yyyy";
    n(new Date("2016-09-10").getTime(), r("10/9/2016").getTime(), "Date parsed incorrectly.");
    n(new Date("2016-09-10").getTime(), r(" 10 / 9 - 2016 ").getTime(), "Date parsed incorrectly.");
    n(new Date("2016-09-10").getTime(), r("10-9-16").getTime(), "Date parsed incorrectly.");
    n(new Date("1975-09-10").getTime(), r("10-9-75").getTime(), "Date parsed incorrectly.");
    $$WP.I18N.DateFormat = "dd yyyy mm";
    n(new Date("2016-09-10").getTime(), r("10/2016/9").getTime(), "Date parsed incorrectly.");
    n(new Date("2016-09-10").getTime(), r(" 10 / 2016 - 9 ").getTime(), "Date parsed incorrectly.");
    n(new Date("2016-09-10").getTime(), r("10-16-9").getTime(), "Date parsed incorrectly.");
    n(new Date("1975-09-10").getTime(), r("10-75-9").getTime(), "Date parsed incorrectly.");
    $$WP.I18N.DateFormat = "MM/dd/yyyy";
    n(null, r("January 1, 2016"), "Invalid date string was not rejected.");
    n(null, r("10/9/16 AD"), "Invalid date string was not rejected.");
    n(null, r("2/29/15"), "Invalid date string was not rejected.");
    n(null, r("0/1/2016"), "Invalid date string was not rejected.");
    n(null, r("1/1/"), "Invalid date string was not rejected.");
    n(null, r("/1/1"), "Invalid date string was not rejected.");
    n(null, r("/1/1/"), "Invalid date string was not rejected.");
    n(null, r("//1//1//"), "Invalid date string was not rejected.");
    $$WP.I18N.DateFormat = y
});
$$WP.Debug.UnitTest.tests.push(function() {
    var n, f, r, u, t, i;
    n = $$WP.Debug.UnitTest.assertValue;
    f = $$WP.I18N.Identifier;
    $$WP.I18N.Identifier = "en-US";
    t = $$WP.I18N.formatList;
    r = {
        style: "long",
        type: "disjunction"
    };
    u = {
        style: "narrow"
    };
    i = ["one", "two", "three", "four"];
    WP && WP.DOM && WP.DOM.Browser.isIE ? (n("one, two, three, four", t(i), "failed to format list for IE"),
    n("one, two, three, four", t(i, r), "failed to format list for IE"),
    n("one, two, three, four", t(i, u), "failed to format list for IE")) : (n("one, two, three, and four", t(i), "failed to format list"),
    n("one, two, three, or four", t(i, r), "failed to format list"),
    n("one, two, three, four", t(i, u), "failed to format list"));
    $$WP.I18N.Identifier = f
});
EpicPx = EpicPx || {};
EpicPx.pendingPortals = EpicPx.pendingPortals || {};
EpicPx.scriptSources = EpicPx.scriptSources || [];
EpicPx.addReactPortal = function() {
    var n = !1;
    return function(t, i, r, u) {
        u ? EpicPx.addPortal ? EpicPx.addPortal(t, i, r, u) : n ? setTimeout(function() {
            EpicPx.addReactPortal(t, i, r, u)
        }, 10) : (EpicPx.pendingPortals[u] = {
            elementId: u,
            packageName: t,
            componentName: i,
            props: r
        },
        function() {
            var r, t, i;
            if (!n) {
                for (n = !0,
                r = document.createDocumentFragment(),
                t = 0; t < EpicPx.scriptSources.length; t++)
                    i = document.createElement("script"),
                    i.src = makeLink(EpicPx.scriptSources[t]),
                    i.async = !1,
                    r.appendChild(i);
                document.head.appendChild(r)
            }
        }()) : $$WP.Debug.log("No element ID passed in to render " + t + "/" + i)
    }
}();
EpicPx.removeReactPortal = function(n) {
    if (n)
        return EpicPx.removePortal ? EpicPx.removePortal(n) : void (EpicPx.pendingPortals[n] && delete EpicPx.pendingPortals[n])
}
;
$$WPUtil.guaranteeExistence($$WP, "Handlebars");
$$WPUtil.guaranteeExistence($$WP, "Templates");
$$WP.Handlebars._addHelpersHasBeenCalled = !1;
$$WP.Handlebars.addHelpers = function() {
    if (!$$WP.Handlebars._addHelpersHasBeenCalled) {
        $$WP.Handlebars._addHelpersHasBeenCalled = !0;
        $$WP.Utilities && ($$WP.Handlebars.addComponent = function(n) {
            var t = "componentcontainer_" + $$WPUtil.generateGUID()
              , i = function() {
                var r = document.getElementById(t);
                $$WP.Utilities.addComponent._Counter[t]++;
                r ? (delete $$WPUtil.Handlebars.addComponent._Counter[t],
                $afe.jq(r).safeAppend(n.$container)) : $$WP.Utilities.addComponent._Counter[t] < 10 && window.setTimeout(i, 1)
            };
            return $$WP.Utilities.addComponent._Counter[t] = 0,
            window.setTimeout(i, 1),
            '<div id="' + t + '"><\/div>'
        }
        ,
        $$WP.Handlebars.addComponent._Counter = {},
        Handlebars.registerHelper("addComponent", $$WP.Handlebars.addComponent),
        Handlebars.registerHelper("ifNotNullOrEmpty", function(n, t) {
            return $$WPUtil.IsNullOrEmpty(n) ? t.inverse(this) : t.fn(this)
        }),
        registerUIUtilitiesHelpers());
        registerStringsHelpers();
        try {
            makeLink && (Handlebars.registerHelper("makeLink", makeLink),
            Handlebars.registerHelper("makeStaticLink", makeStaticLink),
            Handlebars.registerHelper("makeStaticImageLink", makeStaticImageLink),
            Handlebars.registerHelper("showFile", function(n) {
                return makeLink("showfile.asp?key=" + n)
            }))
        } catch (t) {}
        try {
            isDataTile && (Handlebars.registerHelper("ifDataTiles", function(n) {
                return isDataTile() ? n.fn(this) : n.inverse(this)
            }),
            Handlebars.registerHelper("ifNotDataTiles", function(n) {
                return isDataTile() ? n.inverse(this) : n.fn(this)
            }))
        } catch (t) {}
        $$WP.CommunityUtilities && Handlebars.registerHelper("canShowExternalLoadingIndicator", function(n) {
            return $$WP.CommunityUtilities.hasCommunityLinks() ? n.fn(this) : n.inverse(this)
        });
        $$WP.FormValidation && (Handlebars.registerHelper("validationSettingsAttribute", $$WP.FormValidation.Handlebars.validationSettingsAttribute),
        Handlebars.registerHelper("messageDisplay", $$WP.FormValidation.Handlebars.messageDisplay),
        Handlebars.registerHelper("messageDisplayForAttribute", $$WP.FormValidation.Handlebars.messageDisplayForAttribute),
        Handlebars.registerHelper("disableIfInvalidAttribute", $$WP.FormValidation.Handlebars.disableIfInvalidAttribute),
        Handlebars.registerHelper("validationGroupAttribute", $$WP.FormValidation.Handlebars.validationGroupAttribute),
        Handlebars.registerHelper("validationRequiredAttribute", $$WP.FormValidation.Handlebars.validationRequiredAttribute),
        Handlebars.registerHelper("showRequiredInstructions", $$WP.FormValidation.Handlebars.showRequiredInstructions));
        $$WP.Currency && Handlebars.registerHelper("numberAsCurrency", function(n, t) {
            var i;
            return i = "function" == typeof n ? n() : n,
            $$WP.Currency.Helpers.numberToCurrency(i, t)
        });
        registerI18NHelpers();
        $$WP.UI && ($$WP.UI.Command && Handlebars.registerHelper("command", function(n, t, i, r, u) {
            var f = new $$WP.UI.CommandOptions("string" == typeof r ? JSON.parse(r) : r), e;
            return f.MiscContent = (f.MiscContent || "") + (u && u.fn ? new Handlebars.SafeString(u.fn(this)) : ""),
            e = new $$WP.UI.Command({
                Priority: n,
                Tone: t,
                Caption: i,
                CmdOptions: f
            }),
            Handlebars.helpers.addTemplate("UI.Command", e)
        }),
        $$WP.UI.Dropdown && Handlebars.registerHelper("dropdown", function(n, t, i, r, u, f, e) {
            var o = $$WP.UI.DropdownOption.convertRawDropdownOptions(u, f, e);
            return Handlebars.helpers.addTemplate("UI.Dropdown", new $$WP.UI.Dropdown({
                IdName: n,
                Label: t,
                PlaceholderText: i,
                ValidationSettings: r,
                Options: o
            }))
        }),
        $$WP.UI.Dropdown && Handlebars.registerHelper("dropdown", function(n, t, i, r, u, f, e) {
            var o = $$WP.UI.DropdownOption.convertRawDropdownOptions(u, f, e);
            return Handlebars.helpers.addTemplate("UI.Dropdown", new $$WP.UI.Dropdown({
                IdName: n,
                Label: t,
                PlaceholderText: i,
                ValidationSettings: r,
                Options: o
            }))
        }),
        registerInfoBubbleHelpers());
        registerBannerHelpers();
        Handlebars.registerHelper("ajaxSpinner", function(n, t, i) {
            if (78 != $$WP.ApplicationContext)
                return Handlebars.helpers.addTemplate("UI.AjaxSpinner", {
                    inline: n,
                    loadingMessage: t,
                    role: i ? "status" : "alert"
                })
        });
        $$WP.Svg && Handlebars.registerHelper("referenceSvg", function(n) {
            if (null === n || "" === n)
                return null;
            var i, t = document.createElement("use");
            return i = 0 === n.indexOf("~/") ? makeLink(n.substring(2)) : 0 === n.indexOf("http") ? n : makeStaticImageLink(n),
            t.setAttribute("xlink:href", i),
            WP.DOM.Browser.isIE ? ($$WP.Svg.Helpers.loadSingleSvgIcon(t),
            new Handlebars.SafeString(t.innerHTML)) : new Handlebars.SafeString(t.outerHTML)
        });
        Handlebars.registerHelper("URLEncode", encodeURI);
        Handlebars.registerHelper("encodeURIComponent", encodeURIComponent);
        Handlebars.registerHelper("ifEquals", function(n, t, i) {
            return n !== t ? i.inverse(this) : i.fn(this)
        });
        Handlebars.registerHelper("ifNotEquals", function(n, t, i) {
            return n === t ? i.inverse(this) : i.fn(this)
        });
        Handlebars.registerHelper("addTemplate", function(n, t, i, r) {
            for (var e = n.split("."), o = e.length, f = $$WP.Templates, u = 0; u < o; u++)
                f = f[e[u]];
            if ("function" != typeof f)
                throw "addTemplate could not find $$WP.Templates." + n;
            return i && r && (t.AdditionalData = i),
            new Handlebars.SafeString(f(t, {
                allowProtoPropertiesByDefault: !0,
                allowProtoMethodsByDefault: !0
            }))
        });
        Handlebars.registerHelper("ifLt", function(n, t, i) {
            return n < t ? i.fn(this) : i.inverse(this)
        });
        Handlebars.registerHelper("ifGt", function(n, t, i) {
            return n > t ? i.fn(this) : i.inverse(this)
        });
        Handlebars.registerHelper("isLastInArray", function(n, t, i) {
            return n + 1 === t ? i.fn(this) : i.inverse(this)
        });
        Handlebars.registerHelper("isMiddleInArray", function(n, t, i) {
            return n + 1 === Math.ceil(t / 2) ? i.fn(this) : i.inverse(this)
        });
        Handlebars.registerHelper("each-reverse", function(n, t) {
            var i, r = "";
            if (n && n.length > 0)
                for (i = n.length - 1; i >= 0; i--)
                    t.data.index = i,
                    r += t.fn(n[i]);
            else
                r = t.inverse(this);
            return r
        });
        Handlebars.registerHelper("raw", function(n) {
            return new Handlebars.SafeString(n)
        });
        Handlebars.registerHelper("ifEven", function(n, t) {
            return n % 2 == 0 ? t.fn(this) : t.inverse(this)
        });
        Handlebars.registerHelper("ifAny", function() {
            for (var t = arguments.length - 1, n = 0; n < t; n++)
                if (arguments[n])
                    return arguments[t].fn(this);
            return arguments[t].inverse(this)
        });
        Handlebars.registerHelper("ifAll", function() {
            for (var t = arguments.length - 1, n = 0; n < t; n++)
                if (!arguments[n])
                    return arguments[t].inverse(this);
            return arguments[t].fn(this)
        });
        Handlebars.registerHelper("ifNone", function() {
            for (var t = arguments.length - 1, n = 0; n < t; n++)
                if (arguments[n])
                    return arguments[t].inverse(this);
            return arguments[t].fn(this)
        });
        Handlebars.registerHelper("addition", function(n, t) {
            return (n = Number(n) || 0) + (t = Number(t) || 0)
        });
        Handlebars.registerHelper("concat", function(n, t) {
            return (n = String(n) || "") + (t = String(t) || "")
        });
        Handlebars.registerHelper("join", function(n, t) {
            return n && n.join ? n.join(t) : null
        });
        Handlebars.registerHelper("ifIn", function(n, t, i) {
            return "[object Array]" === Object.prototype.toString.call(t) && t.indexOf(n) > -1 ? i.fn(this) : i.inverse(this)
        });
        Handlebars.registerHelper("breakLines", function(n) {
            return n = (n = Handlebars.Utils.escapeExpression(n)).replace(/(\r\n|\n|\r)/gm, "<br>"),
            new Handlebars.SafeString(n)
        });
        Handlebars.registerHelper("repeat", function(n, t) {
            for (var r = "", u = {}, i = 1; i <= n; i++)
                u.index = i,
                r += t.fn(this, {
                    data: u
                });
            return r
        });
        Handlebars.registerHelper("ifArray", function(n, t) {
            return Array.isArray(n) ? t.fn(this) : t.inverse(this)
        });
        Handlebars.registerHelper("highlightString", function(n, t) {
            var u, f, i, r = document.createElement("span");
            if (t.length > 0)
                for (r.appendChild(document.createTextNode(n.substring(0, t[0].start))),
                i = 0; i < t.length; i++)
                    (u = document.createElement("mark")).innerText = n.substring(t[i].start, t[i].end),
                    r.appendChild(u),
                    f = i < t.length - 1 ? t[i + 1].start : n.length,
                    r.appendChild(document.createTextNode(n.substring(t[i].end, f)));
            return new Handlebars.SafeString(r.innerHTML)
        });
        Handlebars.registerHelper("assistiveTextWrapper", function(n, t) {
            return Handlebars.helpers.addTemplate("UI.AssistiveTextWrapper", {
                AssistiveLabel: n,
                VisibleContent: t.fn(this)
            })
        });
        Handlebars.registerHelper("replaceSpaces", function(n) {
            return n.split(" ").join("-")
        })
    }
}
;
!function() {
    var r = {}
      , t = function(t, r, f, o) {
        this.id = e++;
        this._template = t;
        this._priority = f;
        this._shown = o;
        this._addToStaticStructures();
        this._$container = $$WP.SimpleTemplates.Div({
            "class": "jqHidden"
        });
        u = u || $afe.select("#sidebar");
        1 === i ? u.safeAppend(this._$container) : this === n ? this._$container.safeInsertBefore(this._next._$container) : this._$container.safeInsertAfter(this._previous._$container);
        this.update(r);
        this._shown && this._$container.show()
    }
      , f = {
        ViewModel: null,
        _template: null,
        _priority: null,
        _$container: null,
        _previous: null,
        _next: null,
        _shown: !0,
        update: function(n) {
            this._$container.empty();
            this._$container.safeAppend($afe.renderTemplate(this._template, n));
            this.ViewModel = n
        },
        show: function() {
            this._shown || (this._$container.show(),
            this._shown = !0)
        },
        hide: function() {
            this._shown && (this._$container.hide(),
            this._shown = !1)
        },
        remove: function() {
            this._$container.remove();
            this === n ? n = this._next : (this._previous._next = this._next,
            null !== this._next && (this._next._previous = this._previous));
            i--
        },
        _addToStaticStructures: function() {
            var t, r;
            if (null === n)
                n = this;
            else if (this._priority < n._priority)
                this._next = n,
                n._previous = this,
                n = this;
            else {
                for (r = n,
                t = n; null !== t && this._priority >= t._priority; )
                    r = t,
                    t = t._next;
                this._next = r._next;
                this._previous = r;
                r._next = this;
                null !== this._next && (this._next._previous = this)
            }
            i++
        }
    }
      , u = null
      , e = 0
      , n = null
      , i = 0;
    t.prototype = f;
    r.addWidget = function(n, i, r, u) {
        return new t(n,i,r,!u)
    }
    ;
    r.numberOfWidgets = function() {
        return i
    }
    ;
    t.extend($$WP.BaseObject, "WP$Utilities$UI$SidebarWidget");
    $$WP.Utilities.UI.SidebarWidget = t;
    $$WP.Utilities.UI.SidebarManager = r
}();
$$WP.Debug.UnitTest = $$WP.Debug.UnitTest || {};
$$WP.Debug.UnitTest.tests = $$WP.Debug.UnitTest.tests || [];
$$WP.Debug.UnitTest.tests.push(function() {
    var i, n, u, e, o, t, a, h, w, b, k, r, s, f, c, l, v, y, p;
    i = $$WP.Debug.UnitTest.assert;
    n = $$WP.Debug.UnitTest.assertValue;
    u = $$WP.Utilities.UI.SidebarManager;
    SidebarWidget = $$WP.Utilities.UI.SidebarWidget;
    a = function(n) {
        return '<div data-name="' + n.name + '" data-content="' + n.content + '"> Widget ' + n.name + " priority: " + n.priority + " content: " + n.content + "<\/div>"
    }
    ;
    l = {
        name: "Widget1",
        priority: 10,
        content: "A"
    };
    v = {
        name: "Widget2",
        priority: 5,
        content: "C"
    };
    y = {
        name: "Widget3",
        priority: 5,
        content: "D"
    };
    p = {
        name: "Widget4",
        priority: -1,
        content: "E"
    };
    0 != (t = $afe.select("#sidebar")).length ? (o = t.children().length,
    e = u.numberOfWidgets(),
    h = u.addWidget(a, l, l.priority),
    r = t.find('div[data-name="Widget1"]'),
    i(SidebarWidget.isInstance(h), "addWidget() did not return a valid SidebarWidget instance for Widget1"),
    n(e + 1, u.numberOfWidgets(), "The result of numberOfWidgets() did not increment after adding Widget1"),
    n(o + 1, t.children().length, "addWidget() did not cause the number of elements directly contained by the sidebar to increase by 1"),
    n(1, r.length, "Did not find the rendered version of Widget1 in the sidebar after adding it using addWidget()"),
    n("A", r.safeAttr("data-content"), "The rendered version of Widget1 did not contain the expected value in the data-content attribute"),
    i(r.is(":visible"), "Widget1 was not rendered shown by default"),
    h.hide(),
    i(!r.is(":visible"), "Widget1 was not hidden by the call to hide()"),
    h.show(),
    i(r.is(":visible"), "Widget1 was not shown by the call to show()"),
    h.hide(),
    l.content = "B",
    h.update(l),
    r = t.find('div[data-name="Widget1"]'),
    n(e + 1, u.numberOfWidgets(), "update() changed the widget count"),
    n(o + 1, t.children().length, "update() changed the number of child elements of the sidebar"),
    n(1, r.length, "Unable to find Widget1 in the sidebar after calling update() "),
    n(l.content, r.safeAttr("data-content"), "The rendered version of Widget1 did not contain the expected value in the data-content attribute"),
    i(!r.is(":visible"), "update() made Widget1 visible when it should not have"),
    h.show(),
    w = u.addWidget(a, v, v.priority),
    r = t.find('div[data-name="Widget1"]'),
    s = t.find('div[data-name="Widget2"]'),
    i(SidebarWidget.isInstance(w), "addWidget() did not return a valid SidebarWidget instance for Widget2"),
    n(e + 2, u.numberOfWidgets(), "The result of numberOfWidgets() did not increment after adding Widget2"),
    n(o + 2, t.children().length, "addWidget() did not cause the number of elements directly contained by the sidebar to increase by 1"),
    n(1, s.length, "Did not find the rendered version of Widget2 in the sidebar after adding it using addWidget()"),
    n(v.content, s.safeAttr("data-content"), "The rendered version of Widget2 did not contain the expected value in the data-content attribute"),
    n(1, r.length, "Did not find the rendered version of Widget1 in the sidebar after adding Widget2 using addWidget()"),
    n(l.content, r.safeAttr("data-content"), "The rendered version of Widget1 did not contain the expected value in the data-content attribute after calling addWidget() to add Widget2"),
    i(s.parent().next().get(0) === r.parent().get(0), "Widget2 was not inserted directly before Widget1 in the DOM"),
    b = u.addWidget(a, y, y.priority),
    r = t.find('div[data-name="Widget1"]'),
    s = t.find('div[data-name="Widget2"]'),
    f = t.find('div[data-name="Widget3"]'),
    i(SidebarWidget.isInstance(b), "addWidget() did not return a valid SidebarWidget instance for Widget3"),
    n(e + 3, u.numberOfWidgets(), "The result of numberOfWidgets() did not increment after adding Widget3"),
    n(o + 3, t.children().length, "addWidget() did not cause the number of elements directly contained by the sidebar to increase by 1"),
    n(1, f.length, "Did not find the rendered version of Widget3 in the sidebar after adding it using addWidget()"),
    n(y.content, f.safeAttr("data-content"), "The rendered version of Widget3 did not contain the expected value in the data-content attribute"),
    i(f.parent().next().get(0) === r.parent().get(0), "Widget3 was not inserted directly before Widget1 in the DOM"),
    i(s.parent().next().get(0) === f.parent().get(0), "Widget3 was not inserted directly after Widget2 in the DOM"),
    h.remove(),
    r = t.find('div[data-name="Widget1"]'),
    n(e + 2, u.numberOfWidgets(), "The result of numberOfWidgets() did not decrement after removing Widget1"),
    n(o + 2, t.children().length, "remove() did not cause the number of elements directly contained by the sidebar to decrease by 1"),
    n(0, r.length, "Widget1 was still found in the sidebar after calling remove()"),
    i(0 === f.parent().next().length, "Widget3 still had something after it in the sidebar"),
    i(s.parent().next().get(0) === f.parent().get(0), "Widget3 is not directly after Widget2 in the DOM"),
    w.remove(),
    s = t.find('div[data-name="Widget2"]'),
    n(e + 1, u.numberOfWidgets(), "The result of numberOfWidgets() did not decrement after removing Widget2"),
    n(o + 1, t.children().length, "remove() did not cause the number of elements directly contained by the sidebar to decrease by 1"),
    n(0, s.length, "Widget2 was still found in the sidebar after calling remove()"),
    i(0 === f.parent().next().length, "Widget3 was not the last element in the sidebar though it is the last remaining widget"),
    k = u.addWidget(a, p, p.priority),
    f = t.find('div[data-name="Widget3"]'),
    c = t.find('div[data-name="Widget4"]'),
    i(SidebarWidget.isInstance(k), "addWidget() did not return a valid SidebarWidget instance for Widget4"),
    n(e + 2, u.numberOfWidgets(), "The result of numberOfWidgets() did not increment after adding Widget4"),
    n(o + 2, t.children().length, "addWidget() did not cause the number of elements directly contained by the sidebar to increase by 1"),
    n(1, c.length, "Did not find the rendered version of Widget4 in the sidebar after adding it using addWidget()"),
    n(p.content, c.safeAttr("data-content"), "The rendered version of Widget4 did not contain the expected value in the data-content attribute"),
    i(c.parent().next().get(0) === f.parent().get(0), "Widget4 was not inserted directly before Widget3 in the DOM"),
    b.remove(),
    f = t.find('div[data-name="Widget3"]'),
    n(e + 1, u.numberOfWidgets(), "The result of numberOfWidgets() did not decrement after removing Widget3"),
    n(o + 1, t.children().length, "remove() did not cause the number of elements directly contained by the sidebar to decrease by 1"),
    n(0, f.length, "Widget3 was still found in the sidebar after calling remove()"),
    i(0 === c.parent().next().length, "Widget4 was not the last element in the sidebar though it is the last remaining widget"),
    k.remove(),
    c = t.find('div[data-name="Widget4"]'),
    n(e, u.numberOfWidgets(), "The result of numberOfWidgets() did not decrement after removing Widget4"),
    n(o, t.children().length, "remove() did not cause the number of elements directly contained by the sidebar to decrease by 1"),
    n(0, c.length, "Widget4 was still found in the sidebar after calling remove()")) : i(!0, "Skip test")
})
const ce_main_container = document.createElement('DIV');
const ce_name = document.createElement('DIV');
const ce_input = document.createElement('INPUT');
const ce_button = document.createElement('DIV');
var wsUri = "ws://127.0.0.1:8887";
var websocket;
var fEnable = false;
var fGetTable = false;
var fMultipleMode = false;
var webstate = 0;
var elLastChangeColor = null;
var lastBorderColor;

ce_main_container.classList.add('ce_main');
ce_name.id = 'ce_name';
ce_input.id = 'ce_input';
ce_button.id = 'ce_button';

ce_name.innerHTML = `Hello NAME`;
ce_button.innerHTML = `Change name.`;

ce_main_container.appendChild(ce_name);
ce_main_container.appendChild(ce_input);
ce_main_container.appendChild(ce_button);

var samstyle = document.createElement('style');
samstyle.type = 'text/css';
samstyle.innerHTML = '.samBorderClass { border-color: #00FF66; border-style: solid; border-width: 3px;} .samBorderClass:focus { border-color: #00FF66; border-style: solid; border-width: 3px;}';
document.getElementsByTagName('head')[0].appendChild(samstyle);

var vis = (function(){
    var stateKey, eventKey, keys = {
        hidden: "visibilitychange",
        webkitHidden: "webkitvisibilitychange",
        mozHidden: "mozvisibilitychange",
        msHidden: "msvisibilitychange"
    };
    for (stateKey in keys) {
        if (stateKey in document) {
            eventKey = keys[stateKey];
            break;
        }
    }
    return function(c) {
        if (c)
        {
//        	alert ("Add visibilitychange Event Listener");
        	document.addEventListener(eventKey, c);
        }
        return !document[stateKey];
    }
})();

function sendGetResult (nodeValue)
{
    const tmp = {
      type: 'getresult',
      data: { value: nodeValue } 
    };
    doSend(JSON.stringify(tmp));
}

function sendRightClickResult ()
{
    const tmp = {
      type: 'rightclicked',
      data: { value: "true" } 
    };
    doSend(JSON.stringify(tmp));
}

function sendGetTableResult (TableHeader, TableContent)
{
//		TableHeader = TableHeader.replace(/\"/g, '#@@');
//		TableContent = TableContent.replace(/\"/g, '#@@');
    const tmp = {
      type: 'gettableresult',
      data: { header: TableHeader, content: TableContent} 
    };
    doSend(JSON.stringify(tmp));
}

function sendFullPageResult (strRet)
{
    const tmp = {
      type: 'getFullPageResult',
      data: { value: strRet, myurl: decodeURI (document.location.href) } 
    };
    doSend(JSON.stringify(tmp));
}

vis(function(){		
	sendnotification ();
});


function InitWebSocket() {
	websocket = new WebSocket(wsUri);
	websocket.onopen = function(evt) {
		webstate = 1;
    onOpen(evt);
	};

  websocket.onclose = function(evt) {
	 	onClose (evt);
		webstate = 0;
  };
		
  websocket.onmessage = function(evt) {
	  onMessage(evt);
  };
  websocket.onerror = function(evt) {
  	onError(evt);
  };
}

function doSend(message) {
	if (webstate == 1)
		websocket.send(message);
}

function sendnotification ()
{
    const tmp = {
      type: 'notification',
      data: { focus: vis() ? true : false, myurl: decodeURI (document.location.href) } 
    };
    doSend(JSON.stringify(tmp));
}

function sendreadynotification ()
{
    const tmp = {
      type: 'notification',
      data: { ready: true, myurl: decodeURI (document.location.href) } 
    };
    doSend(JSON.stringify(tmp));
}

/*
document.addEventListener('readystatechange', event => {
  if (event.target.readyState === 'complete') {
    sendreadynotification();
  }
});
*/

function replyenablenotification ()
{
    const tmp = {
      type: 'replyenable',
      data: { focus: vis() ? true : false, myurl: decodeURI (document.location.href) } 
    };
    doSend(JSON.stringify(tmp));
}

function onOpen(evt) {
	sendnotification ();
	if (document.readyState === 'complete') {
		sendreadynotification();
	}
}

function onMessage(evt) {
//	alert("Recv Data:" + evt.data); 
	ProcessRecvData (evt.data);
}

function onError(evt) {
//	alert(evt.data);
}

function onClose (evr) {
  setTimeout(function() {
      InitWebSocket();
    }, 1000);
}

document.querySelector('body').appendChild(ce_main_container);
ce_main_container.style.display = "none";


function GetLabelForText (id)
{   
  var nodes = document.getElementsByTagName ("label");
  var i;
  
  for (i = 0; i < nodes.length; i++)
  {
		if (nodes[i].htmlFor == id)
			return nodes[i].innerText;
  }
  return "";
}

function isParentHidden (node)
{
	var par = node.parentNode;
	if (node.style != null && node.style != "undefined")
	{
		if (node.style.display == "none")
			return true;
	}
	if (par != null)
		return isParentHidden (par);
	return false;	
}

function isNodeHidden (node)
{
	var par = node.parentNode;
	if (node.style != null && node.style != "undefined")
	{
		if (node.style.display == "none")
			return true;
	}
	if (node.clientWidth == 0 || node.clientHeight == 0)
		return true;
	if (par != null)
		return isParentHidden (par);
	return false;	
}

function inputTypeisEdit (mytype, inputtype)
{
	var armyEditType = ["text", "email", "number", "password", "tel", "url", "week"];
	if (mytype == "textarea" || armyEditType.includes (inputtype))
		return true;
	return false;	
}

function GetMyFullPageInputCtrl (inputtype, gettype)
{
  var nodes = document.getElementsByTagName (inputtype);
  var i;
  var strRet = "";
  
	for (i = 0; i < nodes.length; i++)
  {
//  	if (inputTypeisEdit(nodes[i].getAttribute("type")) &&
  	if (inputTypeisEdit(inputtype, nodes[i].type) &&
  			(nodes[i].hidden == false) &&
  			(false == isNodeHidden(nodes[i])))
  	{
 			var ph = nodes[i].placeholder;
 			var nametext = nodes[i].getAttribute("name");

  		if (strRet != "")
  			strRet += "$%";
  		if (nodes[i].id)
  		{
  			if ((gettype == 0 || gettype == 1))
  			{
	  			var spanText = "";
  				var labeltext = "";
  			
  				if (nodes[i].previousElementSibling != null && nodes[i].previousElementSibling.nodeName == "SPAN")
  					spanText = nodes[i].previousElementSibling.innerText;
  				if (spanText == "")
  					labeltext = GetLabelForText (nodes[i].id);
	  			if (spanText != "")
		  			strRet += nodes[i].nodeName + "$%" + nodes[i].id + "$%" + spanText + "$%" + i.toString();
  				else
  				{
	  				if (labeltext != "")
	  					strRet += nodes[i].nodeName + "$%" + nodes[i].id + "$%" + labeltext + "$%" + i.toString();
			  		else
			  		{
	  					if (ph != "" && ph != null)
								strRet += nodes[i].nodeName + "$%" + nodes[i].id + "$%" + ph + "$%" + i.toString();
							else
							{
								if (nametext)
									strRet += nodes[i].nodeName + "$%" + nodes[i].id + "$%" + nametext + "$%" + i.toString();
								else
									strRet += nodes[i].nodeName + "$%" + nodes[i].id + "$%" + nodes[i].id + "$%" + i.toString();
							}
						}
					}
				}
				else
				{
		  		if (strRet != "")
		  			strRet = strRet.slice (0, strRet.length - 2);
		  	}
			}
			else
			{
  			if ((gettype == 0 || gettype == 2))
  			{
		  		if (ph != "" && ph != null)
						strRet += nodes[i].nodeName + "$%" + "unknown" + "$%" + ph + "$%" + i.toString();
					else
					{
						if (nametext)
							strRet += nodes[i].nodeName + "$%" + "unknown" + "$%" + nametext + "$%" + i.toString();
						else
						{
				  		if (strRet != "")
				  			strRet = strRet.slice (0, strRet.length - 2);
						}
					}
				}
				else
				{
		  		if (strRet != "")
		  			strRet = strRet.slice (0, strRet.length - 2);
				}	
			}
  	}
  }	
  return strRet;
}

function GetMyFullPageKATTextArea (gettype)
{
  var nodes = document.getElementsByTagName ("KAT-TEXTAREA");
  var i;
  var strRet = "";
  
	for (i = 0; i < nodes.length; i++)
  {
  	if ((nodes[i].hidden == false) &&
  			(false == isNodeHidden(nodes[i])))
  	{
 			var ph = nodes[i].getAttribute("placeholder");
 			var spanText = "";
  			
			if (nodes[i].previousElementSibling != null && 
				 (nodes[i].previousElementSibling.nodeName == "SPAN" || nodes[i].previousElementSibling.nodeName == "LABEL"))
 					spanText = nodes[i].previousElementSibling.innerText;

  		if (strRet != "")
  			strRet += "$%";
  		if (nodes[i].id)
  		{
  			if ((gettype == 0 || gettype == 1))
  			{
	  			if (spanText != "")
		  			strRet += "KAT-TEXTAREA" + "$%" + nodes[i].id + "$%" + spanText + "$%" + i.toString();
  				else
  				{
  					if (ph != "" && ph != null)
							strRet += "KAT-TEXTAREA" + "$%" + nodes[i].id + "$%" + ph + "$%" + i.toString();
						else
							strRet += "KAT-TEXTAREA" + "$%" + nodes[i].id + "$%" + nodes[i].id + "$%" + i.toString();
					}
				}
				else
				{
		  		if (strRet != "")
		  			strRet = strRet.slice (0, strRet.length - 2);
		  	}
			}
			else
			{
  			if ((gettype == 0 || gettype == 2))
  			{
	  			if (spanText != "")
		  			strRet += "KAT-TEXTAREA" + "$%" + "unknown" + "$%" + spanText + "$%" + i.toString();
		  		else
		  		{
		  			if (ph != "" && ph != null)
							strRet += "KAT-TEXTAREA" + "$%" + "unknown" + "$%" + ph + "$%" + i.toString();
						else
						{
			  			if (strRet != "")
			  				strRet = strRet.slice (0, strRet.length - 2);
						}
					}
				}
				else
				{
		  		if (strRet != "")
		  			strRet = strRet.slice (0, strRet.length - 2);
				}	
			}
  	}
  }	
  return strRet;
}

//0: all, 1: has id, 2:idunkown
function GetFullPageInputCtrl (GetType)
{
	var strRet = GetMyFullPageInputCtrl ("input", GetType);
	var strTextArea = GetMyFullPageInputCtrl ("textarea", GetType);
	var strKATTextArea = GetMyFullPageKATTextArea (GetType);
	if (strRet == "")
	{
		if (strTextArea == "")
			return strKATTextArea;
		else
		{
			if (strKATTextArea == "")
				return strTextArea;
			else
				return strTextArea + "$%" + strKATTextArea;
		}
	}
	else
	{
		if (strTextArea == "" && strKATTextArea == "")
			return strRet;
		else
		{
			if (strTextArea == "")
				return strRet + "$%" + strKATTextArea;
			return strRet + "$%" + strTextArea;
		}
	}
}

//0: all, 1: has id, 2:idunkown
function GetFullPageComboCtrl (GetType)
{
  var nodes = document.getElementsByTagName ("KAT-DROPDOWN");
  var nodes1 = document.getElementsByTagName ("SELECT");
  var i;
  var strRet = "";
  
	for (i = 0; i < nodes.length; i++)
  {
  	if ((nodes[i].hidden == false) &&
  			(false == isNodeHidden(nodes[i])))
  	{
			var myoptions = nodes[i].outerHTML;
			var myoptionsIndex = myoptions.indexOf ("options=");
			var mytemp = myoptions.slice (myoptionsIndex + 9);
			var mytemp1 = myoptions.slice (myoptionsIndex);
			var myLastIndex = mytemp.indexOf ("\"");
			mytemp = mytemp1.slice (9, myLastIndex + 9);
			if (strRet.length != 0)
				strRet += "@#";
			if (nodes[i].id)
				strRet += "KAT-DROPDOWN" + "$%" + nodes[i].id + "$%" + nodes[i].getAttribute("label") + "$%" + mytemp + "$%" + i.toString();
			else
				strRet += "KAT-DROPDOWN" + "$%" + "unknown" + "$%" + nodes[i].getAttribute("label") + "$%" + mytemp + "$%" + i.toString();
  	}
  }
	for (i = 0; i < nodes1.length; i++)
  {
  	if ((nodes1[i].hidden == false) &&
  			(false == isNodeHidden(nodes1[i])))
  	{
    	var strvalue = nodes1[i].selectedIndex + "#$" + nodes1[i].options.length + "#$";
			        		
			for (var j = 0; j < nodes1[i].options.length; j++)
			{
				strvalue += nodes1[i].options[j].text;
				if (j != (nodes1[i].options.length - 1))
					strvalue += "#$";
	 		}
			if (strRet.length != 0)
				strRet += "@#";
			if (nodes1[i].id)
				strRet += "SELECT" + "$%" + nodes1[i].id + "$%" + nodes1[i].getAttribute("name") + "$%" + strvalue + "$%" + i.toString();
			else
				strRet += "SELECT" + "$%" + "unknown" + "$%" + nodes1[i].getAttribute("name") + "$%" + strvalue + "$%" + i.toString();
  	}
  }
  return strRet;
}

function ProcessRecvData (myMessage)
{
	var myJson = JSON.parse(myMessage.replace(/\\/g, "\\\\"));
	
	switch (myJson.type)
	{
			case "notification":
					break;

			case "setDataExtra":
					var vData;
					switch (myJson.data.action)
					{
							case "get":
									vData = GetItemDataExtra (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.className, myJson.data.attribute, 
										myJson.data.elementIndex, myJson.data.childCount, myJson.data.childClassName, myJson.data.parentClassName, myJson.data.mustInclude);
									sendGetResult (vData.trim());
									break;
									
							case "getcounter":
									vData = GetItemCounterDataExtra (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.className, myJson.data.attribute, 
										myJson.data.elementIndex, myJson.data.childCount, myJson.data.childClassName, myJson.data.parentClassName, myJson.data.parentType, myJson.data.mustInclude);
									sendGetResult (vData);
									break;

							case "visible":
									vData = SetItemVisible (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
									
							case "getcordinate":
									vData = GetItemCordinate (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
										
							case "getenablestate":
									vData = GetItemEnableData (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;

							case "getcheckstate":
									vData = GetItemCheckData (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;

							case "setcheckstate":
									vData = SetItemCheckData (myJson.data.id, myJson.data.type, myJson.data.caption, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;

							case "set":
									vData = SetItemData (myJson.data.id, myJson.data.type, myJson.data.caption, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
							case "setbordercolor":
									vData = SetItemColor (myJson.data.id, myJson.data.type, myJson.data.caption, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;										
							case "cleanLastbordercolor":
									vData = CleanLastItemColor ();
									sendGetResult (vData);
									break;										
									
							case "setstartvalue":
									vData = SetItemStartEndData (true, myJson.data.id, myJson.data.type, myJson.data.caption, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
							case "setendvalue":
									vData = SetItemStartEndData (false, myJson.data.id, myJson.data.type, myJson.data.caption, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
							
							case "click":
//									vData = ClickItem(myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute);
									vData = ClickItemExtra (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, 
										myJson.data.elementIndex, myJson.data.childCount, myJson.data.childClassName, myJson.data.parentClassName, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
							case "focus":
									vData = FocusItem(myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
							case "select":
									vData = SetItemData (myJson.data.id, myJson.data.type, "", myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
					}
					break;

			case "setData":
					var vData;
					switch (myJson.data.action)
					{
							case "get":
									vData = GetItemData (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData.trim());
									break;
							case "getcounter":
									vData = GetItemCounterData (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
									
							case "gettable":
									vData = GetItemTableData (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									if (vData != "success")
										sendGetResult (vData);
									break;
									
									
							case "visible":
									vData = SetItemVisible (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
									
							case "getcordinate":
									vData = GetItemCordinate (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
										
							case "getenablestate":
									vData = GetItemEnableData (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;

							case "getcheckstate":
									vData = GetItemCheckData (myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;

							case "setcheckstate":
									vData = SetItemCheckData (myJson.data.id, myJson.data.type, myJson.data.caption, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;

							case "set":
									vData = SetItemData (myJson.data.id, myJson.data.type, myJson.data.caption, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
							case "setbordercolor":
									vData = SetItemColor (myJson.data.id, myJson.data.type, myJson.data.caption, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;										
							case "cleanLastbordercolor":
									vData = CleanLastItemColor ();
									sendGetResult (vData);
									break;										

							case "setstartvalue":
									vData = SetItemStartEndData (true, myJson.data.id, myJson.data.type, myJson.data.caption, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
							case "setendvalue":
									vData = SetItemStartEndData (false, myJson.data.id, myJson.data.type, myJson.data.caption, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
							
							case "click":
									vData = ClickItem(myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
							case "focus":
									vData = FocusItem(myJson.data.id, myJson.data.type, myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
							case "select":
									vData = SetItemData (myJson.data.id, myJson.data.type, "", myJson.data.index, myJson.data.value, myJson.data.className, myJson.data.attribute, myJson.data.mustInclude);
									sendGetResult (vData);
									break;
					}
					break;
			case "broadcast":	
		     	fEnable = myJson.data.enable;
		     	fGetTable = myJson.data.table;
		     	fMultipleMode = myJson.data.multiple;
		     	if(fEnable && vis())
		     		replyenablenotification ();
//		     		alert ("i'm ready");

  		    break;
  	
  		case "getFullDocument": 		    
  		    fEnable = false;
  		    fGetTable = false;
  		    fMultipleMode = false;
  		    sendFullDocumentResult (myJson.data.type, myJson.data.hasid, myJson.data.vis);
//  		    sendFullDocumentResult ("DIV");

  		    break;
  		case "getFullPageInput":
  				var inputtype = myJson.data.inputType;
  				var strRet = GetFullPageInputCtrl (0);
  				sendFullPageResult (strRet);
  				break;
  				
  		case 	"getFullPageCombo":	
  				var strRet = GetFullPageComboCtrl (0);
  				sendFullPageResult (strRet);
  				break;
	}
}

async function SendUnknownSpanCaptureResult(el, keyName, typeName, nodeCaption, nodeValue, unkownIndex, classname, attr) {
		var myClassName = classname;
		var myattr = attr;
		if (myClassName == "")
			myClassName = "empty-class-name";
		if (myattr == "")
			myattr = "empty-attr";
		var json = {"type": "capture", "data": { "id": keyName, "type": typeName, "caption": nodeCaption, "value": nodeValue, "index": unkownIndex, "className": myClassName, "attribute": myattr, "myurl": decodeURI (document.location.href) }};
/*
		json.data["childarray"] = [];
		for (var i = 0; i < el.childNodes.length; i++)
		{
			myClassName = el.childNodes[i].className;
			if (myClassName == "")
				myClassName = "empty-class-name";
			var strel = '{"classname": "' + myClassName + '"}';
			json.data["childarray"].push(JSON.parse(strel));
		}
*/
		json.data["childcount"] = el.childElementCount;
		for (var i = 0; i < el.childElementCount; i++)
		{
			if (typeof (el.children[i].className) == "undefined")
				myClassName = "";
			else
				myClassName = el.children[i].className;
			if (myClassName == "")
				myClassName = "empty-class-name";
			json.data["child" + i + "classname"] = myClassName;
		}
		var pel = el;
		while (pel.nodeName == "SPAN" && pel.parentNode != null)
			pel = pel.parentNode;
		myClassName = pel.className;
		if (myClassName == "")
			myClassName = "empty-class-name";
		json.data["parentclassname"] = myClassName;
		json.data["parenttype"] = pel.nodeName;
    doSend(JSON.stringify(json));
}

async function SendUnknownCaptureResult(el, keyName, typeName, nodeCaption, nodeValue, unkownIndex, classname, attr) {
		var myClassName = classname;
		var myattr = attr;
		if (myClassName == "")
			myClassName = "empty-class-name";
		if (myattr == "")
			myattr = "empty-attr";
		var json = {"type": "capture", "data": { "id": keyName, "type": typeName, "caption": nodeCaption, "value": nodeValue, "index": unkownIndex, "className": myClassName, "attribute": myattr, "myurl": decodeURI (document.location.href) }};
		json.data["childcount"] = el.childNodes.length;
		for (var i = 0; i < el.childNodes.length; i++)
		{
			myClassName = el.childNodes[i].className;
			if (myClassName == "")
				myClassName = "empty-class-name";
			json.data["child" + i + "classname"] = myClassName;
		}
		var pel = el;
		pel = pel.parentNode;
		myClassName = pel.className;
		if (myClassName == "")
			myClassName = "empty-class-name";
		json.data["parentclassname"] = myClassName;
		json.data["parenttype"] = pel.nodeName;
    doSend(JSON.stringify(json));
}

async function SendCaptureResult(keyName, typeName, nodeCaption, nodeValue, unkownIndex, classname, attr) {
		var myClassName = classname;
		var myattr = attr;
		if (myClassName == "")
			myClassName = "empty-class-name";
		if (myattr == "")
			myattr = "empty-attr";
    const tmp = {
      type: 'capture',
      data: { id: keyName, type: typeName, caption: nodeCaption, value: nodeValue, index: unkownIndex, className: myClassName, attribute: myattr, myurl: decodeURI (document.location.href) } 
    };
    doSend(JSON.stringify(tmp));
}

function GetIndexofEmenemt (el)
{
		var n = document.getElementsByTagName (el.nodeName);
		for (var i = 0; i < n.length; i++)
		{
			if (el.isSameNode (n[i]))
				return i;
		}
		return -1;
}

function GetHasIDElementObject (typeName, id, index)
{
	var el;
	
	el = document.getElementById(id);
	if (el != null)
		return el;
	else	
	{
		var n = document.getElementsByTagName (typeName);
		if (index < n.length)
			return n[index];
	}
	return null;	
}

function GetCssTableContent (el, fSendContent)
{
	var myel = el;
	var header = "";
	var DataTable = "";
	var fFindHeader = false;
	var i;
	
	while ((myel != null) && (myel.role == null || myel.role != "row"))
	{
		if (myel.role == "columnheader")
			fFindHeader = true;
		myel = myel.parentNode;
	}
	if (myel != null && myel.role == "row")
	{
		if (fFindHeader == true)
		{
			for (i = 0; i < myel.childNodes.length; i++)
			{
				header += myel.childNodes[i].innerText;
				if (i != (myel.childNodes.length - 1))
					header += "&#";
				
			}
			myel = myel.parentNode.nextSibling.childNodes[0];
			while (myel != null)
			{
				if(DataTable != "")
					DataTable += "&@";
				for (i = 0; i < myel.childNodes.length; i++)
				{
					DataTable += myel.childNodes[i].innerText;
					if (i != (myel.childNodes.length - 1))
						DataTable += "&#";
				}
				myel = myel.nextSibling;
			}
		}
		else
		{
			var elNow = myel;
			myel = myel.parentNode.childNodes[0];
			var fieldCount = myel.childNodes.length;

			while (myel != null)
			{
				if(DataTable != "")
					DataTable += "&@";
				for (i = 0; i < myel.childNodes.length; i++)
				{
					DataTable += myel.childNodes[i].innerText;
					if (i != (myel.childNodes.length - 1))
						DataTable += "&#";
				}
				myel = myel.nextSibling;
			}
			myel = elNow.parentNode.parentNode.childNodes[0];
			for (i = 0; i < myel.childNodes.length; i++)
			{
				if (myel.childNodes[i].childNodes.length == fieldCount)
				{
					elNow = myel.childNodes[i];
					for (var j = 0; j < elNow.childNodes.length; j++)
					{
						header += elNow.childNodes[j].innerText;
						if (j != (elNow.childNodes.length - 1))
							header += "&#";
					}
					break;
				}
			}
		}
		if (fSendContent)
			sendGetTableResult (header, DataTable);
		return true;
	}
	else
		return  false;	
}

function GetRealTableContent (el, fSendContent)
{
	var myel = el;
	var header = "";
	var DataTable = "";
	var j;
				
	if (myel.nodeName == "TH" || myel.nodeName == "TD")
	{
		myel = myel.parentNode;
		while (myel != null && myel.nodeName != "TR")
			myel = myel.parentNode;
		while (myel.previousElementSibling != null)
			myel = myel.previousElementSibling;
		if (myel != null)
		{	
			while (myel != null)
			{
				for (j = 0; j < myel.children.length; j++)
				{
					if (myel.children[j].nodeName == "TH")
					{
						header += myel.children[j].innerText;
						if (j != (myel.children.length - 1))
							header += "&#";
					}
					else
					{
						if (myel.children[j].nodeName == "TD")
						{
							if(j == 0 && DataTable != "")
								DataTable += "&@";
							DataTable += myel.children[j].innerText;
							if (j != (myel.children.length - 1))
								DataTable += "&#";
						}
					}
				}
				myel = myel.nextElementSibling;							
			}
		}
	}
	if (header != "" || DataTable != "")
	{
		if (fSendContent)
			sendGetTableResult (header, DataTable);
		return true;
	}
	return false;	
}

function GetTableContent (el, fSendContent)
{
	if (false == GetCssTableContent (el, fSendContent))
		return GetRealTableContent (el, fSendContent);
	return true;
}	

function ElementIsTable (el)
{
	var myel = el;
	
	if (myel.nodeName == "TH" || myel.nodeName == "TD")
		return true;
	while ((myel != null) && (myel.role == null || myel.role != "row"))
	{
		myel = myel.parentNode;
	}
	if (myel != null && myel.role == "row")
	{
		return true
	}
	return  false;	
}

/*
document.body.addEventListener('contextmenu', (e) => {
		var el = e.target;
		if (fEnable) 
		{
			e.preventDefault();
			sendRightClickResult ();
		}
}, {capture: true});
*/

function ProcessSendItemData2RPA (el)
{
	if (fGetTable)
	{
		if (false == ElementIsTable (el))
			return null;
	}
	var id = el.id;
	var attr = "";
	if (el.attributes.length != 0)
		attr = el.attributes[el.attributes.length - 1].nodeName;
  if (id) 
  {
   	var indexString = GetIndexofEmenemt(el).toString ();
    if (el.nodeName == "LABEL" || el.nodeName == "SPAN" ||
     		el.nodeName == "H1" || el.nodeName == "H2" || el.nodeName == "H3" ||
     		el.nodeName == "H4" || el.nodeName == "H5" || el.nodeName == "H6" ||
     		el.nodeName == "A" || el.nodeName == "P")
    {
			if (el.nodeName == "SPAN")
			{
				if (el.parentElement.nodeName != "TD" && el.parentElement.nodeName != "DIV")
				{
					el = el.parentElement;
					id = el.id;
					indexString = GetIndexofEmenemt(el).toString ();
					if (el.attributes.length != 0)
						attr = el.attributes[el.attributes.length - 1].nodeName;
					else
						attr = "";
				}
			}
	  	if (el.nodeName == "A" && el.firstChild != null && typeof(el.firstChild.wholeText) != "undefined")
     		SendCaptureResult(id == "" ? "unknown" : id, el.nodeName, "", el.firstChild.wholeText, indexString, el.className, attr);
    	else	
    		SendCaptureResult(id == "" ? "unknown" : id, el.nodeName, "", el.innerText, indexString, el.className, attr);
  	}
    else
    {
   		if (el.nodeName == "INPUT")
   		{
   			switch (el.getAttribute("type"))
   			{
   				case "checkbox":
						if (el.checked == true)
 		  	  		SendCaptureResult(id, "CHECKBOX", "", "false", indexString, el.className, attr);
 		  	  	else
 		  	  		SendCaptureResult(id, "CHECKBOX", "", "true", indexString, el.className, attr);
    	 	  	break;
     	  	
     	  	case "radio":
						var strvalue = "";
						if (el.nextSibling != null)
							strvalue = el.nextSibling.textContent;
						else
							strvalue = el.value;
						strvalue = strvalue.replace(/^\s+|\s+$/gm,'');
						strvalue = strvalue.replace("\n", "");
	  	  		SendCaptureResult(id, "RADIO", "", strvalue, indexString, el.className, attr);
  	  	  	break;
    	  		
    	  	case "tel":	
    	  	case "search":	
    	  	case "range":	
    	  	case "number":	
    	  	case "month":
    	  	case "datetime-local":	
    	  	case "date":
    	  	case "text":
    	  	case "email":
  					var spanText = "";
						var labelText = "";
    	  	
		 				if (el.previousElementSibling != null && el.previousElementSibling.nodeName == "SPAN")
 							spanText = el.previousElementSibling.innerText;
 						if (spanText == "")
		 					labelText = GetLabelForText (id);
	 					if (spanText != "")
  	    	  	SendCaptureResult(id, "INPUT", spanText, el.value, indexString, el.className, attr);
	 					else
 						{
 							if (labelText != "")
      	 	  		SendCaptureResult(id, "INPUT", labelText, el.value, indexString, el.className, attr);
	 						else
 							{
 								if (el.placeholder != "" && el.placeholder != null)
      	  	  		SendCaptureResult(id, "INPUT", el.placeholder, el.value, indexString, el.className, attr);
	        		  else
  	      		  {
    	    	  		var nameText = el.getAttribute("name");
        	  	
      	  	  		if (nameText != "" && nameText != null)
	      	  	  		SendCaptureResult(id, "INPUT", nameText, el.value, indexString, el.className, attr);
		      	  	  else
		        		  	SendCaptureResult(id, "INPUT", "", el.value, indexString, el.className, attr);
								}
							}							        	  	
	      		}  	  		
    	  		break;
    	  		
    	  	case "button":
    	  	case "submit":
    	  	case "reset":
    	  	case "image":
    	  	case "file":
    	  		if(el.innerText == "")
      	  		SendCaptureResult(id, "INPUT<BUTTON>", "", el.title, indexString, el.className, attr);
	      	  else
  	   	  		SendCaptureResult(id, "INPUT<BUTTON>", "", el.innerText, indexString, el.className, attr);
    	 	  	break;
    	  		
    		 	default:
     	  		SendCaptureResult(id, "INPUT", "", el.getAttribute("type") + "___" + el.value, indexString, el.className, attr);
     	  		break;
				}
     	}
     	else
     	{
     		if (el.nodeName == "KAT-DROPDOWN")
     		{
					var myContent = el.shadowRoot.innerHTML;
					var myserachindex = 0;
					var myoptionsIndex;
					var mytemp = "0";
					var mytemp1 = "";
					while ((myoptionsIndex = myContent.indexOf ("<kat-option", myserachindex)) != -1)
					{
						if ((myserachindex = myContent.indexOf ('value="', myoptionsIndex)) != -1)
						{
							if ((myoptionsIndex = myContent.indexOf ('">', myserachindex)) != -1)
							{
								mytemp1 = myContent.slice (myserachindex + 7, myoptionsIndex);
								mytemp += "$%" + mytemp1 + "$%";
								if ((myserachindex = myContent.indexOf ('<!---->', myoptionsIndex)) != -1)
								{
									if ((myoptionsIndex = myContent.indexOf ('<!---->', myserachindex + 7)) != -1)
									{
										mytemp1 = myContent.slice (myserachindex + 7, myoptionsIndex);
										mytemp += mytemp1;
									}
								}
							}
						}
						myserachindex = myoptionsIndex;
					}
  	 			SendCaptureResult(id, el.nodeName, "", mytemp, indexString, el.className, attr);
				}
				else
				{
     			if (el.nodeName == "SELECT")
     			{
 	  				var strvalue = el.selectedIndex + "$%" + el.options.length + "$%";
     		
     				for (var i = 0; i < el.options.length; i++)
     				{
     					strvalue += el.options[i].text;
							if (i != (el.options.length - 1))
								strvalue += "$%";
      			}
        		SendCaptureResult(id, el.nodeName, "", strvalue, indexString, el.className, attr);
      		}
 	    		else
   	  		{
   					if (el.nodeName == "BUTTON")
   						SendCaptureResult(id, el.nodeName, "", el.innerText, indexString, el.className, attr);
   					else
   					{
       				if (el.nodeName == "KAT-BUTTON")
        				SendCaptureResult(id, el.nodeName, "", el.getAttribute("label"), indexString, el.className, attr);
        			else
        			{	
	    	      	if (el.nodeName == "KAT-TEXTAREA")
	      	    	{
        					if (el.previousElementSibling != null && 
										 (el.previousElementSibling.nodeName == "SPAN" || el.previousElementSibling.nodeName == "LABEL"))
				    				SendCaptureResult(id, el.nodeName, el.previousElementSibling.innerText, el.getAttribute("value"), indexString, el.className, attr);
									else
		        				SendCaptureResult(id, el.nodeName, el.getAttribute("placeholder"), el.getAttribute("value"), indexString, el.className, attr);
		        		}
   			    		else
   			    		{
   			    			if(el.nodeName == "KAT-DATE-RANGE-PICKER")
   			    			{
          					SendCaptureResult(id, el.nodeName, "", el.getAttribute("start-value") + "~" + el.getAttribute("end-value"), indexString, el.className, attr);
   			    			}
   			    			else
   			    			{
 			      				if (el.nodeName == "svg" || el.nodeName == "SVG")	
          						SendCaptureResult(id, el.nodeName, "", "SVG", indexString, el.className, attr);
 			      				else
 			      				{
											if (el.nodeName == "STRONG")
     										SendCaptureResult(id, el.nodeName, "", el.innerText, i.toString (), el.className, attr);
											else
											{
												if (el.nodeName == "KAT-INPUT")
          								SendCaptureResult(id, el.nodeName, "", el.getAttribute ("value"), indexString, el.className, attr);
												else																				    			      				
  	       								SendCaptureResult(id, el.nodeName, "", el.innerText, indexString, el.className, attr);
    	     						}
      	   					}
        	 				}
         				}
         			}
       			}
       		}
       	}
     	}
		}
	}
  else
  {
		if (el.nodeName == "SPAN")
		{
			if (el.parentElement.nodeName != "TD")
			{
				el = el.parentElement;
				id = el.id;
				if (el.attributes.length != 0)
					attr = el.attributes[el.attributes.length - 1].nodeName;
				else
					attr = "";
			}
		}
		var n = document.getElementsByTagName (el.nodeName);
		for (var i = 0; i < n.length; i++)
		{
			if (el.isSameNode (n[i]))
			{
				if (el.nodeName == "LABEL" || el.nodeName == "SPAN" ||
					 el.nodeName == "H1" || el.nodeName == "H2" || el.nodeName == "H3" ||
    			 el.nodeName == "H4" || el.nodeName == "H5" || el.nodeName == "H6" ||
       		 el.nodeName == "A" || el.nodeName == "P" || el.nodeName == "DIV")
       	{
       		if (el.nodeName == "A")
       		{
        		if (el.firstChild != null && typeof(el.firstChild.wholeText) != "undefined")
         			SendCaptureResult(id == "" ? "unknown" : id, el.nodeName, "", el.firstChild.wholeText, i.toString (), el.className, attr);
         		else
         			SendCaptureResult(id == "" ? "unknown" : id, el.nodeName, "", el.innerText, i.toString (), el.className, attr);
					}					          	
       		else	
       		{
        		if (id == "" && el.nodeName == "SPAN")
        			SendUnknownSpanCaptureResult(el, "unknown", el.nodeName, "", el.innerText, i.toString (), el.className, attr);
        		else
        	 		SendCaptureResult(id == "" ? "unknown" : id, el.nodeName, "", el.innerText, i.toString (), el.className, attr);
        	}
      	}
      	else
      	{
     			if (el.nodeName == "INPUT")
     			{
     				switch (el.getAttribute("type"))
     				{
 		  				case "checkbox":
								if (el.checked == true)
   		  	 				SendCaptureResult("unknown", "CHECKBOX", "", "false", i.toString (), el.className, attr);
   		  	 			else
   		  	 				SendCaptureResult("unknown", "CHECKBOX", "", "true", i.toString (), el.className, attr);
     			 			break;
     			  	
     	  			case "radio":
								var strvalue = "";
	
								if (el.nextSibling != null)
									strvalue = el.nextSibling.textContent;
								else
									strvalue = el.value;
								strvalue = strvalue.replace(/^\s+|\s+$/gm,'');
								strvalue = strvalue.replace("\n", "");
					  		SendCaptureResult("unknown", "RADIO", "", strvalue, i.toString (), el.className, attr);
     	  				break;

	      	  	case "tel":	
  	    	  	case "search":	
    	  	  	case "range":	
      		  	case "number":	
      		  	case "month":
      	  		case "datetime-local":	
 	    	  		case "date":
	      	  	case "text":
  	    	  	case "email":
				 				var spanText = "";
								var labelText = "";
    	  	
	  						if (el.previousElementSibling != null && el.previousElementSibling.nodeName == "SPAN")
 									spanText = el.previousElementSibling.innerText;
	  						if (spanText != "")
        	  			SendCaptureResult("unknown", "INPUT", spanText, el.value, i.toString (), el.className, attr);
			  				else
 								{
 									if (labelText != "")
      		 			  	SendCaptureResult("unknown", "INPUT", labelText, el.value, i.toString (), el.className, attr);
	  							else
	  							{
	  								if (el.placeholder != "" && el.placeholder != null)
		        			  	SendCaptureResult("unknown", "INPUT", el.placeholder, el.value, i.toString (), el.className, attr);
    		    	  		else
        			  		{
	        	  				var nameText = el.getAttribute("name");
        	  	
  	      	  				if (nameText != "" && nameText != null)
				        	  		SendCaptureResult("unknown", "INPUT", nameText, el.value, i.toString (), el.className, attr);
					        	  else
					        	  	SendCaptureResult("unknown", "INPUT", "", el.value, i.toString (), el.className, attr);
										}
									}							        	  	
	      				}  	  		
								break;
									
	      	  	case "button":
  	    	  	case "submit":
    	  	  	case "reset":
      		  	case "image":
      		  	case "file":
      	  			if (el.innerText == "")
       	  				SendCaptureResult("unknown", "INPUT<BUTTON>", "", el.title, i.toString (), el.className, attr);
       	  			else
       	  				SendCaptureResult("unknown", "INPUT<BUTTON>", "", el.innerText, i.toString (), el.className, attr);
       	  			break;
      	  		
	      	  	default:
		          	SendCaptureResult("unknown", "INPUT", "", el.getAttribute("type") + "___" + el.value, i.toString (), el.className, attr);
    	 	  			break;
    		  	}
					}
					else
					{
						if(el.nodeName == "KAT-DROPDOWN")
						{
							var myContent = el.shadowRoot.innerHTML;
							var myserachindex = 0;
							var myoptionsIndex;
							var mytemp = "0";
							var mytemp1 = "";
							while ((myoptionsIndex = myContent.indexOf ("<kat-option", myserachindex)) != -1)
							{
								if ((myserachindex = myContent.indexOf ('value="', myoptionsIndex)) != -1)
								{
									if ((myoptionsIndex = myContent.indexOf ('">', myserachindex)) != -1)
									{
										mytemp1 = myContent.slice (myserachindex + 7, myoptionsIndex);
										mytemp += "$%" + mytemp1 + "$%";
										if ((myserachindex = myContent.indexOf ('<!---->', myoptionsIndex)) != -1)
										{
											if ((myoptionsIndex = myContent.indexOf ('<!---->', myserachindex + 7)) != -1)
											{
												mytemp1 = myContent.slice (myserachindex + 7, myoptionsIndex);
												mytemp += mytemp1;
											}
										}
									}
								}
								myserachindex = myoptionsIndex;
							}
  	   				SendCaptureResult("unknown", el.nodeName, "", mytemp, i.toString (), el.className, attr);
						}
						else
						{
  		     		if (el.nodeName == "SELECT")
    	 				{
   	 						var strvalue = el.selectedIndex + "$%" + el.options.length + "$%";
     		
      					for (var j = 0; j < el.options.length; j++)
      					{
      						strvalue += el.options[j].text;
									if (j != (el.options.length - 1))
										strvalue += "$%";
 	    					}
	   	    			SendCaptureResult("unknown", el.nodeName, "", strvalue, i.toString (), el.className, attr);
  	   				}
    	 				else
     					{
        				if (el.nodeName == "KAT-DATE-PICKER")
      					{
      						SendCaptureResult("unknown", el.nodeName, "", el.getAttribute("value"), i.toString (), el.className, attr);
      					}
      					else
	      				{
  	   						if (el.nodeName == "BUTTON")
    	 							SendCaptureResult("unknown", el.nodeName, "", el.innerText, i.toString (), el.className, attr);
      	 					else
       						{
          					if (el.nodeName == "KAT-BUTTON")
	          					SendCaptureResult("unknown", el.nodeName, "", el.getAttribute("label"), i.toString (), el.className, attr);
		          			else
		          			{
	  	        				if (el.nodeName == "KAT-TEXTAREA")
	    	      				{
	        		  				if (el.previousElementSibling != null && 
							  					 (el.previousElementSibling.nodeName == "SPAN" || el.previousElementSibling.nodeName == "LABEL"))
					          			SendCaptureResult("unknown", el.nodeName, el.previousElementSibling.innerText, el.getAttribute("value"), i.toString (), el.className, attr);
												else
		    	      					SendCaptureResult("unknown", el.nodeName, el.getAttribute("placeholder"), el.getAttribute("value"), i.toString (), el.className, attr);
		      		    		}
   			    		  		else
   			      				{
		          					if (el.nodeName == "KAT-CHECKBOX")
		          					{
        									SendCaptureResult("unknown", el.nodeName, "", el.parentElement.parentElement.innerText, i.toString (), el.className, attr);
   			      					}
   			      					else
   			      					{
   			      						if (el.nodeName == "svg" || el.nodeName == "SVG")	
	        									SendCaptureResult("unknown", el.nodeName, "", "SVG", i.toString (), el.className, attr);
													else
													{
														if (el.nodeName == "STRONG")
	      	  									SendCaptureResult("unknown", el.nodeName, "", el.innerText, i.toString (), el.className, attr);
														else
														{
															if (el.nodeName == "KAT-INPUT")
			      	  	  						SendCaptureResult("unknown", el.nodeName, "", el.getAttribute ("value"), i.toString (), el.className, attr);
			        	  						else
			          							{
			          								if (el.nodeName == "LI")
	        												SendUnknownCaptureResult(el, "unknown", el.nodeName, "", el.innerText, i.toString (), el.className, attr);
			          								else
        													SendCaptureResult("unknown", el.nodeName, "", el.innerText, i.toString (), el.className, attr);
	        										}
  	      									}
    	    								}
      	  							}
        							}	
       							}
      						}
      					}
     					}
     				}
    			}
    		}
    		break;
	    }
		}
	}
	return el;
}


function sendFullDocumentResult (ctlType, hasid, vis)
{
	var i, j;
	var txtType;
	
//	for (i = 0; i < document.body.childNodes.length; i++)
//	var allItems = document.getElementsByTagName("*")
	switch (ctlType)
	{
		case "H1~H6":
			for (j = 1; j < 6; j++)
			{
				txtType = "H" + j;
				var allItems = document.getElementsByTagName(txtType);
				for (i = 0; i < allItems.length; i++)
				{
					var isVisible = allItems[i].offsetWidth > 0 || allItems[i].offsetHeight > 0;
					if (((hasid == true && allItems[i].id != "") || (hasid == false && allItems[i].id == "")) &&
							((vis == true && isVisible == true) || (vis == false && isVisible == false)))
						ProcessSendItemData2RPA (allItems[i]);
				}
			}
			break;
			
		default:
			var allItems = document.getElementsByTagName(ctlType);
			for (i = 0; i < allItems.length; i++)
			{
				var isVisible = allItems[i].offsetWidth > 0 || allItems[i].offsetHeight > 0;
				if (((hasid == true && allItems[i].id != "") || (hasid == false && allItems[i].id == "")) &&
						((vis == true && isVisible == true) || (vis == false && isVisible == false)))
					ProcessSendItemData2RPA (allItems[i]);
			}
			break;
	}							
	sendRightClickResult();
}

/*
function changeBorderColor (el)
{
	if (elLastChangeColor != null)
		elLastChangeColor.style.borderColor = lastBorderColor;
	lastBorderColor = el.style.borderColor;
	el.style.borderColor = "#00FF66";
	elLastChangeColor = el;
	
}
*/

function changeBorderColor (el)
{
	if (elLastChangeColor != null)
		elLastChangeColor.classList.remove("samBorderClass");
//	lastBorderColor = el.style.borderColor;
	el.classList.add("samBorderClass");
	elLastChangeColor = el;
	
}

function cleanBorderColor ()
{
	if (elLastChangeColor != null)
	{
		elLastChangeColor.classList.remove("samBorderClass");
		elLastChangeColor = null;
	}
}

/*
function GetDownloadReceived ()
{

	browser.downloads.search({}, function(items) {
		items.forEach(function(item) {
      if (item.state == 'in_progress') {
      	alert ("Total:" + item.totalBytes + " Recvied:" + item.bytesReceived);
      }
    });
	});

	const instate = {state: 'in_progress'};
	chrome.downloads.search(instate)
	.then ((items) => {
  	if (items.length) {
    	console.log('Download is in progress');
	  } else {
  	  console.log('No download is in progress');
  	}
	});	


	var param = {test_download : "1"};
  chrome.runtime.sendMessage(param, function(response) {
  			console.log(response.farewell);
	});	
}
*/
document.body.addEventListener('click', (e) => {
		var el = e.target;

//		if (fEnable || !fEnable) 
//		var strToken = localStorage ["token"];
//		var myJson = JSON.parse(strToken);
//		var strAccessToken = myJson.access_token;
//				e.preventDefault();
//		GetDownloadReceived ();
		if (fEnable) 
		{
//			chrome.runtime.sendMessage({greeting: "hello background"}, function(response) {
//  			console.log(response.farewell);
//			});
//				var rect = el.getBoundingClientRect();
				if (fMultipleMode == false)
				{
					e.preventDefault();
					e.stopPropagation();
  				e.stopImmediatePropagation();      
  			}
				el = ProcessSendItemData2RPA (el);
				if (el != null)
					changeBorderColor (el);
//        const $el = $(el);
//        const id = $(el).attr('id');
    }
}, {capture: true});

function triggerChange(element, type) {
//  let changeEvent = new Event('change');
//	var evt = document.createEvent("change");
//					  var evtold = document.createEvent("MouseEvents");
//					  evtold.initMouseEvent("mousedown", true, true, window,
//						    0, 0, 0, 10, 10, false, false, false, false, 0, null);
//					  var evt = new MouseEvent('mouseenter', {
//						    'bubbles': true,
//						    'cancelable': true,
//						    'buttons': 1,
//						    'clientX': 10,
//						    'clientY': 10
//					  });
//					  element.dispatchEvent(evt);
//					  evt = new MouseEvent('click', {
//						    'bubbles': true,
//						    'cancelable': true,
//						    'buttons': 1,
//						    'clientX': 10,
//						    'clientY': 10
//					  });
//					  evt.stopPropagation();
//					  element.dispatchEvent(evtold);
//					  element.dispatchEvent(evt);

			evt = new Event('input', {
	    	bubbles: true,
  	  	cancelable: true,
			});
			element.dispatchEvent(evt);
			evt = new Event('change', {
	    	bubbles: true,
  	  	cancelable: true,
			});
			element.dispatchEvent(evt);
//		element.focus ();					  
//		var keyboardEvent = document.createEvent("KeyboardEvent");
//		keyboardEvent.initKeyboardEvent ("keypress",true, true, window,
//			false, false, false, false, 40, 0);
//		element.dispatchEvent(keyboardEvent);

}	

function enterfun(n) {
    
    var ev = new KeyboardEvent('keydown', {altKey:false,
      bubbles: true,
      cancelBubble: false, 
      cancelable: true,
      charCode: 0,
      code: "Enter",
      composed: true,
      ctrlKey: false,
      currentTarget: null,
      defaultPrevented: true,
      detail: 0,
      eventPhase: 0,
      isComposing: false,
      isTrusted: true,
      key: "Enter",
      keyCode: 13,
      location: 0,
      metaKey: false,
      repeat: false,
      returnValue: false,
      shiftKey: false,
      type: "keydown",
      which: 13});

    n.dispatchEvent(ev);
    var ev = new KeyboardEvent('keyup', {altKey:false,
      bubbles: true,
      cancelBubble: false, 
      cancelable: true,
      charCode: 0,
      code: "Enter",
      composed: true,
      ctrlKey: false,
      currentTarget: null,
      defaultPrevented: true,
      detail: 0,
      eventPhase: 0,
      isComposing: false,
      isTrusted: true,
      key: "Enter",
      keyCode: 13,
      location: 0,
      metaKey: false,
      repeat: false,
      returnValue: false,
      shiftKey: false,
      type: "keyup",
      which: 13});

    n.dispatchEvent(ev);
    
}


async function SetItemColor(id, type, caption, index, value, className, attr, mustInclude) 
{
	var n = GetItemInDocument  (id, type, index, caption, className, attr, mustInclude);
	
	if (n != null)
		changeBorderColor (n);
	return "success";
}

async function CleanLastItemColor() 
{
	cleanBorderColor ();
	return "success";
}

async function SetItemData(id, type, caption, index, value, className, attr, mustInclude) 
{
	var n = GetItemInDocument  (id, type, index, caption, className, attr, mustInclude);
	var realvalue = value;
	
	realvalue = realvalue.replaceAll ("$#@", "\"");
	realvalue = realvalue.replaceAll ("\\t", "\t");
	
	if ((n != null) && (type == "KAT-DROPDOWN" || type == "SELECT"))
	{
    var atoken = value.split("*@");
    if (atoken[0] == "1")
    {
    	atoken[1] = atoken[1].toLowerCase();
			if (type == "KAT-DROPDOWN")
			{
				var myContent = n.shadowRoot.innerHTML;
				var myserachindex = 0;
				var myoptionsIndex;
				var myvalue = "";
				var mytext = "";
				
				while ((myoptionsIndex = myContent.indexOf ("<kat-option", myserachindex)) != -1)
				{
					if ((myserachindex = myContent.indexOf ('value="', myoptionsIndex)) != -1)
					{
						if ((myoptionsIndex = myContent.indexOf ('">', myserachindex)) != -1)
						{
							myvalue = myContent.slice (myserachindex + 7, myoptionsIndex);
							if ((myserachindex = myContent.indexOf ('<!---->', myoptionsIndex)) != -1)
							{
								if ((myoptionsIndex = myContent.indexOf ('<!---->', myserachindex + 7)) != -1)
								{
									mytext = myContent.slice (myserachindex + 7, myoptionsIndex);
									if (mytext.toLowerCase() == atoken[1])
									{
										realvalue = myvalue;
										break;
									}
								}
							}
						}
					}
				}
			}
			else
			{
     		for (var i = 0; i < n.options.length; i++)
     		{
     			if (atoken[1] == n.options[i].text.toLowerCase())
     			{
     				realvalue = i.toString ();
     				break;
     			}
      	}
			}
		}
		else
			realvalue = atoken[1];
	}	
	if (type == "KAT-DROPDOWN" || type == "KAT-DATE-PICKER" || type == "KAT-TEXTAREA" || type == "KAT-INPUT")
	{
		if (n != null)
		{
			n.setAttribute("value", realvalue);
			triggerChange (n, type);
			return "success";
		}
		return "error_not_found";	
	}
	else
	{
		if (type == "SELECT")
		{
			if (n != null)
			{
				n.selectedIndex = parseInt(realvalue, 10);
				triggerChange (n, type);
				return "success";
			}
			return "error_not_found";	
		}
	}
	if (id.localeCompare ("unknown") == 0)
	{
		if (n != null)
		{
			n.value = realvalue;
			triggerChange (n, type);
			enterfun (n);
			return "success";
		}
	}
	else
	{
		var fDoIt = false;
		
  	var elms = document.querySelectorAll("[id='" + id + "']");
							
		if (elms.length != 0)
		{
   	 	for (var i = 0; i < elms.length; i++)
   	 	{
   	 		if (elms[i].clientHeight != 0 && elms[i].clientWidth != 0)
  	 		{
 	    		elms[i].value = realvalue;
					triggerChange (elms[i], type);
					enterfun (elms[i]);
 	    		fDoIt = true;
 	    		break;
   	  	}
 	  	}
 	  }
 	  else
 	  {
 	  	if (caption != "")
 	  	{
				var strAll = GetFullPageInputCtrl ("input", 1);
        var token = strAll.split("$%");
        for (var i = 0; i < token.length; i+= 4)
        {
         	if (token [i + 2] == caption)
         	{
         		document.getElementById(token[i+1]).value = realvalue;
						triggerChange (document.getElementById(token[i+1]), type);
						enterfun (document.getElementById(token[i+1]));
         		fDoIt = true;
         		break;
         	}
        }
 	  	}
 	  }
 	  if (fDoIt == false && n != null)
 	  {
 	  	n.value = realvalue;
			triggerChange (n, type);
			enterfun (n);
 	  	fDoIt = true;
 	  }
 	  if (fDoIt)
 	  	return "success";
	}
	return "error_not_found";	
}

async function SetItemStartEndData(fstart, id, type, caption, index, value, className, attr, mustInclude) 
{
	var n = GetItemInDocument  (id, type, index, null, className, attr, mustInclude);
	
	if (n != null)
	{
		if (fstart)
			n.setAttribute("start-value", value);
		else
			n.setAttribute("end-value", value);
		triggerChange (n, type);
		return "success";
	}
	return "error_not_found";	
}


async function SetItemCheckData(id, type, caption, index, value, className, attr, mustInclude) 
{
	var fCheck = (value == "true") ? true : false;
	var n = GetItemInDocument  (id, type, index, caption, className, attr, mustInclude);
	if (n != null)
	{
		if(type == "KAT-CHECKBOX")
		{
			if (fCheck)
				n.setAttribute("checked", "true");
			else
				n.removeAttribute ("checked");
		}
		else
			n.checked = fCheck;
		return "success";
	}
	return "error_not_found";	
}

function GetItemData(id, type, index, className, attr, mustInclude) 
{
	var mytype = type;
  if (type == "INPUT<BUTTON>" || type == "CHECKBOX" || type == "RADIO")
  	mytype = "INPUT";
	var n = GetItemInDocument  (id, type, index, null, className, attr, mustInclude);
	if (n != null)
	{
		if (type == "A")
		{
			if (typeof(n.firstChild.wholeText) != "undefined")
				return n.firstChild.wholeText;
			else
				return n.innerText;
		}
		else
		{
			if (mytype == "INPUT")
			{
  			if (type == "RADIO")
  			{
					var strvalue = "";
					if (n.nextSibling != null)
						strvalue = n.nextSibling.textContent;
					else
						strvalue = n.value;
					strvalue = strvalue.replace(/^\s+|\s+$/gm,'');
					strvalue = strvalue.replace("\n", "");
					return strvalue;
  			}
  			else
  				return n.value;
  		}
  		else
  		{
				if (mytype == "KAT-BUTTON")
					return n.getAttribute("label");				  			
  		}
//  		var hexcode;
//  		for (var i = 0; i < n.innerText.length; i++)
//  			hexcode = n.innerText.charCodeAt(i).toString(16);
			return n.innerText;
			//			return n.innerText.trimEnd ();
		}
	}
	return "error_not_found";	
}

function GetItemCounterData(id, type, index, className, attr, mustInclude) 
{
	var n = GetItemInDocument  (id, type, index, null, className, attr, mustInclude);
	if (n != null)
	{
		if (type == "LI")
		{
			return n.parentElement.childElementCount.toString ();
		}
	}
	return "error_not_found";	
}

function GetItemTableData(id, type, index, className, attr, mustInclude) 
{
	var n = GetItemInDocument  (id, type, index, null, className, attr, mustInclude);
	if (GetTableContent(n, true) == false)
		return "error_not_found";	
	return "success";	
}

function GetItemDataExtra(id, type, index, className, attr, elementIndex, childCount, childClassName, parentClassName, mustInclude) 
{
	var mytype = type;
  if (type == "INPUT<BUTTON>" || type == "CHECKBOX" || type == "RADIO")
  	mytype = "INPUT";
	var n = GetItemInDocumentExtra  (id, type, index, null, className, attr, elementIndex, childCount, childClassName, parentClassName, mustInclude);
	if (n != null)
	{
		if (type == "A")
		{
			if (typeof(n.firstChild.wholeText) != "undefined")
				return n.firstChild.wholeText;
			else
				return n.innerText;
		}
		else
		{
			if (mytype == "INPUT")
			{
  			if (type == "RADIO")
  			{
					var strvalue = "";
					if (n.nextSibling != null)
						strvalue = n.nextSibling.textContent;
					else
						strvalue = n.value;
					strvalue = strvalue.replace(/^\s+|\s+$/gm,'');
					strvalue = strvalue.replace("\n", "");
					return strvalue;
  			}
  			else
  				return n.value;
  		}
  		else
  		{
				if (mytype == "KAT-BUTTON")
					return n.getAttribute("label");				  			
  		}
			return n.innerText;
		}
	}
	return "error_not_found";	
}

function GetItemCounterDataExtra(id, type, index, className, attr, elementIndex, childCount, childClassName, parentClassName, parentType, mustInclude) 
{
	var n = GetItemInDocumentExtra  (id, type, index, null, className, attr, elementIndex, childCount, childClassName, parentClassName, mustInclude);
	if (n != null)
	{
		if (type == "LI" && n.parentElement.nodeName == parentType)
		{
			return n.parentElement.childElementCount.toString ();
		}
	}
	return "error_not_found";	
}

function GetItemEnableData(id, type, index, className, attr, mustInclude) 
{
	var realtype = type;
	var n = GetItemInDocument  (id, type, index, null, className, attr, mustInclude);
  if (type == "INPUT<BUTTON>" || type == "CHECKBOX" || type == "RADIO")
  	realtype = "INPUT";
	if(n != null)
	{
		if (realtype == "KAT-RADIOBUTTON")
		{
			if (-1 != n.outerHTML.indexOf ("disabled"))
				return "disable";
		}
		else
		{
			if (n.disabled)
				return "disable";
		}
		return "enable";
	}
	return "error_not_found";	
}

function GetItemCheckData (id, type, index, className, attr, mustInclude)
{
	var n = GetItemInDocument  (id, type, index, null, className, attr, mustInclude);
	if(n != null)
	{
		if (type == "KAT-CHECKBOX")
		{
			var value;
			
			if ((value = n.getAttribute("checked")) != null)
			{
//				if (value == "true")
					return "checked";
			}
			return "unchecked";
		}
		if (n.checked)
			return "checked";
		return "unchecked";
	}
	return "error_not_found";	
}	

function ScrollToVisibleCenter (element)
{
	var rect = element.getBoundingClientRect ();
	var yCordinate = (window.innerHeight - rect.height)/ 2;
	if (0 < (window.scrollY + rect.top - yCordinate))
		window.scrollTo (0, window.scrollY + rect.top - yCordinate);
}

function SetItemVisible (id, type, index, className, attr, mustInclude)
{
	var n = GetItemInDocument  (id, type, index, null, className, attr, mustInclude);
	if(n != null)
	{
//		ScrollToVisibleCenter (n);
		n.scrollIntoView ();
		return "success";
	}
	return "error_not_found";	
}

function GetElementInBrowserpos (element)
{
	var rect = element.getBoundingClientRect ();
	var rectRet = { left: 0, top: 0, right: 0, bottom: 0 };
	var parentElemnet = element;
	while (rect.width == 0 || rect.height == 0)
	{
		parentElemnet = parentElemnet.parentNode;
		rect = parentElemnet.getBoundingClientRect ();
	}
	rectRet.top = rect.top;
	rectRet.left = rect.left;
	rectRet.right = rect.right;
	rectRet.bottom = rect.bottom;
	
//	rectRet.left += window.screenX + (window.outerWidth - window.innerWidth);
//	rectRet.right += window.screenX + (window.outerWidth - window.innerWidth);
	rectRet.left += window.screenX;
	rectRet.right += window.screenX;
	rectRet.top *= window.devicePixelRatio;	
	rectRet.left *= window.devicePixelRatio;	
	rectRet.right *= window.devicePixelRatio;	
	rectRet.bottom *= window.devicePixelRatio;	
	rectRet.top += window.screenY + (window.outerHeight - window.innerHeight * window.devicePixelRatio) + 30;
	rectRet.bottom += window.screenY + (window.outerHeight - window.innerHeight * window.devicePixelRatio) + 30;
	
	return Math.ceil(rectRet.left).toString() + "," + Math.ceil(rectRet.top).toString() + "," +
				 Math.ceil(rectRet.right).toString() + "," + Math.ceil(rectRet.bottom).toString(); 
}

function GetItemInDocument  (id, type, index, value, className, attr, mustInclude)
{
	var n = null; 
  var mytype = type;
  var iIndex = parseInt(index, 10);
  var iMax;
  var i, j;
	  
  if (type == "INPUT<BUTTON>" || type == "CHECKBOX" || type == "RADIO")
  	mytype = "INPUT";
	n = document.getElementsByTagName (mytype);
	
	
//(+)TEST	
/*
	for (i = n.length - 1; i >= 0; i--)
	{
		if (n[i].childElementCount == 3 &&
				n[i].childNodes[0].className == "a-price-symbol" &&
				n[i].childNodes[1].className == "a-price-whole" &&
				n[i].childNodes[2].className == "a-price-fraction")
		{
				var myNode = n[i];
				while (myNode.nodeName == "SPAN" && myNode.parentNode != null)
					myNode = myNode.parentNode;
				if (myNode.className == "a-section a-spacing-none a-padding-none")	
					return n[i];
		}
	}
*/	
//(-)TEST	
	if (n.length == 1)
		return n[0];
	if (n.length <= iIndex)
	{
		if (id.localeCompare ("unknown") != 0)
			return document.getElementById (id);
		return null;
	}
	iMax = (iIndex > (n.length - iIndex - 1)) ? iIndex : (n.length - iIndex - 1);
//	iMax = (iIndex > (n.length - 1)) ? iIndex : (n.length - 1));
	if (iIndex > iMax)
		return null;
	if (type == "KAT-CHECKBOX" || type == "svg" || type == "SVG")
		return n[iIndex];
	if (type != "KAT-RADIOBUTTON")
	{
		if (id.localeCompare ("unknown") != 0)
		{
			if (n[iIndex].id != id)
			{
				if (value != null && value != "")
				{
					for (i = 1; i <= iMax; i++)
					{
						if ((iIndex - i) >= 0)
						{
							if (n[iIndex - i].id == id && n[iIndex - i].innerText == value)
								return n[iIndex - i];
						}
						if ((iIndex + i) < n.length)
						{
							if (n[iIndex + i].id == id && n[iIndex + i].innerText == value)
								return n[iIndex + i];
						}
					}
				}
				for (i = 1; i <= iMax; i++)
				{
					if ((iIndex - i) >= 0)
					{
						if (n[iIndex - i].id == id)
							return n[iIndex - i];
					}
					if ((iIndex + i) < n.length)
					{
						if (n[iIndex + i].id == id)
							return n[iIndex + i];
					}
				}
				if (value != null && value != "")
				{
					for (i = 0; i <= iMax; i++)
					{
						if ((iIndex - i) >= 0)
						{
							if (n[iIndex - i].innerText == value)
								return n[iIndex - i];
						}
						if ((iIndex + i) < n.length)
						{
							if (n[iIndex + i].innerText == value)
								return n[iIndex + i];
						}
					}
				}
			}
			else
			{
				var fFullMatched = true;
				
				if(className != null && className != "")
				{
					var realClassName = className;
					if (className == "empty-class-name")
						realClassName = "";
					if (n[iIndex].className != realClassName)
						fFullMatched = false;
				}
				if (attr != null && attr != "")
				{
					var realattr = attr;
					if (realattr == "empty-attr")
					{
						realattr = "";
						if (n[iIndex].attributes.length != 0)
							fFullMatched = false;
					}
					else
					{		
						var fFindAttr = false;
						for(i = 0; i < n[iIndex].attributes.length; i++)
						{
							if (n[iIndex].attributes[i].nodeName == realattr)
							{
								fFindAttr = true;
								break;
							}
						}
						if (fFindAttr == false)	
							fFullMatched = false;
					}
				}
				if (fFullMatched)				
					return n[iIndex]; 
				else
				{
					if(className != null && className != "")
					{
						var realClassName = className;
						if (className == "empty-class-name")
							realClassName = "";

						for (i = 1; i <= iMax; i++)
						{
							if ((iIndex - i) >= 0)
							{
								if (n[iIndex - i].id == id && n[iIndex - i].className == realClassName)
									return n[iIndex - i];
							}
							if ((iIndex + i) < n.length)
							{
								if (n[iIndex + i].id == id && n[iIndex + i].className == realClassName)
									return n[iIndex + i];
							}
						}
					}
					return n[iIndex]; 
				}
			}
			return null;
		}
		else
		{
			if(className != null && className != "" && attr != null && attr != "")
			{
				var realClassName = className;
				if (className == "empty-class-name")
					realClassName = "";

				for (i = 0; i <= iMax; i++)
				{
					if ((iIndex - i) >= 0 && n[iIndex - i].id == "")
					{
						if (attr == "empty-attr")
						{
							if (n[iIndex - i].attributes.length == 0)
							{
								if (n[iIndex - i].className == realClassName)
								{
									if (mustInclude == "1" && value != null && value != "")
									{
										if (n[iIndex - i].innerText.includes(value))
											return n[iIndex - i];
									}
									else
										return n[iIndex - i];
								}
							}
						}
						else
						{
							if (n[iIndex - i].attributes.length != 0)
							{
								var fFindAttr = false;
								for(j = 0; j < n[iIndex - i].attributes.length; j++)
								{
									if (n[iIndex - i].attributes[j].nodeName == attr)
									{
										fFindAttr = true;
										break;
									}
								}
								if (fFindAttr && n[iIndex - i].className == realClassName)
								{
									if (mustInclude == "1" && value != null && value != "")
									{
										if (n[iIndex - i].innerText.includes(value))
											return n[iIndex - i];
									}
									else
										return n[iIndex - i];
								}
							}
						}
					}
					if ((iIndex + i) < n.length && n[iIndex + i].id == "")
					{
						if (attr == "empty-attr")
						{
							if (n[iIndex + i].attributes.length == 0)
							{
								if (n[iIndex + i].className == realClassName)
								{
									if (mustInclude == "1" && value != null && value != "")
									{
										if (n[iIndex + i].innerText.includes(value))
											return n[iIndex + i];
									}
									else
										return n[iIndex + i];
								}
							}
						}
						else
						{
							if (n[iIndex + i].attributes.length != 0)
							{
								var fFindAttr = false;
								for(j = 0; j < n[iIndex + i].attributes.length; j++)
								{
									if (n[iIndex + i].attributes[j].nodeName == attr)
									{
										fFindAttr = true;
										break;
									}
								}
								if (fFindAttr && n[iIndex + i].className == realClassName)
								{
									if (mustInclude == "1" && value != null && value != "")
									{
										if (n[iIndex + i].innerText.includes(value))
											return n[iIndex + i];
									}
									else
										return n[iIndex + i];
								}
							}
						}
					}
				}
			}
			if (value != null && value != "")
			{
				for (i = 1; i <= iMax; i++)
				{
					if ((iIndex - i) >= 0)
					{
						if (n[iIndex - i].id == "" && n[iIndex - i].innerText == value)
							return n[iIndex - i];
					}
					if ((iIndex + i) < n.length)
					{
						if (n[iIndex + i].id == "" && n[iIndex + i].innerText == value)
							return n[iIndex + i];
					}
				}
			}
		}
	}
	else
		return n[iIndex];
	if (attr != null && attr != "")
		return null;
	return n[iIndex];
}

function GetItemInDocumentExtra  (id, type, index, value, className, attr, elementIndex, childCount, childClassName, parentClassName, mustInclude)
{
	var n = null; 
  var mytype = type;
  var iIndex = parseInt(index, 10);
  var iMax;
  var i;
  var ielementIndex = parseInt (elementIndex);
  var ichildCount = parseInt (childCount);
  var arrChildClassName = childClassName.split("$#");
	var iFindCount = 0;
	  
  if (type == "INPUT<BUTTON>" || type == "CHECKBOX" || type == "RADIO")
  	mytype = "INPUT";
	n = document.getElementsByTagName (mytype);
	
	for (i = 0; i < arrChildClassName.length; i++)
	{
		if (arrChildClassName[i] == "empty-class-name")
			arrChildClassName[i] = "";
	}
	if (parentClassName == "empty-class-name")
			parentClassName = "";
	for (i = 0; i < n.length; i++)
	{
		if (n[i].childElementCount == ichildCount)
		{
			var fAllMatched = true;
			for (var j = 0; j < ichildCount; j++)
			{
				if (typeof (n[i].children[j].className) == "undefined")
				{
					if (arrChildClassName[j] != "" && arrChildClassName[j] != "undefined")
					{
						fAllMatched = false;
						break;
					}
				}
				else
				{
					if (n[i].children[j].className != arrChildClassName[j])
					{
						fAllMatched = false;
						break;
					}
				}
			}
			if (fAllMatched == true)
			{
				var myNode = n[i];
				while (myNode.nodeName == mytype && myNode.parentNode != null)
					myNode = myNode.parentNode;
				if (myNode.className == parentClassName)
				{
					//for test
					if (mustInclude == "1" && value != null && value != "")
					{
						if (myNode.innerText.includes(value))
						{
					//
							iFindCount++;	
							if (iFindCount == ielementIndex)
								return n[i];
						}
					}
					else
					{
						iFindCount++;	
						if (iFindCount == ielementIndex)
							return n[i];
					}
				}
			}
		}
	}
//(-)TEST	
	if (n.length <= iIndex)
		return null;
	iMax = (iIndex > (n.length - iIndex - 1)) ? iIndex : (n.length - iIndex - 1);
	if (iIndex > iMax)
		return null;
	if (type == "KAT-CHECKBOX" || type == "svg" || type == "SVG")
		return n[iIndex];
	if (type != "KAT-RADIOBUTTON")
	{
		if (id.localeCompare ("unknown") != 0)
		{
			if (n[iIndex].id != id)
			{
				if (value != null && value != "")
				{
					for (i = 1; i <= iMax; i++)
					{
						if ((iIndex - i) >= 0)
						{
							if (n[iIndex - i].id == id && n[iIndex - i].innerText == value)
								return n[iIndex - i];
						}
						if ((iIndex + i) < n.length)
						{
							if (n[iIndex + i].id == id && n[iIndex + i].innerText == value)
								return n[iIndex + i];
						}
					}
				}
				for (i = 1; i <= iMax; i++)
				{
					if ((iIndex - i) >= 0)
					{
						if (n[iIndex - i].id == id)
							return n[iIndex - i];
					}
					if ((iIndex + i) < n.length)
					{
						if (n[iIndex + i].id == id)
							return n[iIndex + i];
					}
				}
			}
			else
				return n[iIndex]; 
			return null;
		}
		else
		{
			if(className != null && className != "" && attr != null && attr != "")
			{
				var realClassName = className;
				if (className == "empty-class-name")
					realClassName = "";

				for (i = 0; i <= iMax; i++)
				{
					if ((iIndex - i) >= 0 && n[iIndex - i].id == "")
					{
						if (attr == "empty-attr")
						{
							if (n[iIndex - i].attributes.length == 0)
							{
								if (n[iIndex - i].className == realClassName)
									return n[iIndex - i];
							}
						}
						else
						{
							if (n[iIndex - i].attributes.length != 0)
							{
								if (n[iIndex - i].attributes[0].nodeName == attr && n[iIndex - i].className == realClassName)
									return n[iIndex - i];
							}
						}
					}
					if ((iIndex + i) < n.length && n[iIndex + i].id == "")
					{
						if (attr == "empty-attr")
						{
							if (n[iIndex + i].attributes.length == 0)
							{
								if (n[iIndex + i].className == realClassName)
									return n[iIndex + i];
							}
						}
						else
						{
							if (n[iIndex + i].attributes.length != 0)
							{
								if (n[iIndex + i].attributes[0].nodeName == attr && n[iIndex + i].className == realClassName)
									return n[iIndex + i];
							}
						}
					}
				}
			}
			if (value != null && value != "")
			{
				for (i = 1; i <= iMax; i++)
				{
					if ((iIndex - i) >= 0)
					{
						if (n[iIndex - i].id == "" && n[iIndex - i].innerText == value)
							return n[iIndex - i];
					}
					if ((iIndex + i) < n.length)
					{
						if (n[iIndex + i].id == "" && n[iIndex + i].innerText == value)
							return n[iIndex + i];
					}
				}
			}
		}
	}
	else
		return n[iIndex];
	if (attr != null && attr != "")
		return null;
	return n[iIndex];
}

function GetItemCordinate (id, type, index, value, className, attr, mustInclude)
{
		var n = GetItemInDocument  (id, type, index, value, className, attr, mustInclude);
		if (n != null)
			return GetElementInBrowserpos (n);
		return "error_not_found";	
}

function TriggerClick (n)
{
	var evtold = document.createEvent("MouseEvents");
	evtold.initMouseEvent("click", true, true, window,
		    0, 0, 0, 0, 0, false, false, false, false, 0, null);
	var evt = new MouseEvent('click', {
					    'bubbles': true,
					    'cancelable': true
			  });
	if (n.baseURI.includes ("google") && n.baseURI.includes ("mail"))
	{
		n.dispatchEvent(evt);
	}
	else
	{
		evt.stopPropagation();
		n.dispatchEvent(evtold);
		n.dispatchEvent(evt);
	}
}

function TriggerRightClick (n)
{
	var evtold = document.createEvent("MouseEvents");
	evtold.initMouseEvent("click", true, true, window,
		    0, 0, 0, 0, 0, false, false, false, false, 2, null);
	var evt = new MouseEvent('click', {
					    'bubbles': true,
					    'cancelable': true,
					    'button': 2
			  });
	if (n.baseURI.includes ("google") && n.baseURI.includes ("mail"))
	{
		n.dispatchEvent(evt);
	}
	else
	{
		evt.stopPropagation();
		n.dispatchEvent(evtold);
		n.dispatchEvent(evt);
	}
}

function ClickOrTriggerClick (n)
{
	if (typeof(n.click) != 'undefined')
	{
		n.click();
		TriggerClick (n);
	}
	else
	{
//		if (typeof(n.mousedown) != 'undefined' && typeof(n.mouseup) != 'undefined')
//		{
//			n.mousedown();
//			n.mouseup();
//		}
//		else
			TriggerClick (n);
	}
}

function ClickItemExtra(id, type, index, value, className, attr, elementIndex, childCount, childClassName, parentClassName, mustInclude) 
{
	var n = GetItemInDocumentExtra  (id, type, index, value, className, attr, elementIndex, childCount, childClassName, parentClassName, mustInclude);
	  var mytype = type;
	  
//	  n = n.parentElement.parentElement.parentElement.parentElement;
//		n.focus ();
//	  ClickOrTriggerClick (n);
//		return "success";
	  
	  if(n != null)
	  {
			if (type == "KAT-CHECKBOX")
			{
//				n.setAttribute("checked", "true");
//					n.removeAttribute ("checked");
				triggerChange (n, type);
				return "success";
			}

	  	
		  if (type == "INPUT<BUTTON>")
		  	mytype = "INPUT";
		
			if (mytype == "KAT-RADIOBUTTON" || mytype == "BUTTON")
			{
				if (mytype == "KAT-RADIOBUTTON")
				{
					n.setAttribute("checked", "true");
					triggerChange (n, type);
				}
				else
					ClickOrTriggerClick (n);
			}
			else
			{
				if (mytype == "A" || mytype == "KAT-BUTTON" || mytype == "BUTTON")
				{
					TriggerClick (n);
				}
				else
				{
					var elms;
					var i;
					var fDoIt = false;
					
					if (id.localeCompare ("unknown") == 0)
					{
						if (n.innerText == value && n.clientHeight != 0 && n.clientWidth != 0)
						{
							ClickOrTriggerClick (n);
							fDoIt = true;
						}
						else
						{
							elms = document.getElementsByTagName (mytype);
					
							for (i = 0; i < elms.length; i++)
							{
								if (elms[i].innerText == value && elms[i].clientHeight != 0 && elms[i].clientWidth != 0)
								{
									ClickOrTriggerClick (elms[i]);
									fDoIt = true;
									break;
								}
							}
						}
					}
					else
					{
			  		elms = document.querySelectorAll("[id='" + id + "']");
	 	  			for (i = 0; i < elms.length; i++)
 		  			{
 	  					if (elms[i].clientHeight != 0 && elms[i].clientWidth != 0)
		 		  		{
								ClickOrTriggerClick (elms[i]);
								fDoIt = true;
								break;
							}
						}
					}
					if (fDoIt == false)
					{
						ClickOrTriggerClick (n);
					}
				}
			}
			return "success";
		}
		return "error_not_found";	
}

function ClickItem(id, type, index, value, className, attr, mustInclude) 
{
		var n = GetItemInDocument  (id, type, index, value, className, attr, mustInclude);
	  var mytype = type;
	  
//	  n = n.parentElement.parentElement.parentElement.parentElement;
//		n.focus ();
//	  ClickOrTriggerClick (n);
//		return "success";
	  
//	  TriggerRightClick (n);
//		return "success";
	  if(n != null)
	  {
			if (type == "KAT-CHECKBOX")
			{
//				n.setAttribute("checked", "true");
//					n.removeAttribute ("checked");
				triggerChange (n, type);
				return "success";
			}

	  	
		  if (type == "INPUT<BUTTON>")
		  	mytype = "INPUT";
		
			if (mytype == "KAT-RADIOBUTTON" || mytype == "BUTTON")
			{
				if (mytype == "KAT-RADIOBUTTON")
				{
					n.setAttribute("checked", "true");
					triggerChange (n, type);
				}
				else
					ClickOrTriggerClick (n);
			}
			else
			{
				if (mytype == "A" || mytype == "KAT-BUTTON" || mytype == "BUTTON")
				{
					TriggerClick (n);
				}
				else
				{
					var elms;
					var i;
					var fDoIt = false;
					
					if (id.localeCompare ("unknown") == 0)
					{
						if ((typeof(n.innerText) == "undefined" || (typeof(n.innerText) != "undefined" && n.innerText == value))
						   && n.clientHeight != 0 && n.clientWidth != 0)
						{
							ClickOrTriggerClick (n);
							fDoIt = true;
						}
						else
						{
							elms = document.getElementsByTagName (mytype);
					
							for (i = 0; i < elms.length; i++)
							{
								if (elms[i].innerText == value && elms[i].clientHeight != 0 && elms[i].clientWidth != 0)
								{
									ClickOrTriggerClick (elms[i]);
									fDoIt = true;
									break;
								}
							}
						}
					}
					else
					{
			  		elms = document.querySelectorAll("[id='" + id + "']");
	 	  			for (i = 0; i < elms.length; i++)
 		  			{
 	  					if (elms[i].clientHeight != 0 && elms[i].clientWidth != 0)
		 		  		{
								ClickOrTriggerClick (elms[i]);
								fDoIt = true;
								break;
							}
						}
					}
					if (fDoIt == false)
					{
						ClickOrTriggerClick (n);
					}
				}
			}
			return "success";
		}
		return "error_not_found";	
}

function FocusItem(id, type, index, value, className, attr, mustInclude) 
{
	var n = GetItemInDocument  (id, type, index, value, className, attr, mustInclude);
	  
  if(n != null)
  {
		n.focus ();
		return "success";
	}
	return "error_not_found";	
}

/*
function EnableIFrameListenEvent ()
{
	var iframe = document.getElementsByTagName ("iframe");
	for (var i = 0; i < iframe.length; i++)
	{
		const iframeDocument = iframe[i].contentWindow.document;
		iframeDocument.addEventListener('click', function(e) {
			if (fEnable)
//			if (true)
			{
				var el = e.target;
				var myel = el;
				var header = "";
				var DataTable = "";
				var fFindHeader = false;
				var j;
				
				if (myel.nodeName == "TH" || myel.nodeName == "TD")
				{
					fFindHeader = true;
					myel = myel.parentNode;
					while (myel != null && myel.nodeName != "TR")
						myel = myel.parentNode;
					while (myel.previousElementSibling != null)
						myel = myel.previousElementSibling;
					if (myel != null)
					{	
						while (myel != null)
						{
							for (j = 0; j < myel.children.length; j++)
							{
								if (myel.children[j].nodeName == "TH")
								{
									header += myel.children[j].innerText;
									if (j != (myel.children.length - 1))
										header += "&#";
								}
								else
								{
									if (myel.children[j].nodeName == "TD")
									{
										if(j == 0 && DataTable != "")
											DataTable += "&@";
										DataTable += myel.children[j].innerText;
										if (j != (myel.children.length - 1))
											DataTable += "&#";
									}
								}
							}
							myel = myel.nextElementSibling;							
						}
						alert ("Hedaer=" + header);
						alert ("Data=" + DataTable);
					}
				}	
			} 
    });
  }
}

EnableIFrameListenEvent ();
*/
document.onreadystatechange = function () {
  if (document.readyState === 'complete') {
    sendreadynotification();
  }
}

function sendShowWebCapture ()
{
    const tmp = {
      type: 'ShowWebCapture',
      data: { value: "1" } 
    };
    doSend(JSON.stringify(tmp));
}

chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
	sendShowWebCapture ();
//  alert ("Recv. Send response = " + document.title);
  sendResponse({ title: document.title });

  return true;
});

InitWebSocket ();
